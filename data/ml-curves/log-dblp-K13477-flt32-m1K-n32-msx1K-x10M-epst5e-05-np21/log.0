Command line: ./apps/main/main -f ../../datasets/com-dblp.ungraph.txt.gz -K 13477 -m 1K -n 32 --mcmc.sampler.max-source 1K -x 10M --mcmc.c 0 --mcmc.a 5e-05 -i 256 
start MCMC stochastical distributed 
Floating point precision: 32bit
Host node102 PID 19754
Build type Release
Graph implementation: adjacency list (google sparseset)
MPI_Init() done, rank 0 size 21
Set held_out_ratio to default 0.1
Create per-thread randoms
Random seed [42,43]
Random seed [42,44]
Random seed [42,45]
Random seed [42,46]
Random seed [42,47]
Random seed [42,48]
Random seed [42,49]
Random seed [42,50]
Random seed [42,51]
Random seed [42,52]
Random seed [42,53]
Random seed [42,54]
Random seed [42,55]
Random seed [42,56]
Random seed [42,57]
Random seed [42,58]
Random seed [42,59]
Random seed [42,60]
Random seed [42,61]
Random seed [42,62]
Random seed [42,63]
Random seed [42,64]
Random seed [42,65]
Random seed [42,66]
Random seed [42,67]
Random seed [42,68]
Random seed [42,69]
Random seed [42,70]
Random seed [42,71]
Random seed [42,72]
Random seed [42,73]
Random seed [42,74]
Random seed[0] 0x2a,0x2b
Handle input dataset from file ../../datasets/com-dblp.ungraph.txt.gz
0ms open file
For memory query file /proc/19754/statm
0.000 Memory usage: total 162MB resident 12MB 
Edges read 1048576
1.090 Memory usage: total 198MB resident 47MB 
1095ms read ordered set
1.095 Memory usage: total 206MB resident 49MB 
#nodes 317080 min 1 max 425875 #edges 1049866
1196ms create map
1.196 Memory usage: total 233MB resident 77MB 
Edges inserted 1048576
1.956 Memory usage: total 290MB resident 134MB 
#edges original 1049866 undirected subsets 2099732 duplicates 0 self-links 0
1958ms create NetworkGraph
1.957 Memory usage: total 290MB resident 134MB 
1.996 Memory usage: total 265MB resident 115MB 
Found prefix sum for edges in AdjacencyList graph: top bucket edge 2099732 max edge 2099735
train_link_map is gone; calculate membership for each edge as linked_edges - held_out_map - test_map
2.051 Memory usage: total 389MB resident 115MB 
Edges/in in held-out set 0
2.097 Memory usage: total 424MB resident 119MB 
Edges in held-out set 104986
2.170 Memory usage: total 424MB resident 120MB 
Edges/in in test set 0
2.282 Memory usage: total 432MB resident 134MB 
Edges in test set 104987
2.389 Memory usage: total 432MB resident 135MB 
FIXME: can't I parallelize by not doing the order check?
max_fan_out 313
N 317080 E 1049866 link ratio 2.08847e-05 K 13477
minibatch size 1024 epsilon 1e-07 alpha 7.42005e-05 iterations 10485760 convergence 1e-12
sampling strategy stratified-random-node
omp max threads 32
Held-out+test size 209973
Test size 104987
Held-out size 104986
num_node_sample 32
a 5e-05 b 1024 c 0 eta (1,1)
minibatch size: 1024
Use D-KV store type rdma
mem_total 65878880 pi_total 1251297 max pi cache entries 39103
minibatch size param 1024 max 2673 my max 134 chunk 575 #neighbors(total) 4422 cache max entries 10000 computed max pi cache entries 39103
perplexity nodes total 209972 local 10000 mine 10000 chunk 9775
phi pipeline depth 2
node102: RDMA OOB network: receive message from master, my rank is 0
RDMA D-KV store excludes the master node
MR/value addr=0x7fffba7b9000 size 20225180, lkey=0xf8015848, rkey=0xf8015848, flags=0xf, mr=0x7fffdd337690
MR/cache addr=0x7fff7a36d000 size 4044a300, lkey=0xf8016148, rkey=0xf8016148, flags=0xf, mr=0x7fffdd3376d0
MR/write addr=0x7fff79c88000 size 6e3b90, lkey=0xf8016248, rkey=0xf8016248, flags=0xf, mr=0x7fffdd337710
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
My con_data for qp to host 1: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6286
  PSN number = 15354715
  max.atomic = 16
  LID = 0x27
Local LID[1] = 0x 1b
My con_data for qp to host 2: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6287
  PSN number = 1092323
  max.atomic = 16
  LID = 0x27
Local LID[2] = 0x 1b
My con_data for qp to host 3: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6288
  PSN number = 8873963
  max.atomic = 16
  LID = 0x27
Local LID[3] = 0x 1b
My con_data for qp to host 4: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6289
  PSN number = 134822
  max.atomic = 16
  LID = 0x27
Local LID[4] = 0x 1b
My con_data for qp to host 5: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6290
  PSN number = 11859120
  max.atomic = 16
  LID = 0x27
Local LID[5] = 0x 1b
My con_data for qp to host 6: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6291
  PSN number = 12538383
  max.atomic = 16
  LID = 0x27
Local LID[6] = 0x 1b
My con_data for qp to host 7: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6292
  PSN number = 3622797
  max.atomic = 16
  LID = 0x27
Local LID[7] = 0x 1b
My con_data for qp to host 8: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6293
  PSN number = 9990681
  max.atomic = 16
  LID = 0x27
Local LID[8] = 0x 1b
My con_data for qp to host 9: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6294
  PSN number = 1463832
  max.atomic = 16
  LID = 0x27
Local LID[9] = 0x 1b
My con_data for qp to host 10: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6295
  PSN number = 10625708
  max.atomic = 16
  LID = 0x27
Local LID[10] = 0x 1b
My con_data for qp to host 11: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6296
  PSN number = 14883504
  max.atomic = 16
  LID = 0x27
Local LID[11] = 0x 1b
My con_data for qp to host 12: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6297
  PSN number = 4598079
  max.atomic = 16
  LID = 0x27
Local LID[12] = 0x 1b
My con_data for qp to host 13: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6298
  PSN number = 12429685
  max.atomic = 16
  LID = 0x27
Local LID[13] = 0x 1b
My con_data for qp to host 14: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6299
  PSN number = 7873728
  max.atomic = 16
  LID = 0x27
Local LID[14] = 0x 1b
My con_data for qp to host 15: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6300
  PSN number = 12686236
  max.atomic = 16
  LID = 0x27
Local LID[15] = 0x 1b
My con_data for qp to host 16: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6301
  PSN number = 5545414
  max.atomic = 16
  LID = 0x27
Local LID[16] = 0x 1b
My con_data for qp to host 17: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6302
  PSN number = 13535844
  max.atomic = 16
  LID = 0x27
Local LID[17] = 0x 1b
My con_data for qp to host 18: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6303
  PSN number = 9560959
  max.atomic = 16
  LID = 0x27
Local LID[18] = 0x 1b
My con_data for qp to host 19: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6304
  PSN number = 6435675
  max.atomic = 16
  LID = 0x27
Local LID[19] = 0x 1b
My con_data for qp to host 20: 
  value address = 0x7fffba7b9000
  value rkey = 0xf8015848
  cache address = 0x7fff7a36d000
  cache rkey = 0xf8016148
  QP number = 6305
  PSN number = 11241849
  max.atomic = 16
  LID = 0x27
Local LID[20] = 0x 1b
0: going to send OOB info to master
0: sent OOB info to master, error system:0
Got OOB info from 0
Got OOB info from 1
Got OOB info from 2
Got OOB info from 3
Got OOB info from 4
Got OOB info from 5
Got OOB info from 6
Got OOB info from 7
Got OOB info from 8
Got OOB info from 9
Got OOB info from 10
Got OOB info from 11
Got OOB info from 12
Got OOB info from 13
Got OOB info from 14
Got OOB info from 15
Got OOB info from 16
Got OOB info from 17
Got OOB info from 18
Got OOB info from 19
Got OOB info from 20
Wrote OOB info to 0
Wrote OOB info to 1
Wrote OOB info to 2
Wrote OOB info to 3
Peer 1
  value address = 0x7fffb9228000
  value rkey = 0xa0016297
  cache address = 0x7fff78ddc000
  cache rkey = 0xa0016397
  QP number = 6694
Wrote OOB info to   PSN number = 5344101
  max.atomic = 16
  LID = 0x33
Peer 2
  value address = 0x7fffb9221000
4  value rkey = 0x5801622e
  cache address = 0x7fff78dd5000
  cache rkey = 0x5801632e
  QP number = 6568
  PSN number = 7996802
  max.atomic = 16
  LID = 0x28
Peer 3
  value address = 0x7fffb9206000

  value rkey = 0xa0016a24
  cache address = 0x7fff78dba000
  cache rkey = 0xa0016b24
  QP number = 6790
Wrote OOB info to   PSN number = 11606113
  max.atomic = 16
  LID = 0x35
Peer 4
  value address = 0x5
7fffb9228000
  value rkey = 0x80162f4
  cache address = 0x7fff78ddc000
Wrote OOB info to   cache rkey = 0x80163f4
  QP number = 6550
  PSN number = 5719021
  max.atomic = 16
  LID = 0x29
Peer 5
  value address = 0x7fffb72bf000
  value rkey = 0x30015ae7
  cache address = 0x7fff76e73000
  cache rkey = 0x30015be7
  QP number = 6628
  PSN number = 9032208
  max.atomic = 16
  LID = 0x37
Peer 6
  value address = 0x6
7fffb9228000
  value rkey = 0x200162de
  cache address = 0x7fff78ddc000
  cache rkey = 0x200163de
  QP number = 6631
  PSN number = 16049648
  max.atomic = 16
  LID = 0x49
Peer 7
  value address = 0x7fffb9243000
  value rkey = 0xb0015a1e
  cache address = 0x7fff78df7000
  cache rkey = 0xb0015b1e
  QP number = 6621
  PSN number = 5011099
  max.atomic = 16
  LID = 0x34
Peer 8
  value address = 0x7fffb924a000
  value rkey = 0x10015a6d
  cache address = 0x7fff78dfe000
  cache rkey = 0x10015b6d
  QP number = 6509
  PSN number = 1340096Wrote OOB info to 7
  max.atomic = 16
  LID = 0x32
Peer 9
  value address = 0x7fffb926a000
  value rkey = 0x
60015264
  cache address = 0x7fff78e1e000
  cache rkey = 0x60015364
  QP number = Wrote OOB info to 86613

  PSN number = 1341252
  max.atomic = 16
Wrote OOB info to   LID = 0x48
Peer 10
  value address = 0x7fffb924a000
  value rkey = 0xe0015a6e
  cache address = 0x7fff78dfe0009

  cache rkey = 0xe0015b6e
  QP number = 6640
  PSN number = 14326610
  max.atomic = Wrote OOB info to 1016
  LID = 0x30

Peer 11
  value address = 0x7fffb926c000
  value rkey = 0xa0015255
Wrote OOB info to   cache address = 0x7fff78e20000
  cache rkey = 0xa0015355
  QP number = 674211

  PSN number = 4527287
  max.atomic = 16
  LID = 0x38
Peer 12
  value address = 0x7fffb9228000
  value rkey = 0xa0016211
  cache address = 0x7fff78ddc000
  cache rkey = 0xa0016311
Wrote OOB info to 12  QP number = 6556
  PSN number = 3289729
  max.atomic = 16
  LID = 0x31
Peer 13
  value address = 0x7fffb6ebf000
  value rkey = 0x800152fd
  cache address = 0x7fff76a73000
  cache rkey = 0x800153fd
  QP number = 6455
  PSN number = 4124604
  max.atomic = 16
  LID = 0x41
Peer 14
  value address = 0x7fffb9248000
  value rkey = 0x68015a2f
  cache address = 0x7fff78dfc000

  cache rkey = 0x68015b2f
  QP number = 6508
  PSN number = 6035916
  max.atomic = 16
  LID = 0x39
Peer 15
  value address = 0x7fffb9360000
  value rkey = 0xf8015202
  cache address = 0x7fff78f14000
  cache rkey = 0xf8015302
  QP number = 6439
  PSN number = 10932709
  max.atomic = 16
  LID = 0x43Wrote OOB info to 13
Peer 16
  value address = 0x7fffb924a000
  value rkey = 0x8015ace
  cache address = 0x7fff78dfe000
  cache rkey = 0x8015bce
  QP number = 6477
  PSN number = 15032123

  max.atomic = 16
  LID = 0x40
Wrote OOB info to Peer 17
  value address = 0x7fffb9013000
  value rkey = 0x14
30015271
  cache address = 0x7fff78bc7000
  cache rkey = 0x30015371
  QP number = 6513
  PSN number = 11797403
  max.atomic = 16
  LID = 0x45
Peer 18
  value address = 0xWrote OOB info to 157fffb924a000
  value rkey = 0x88015a22
  cache address = 0x7fff78dfe000

  cache rkey = 0x88015b22
  QP number = 6546
  PSN number = 1359691
  max.atomic = 16
  LID = 0x44
Peer 19
  value address = 0x7fffb926c000
  value rkey = 0x90015213
  cache address = 0x7fff78e20000
  cache rkey = 0x90015313
  QP number = 6351
  PSN number = 2628031
  max.atomic = 16
  LID = 0x46
Peer 20
  value address = 0x7fffb932e000
  value rkey = 0x500150df
  cache address = 0x7fff78ee2000
  cache rkey = 0x500151df
  QP number = Wrote OOB info to 6497
  PSN number = 13596382
  max.atomic = 16
  LID = 0x47
16
Wrote OOB info to 17
Wrote OOB info to 18
Wrote OOB info to 19
Wrote OOB info to 20
Migrate QPs to RTR, RTS
Resize my queue pointers, use >= 1.52588MB
Master is not a worker, does not host pi values

run():1006 DKV Pipeline server runs
3.791 Memory usage: total 2065MB resident 1750MB 
average_count is: 2 step count: 1 time: 0.260 perplexity for hold out set: 5.103328227997
average_count is: 3 step count: 257 time: 13.753 perplexity for hold out set: 5.029449939728
average_count is: 4 step count: 513 time: 27.670 perplexity for hold out set: 4.991832256317
average_count is: 5 step count: 769 time: 41.532 perplexity for hold out set: 4.967717647552
average_count is: 6 step count: 1025 time: 55.091 perplexity for hold out set: 4.949802398682
average_count is: 7 step count: 1281 time: 68.773 perplexity for hold out set: 4.935889720917
average_count is: 8 step count: 1537 time: 82.636 perplexity for hold out set: 4.924391269684
average_count is: 9 step count: 1793 time: 96.460 perplexity for hold out set: 4.914826869965
average_count is: 10 step count: 2049 time: 110.459 perplexity for hold out set: 4.906590461731
average_count is: 11 step count: 2305 time: 123.951 perplexity for hold out set: 4.899286270142
average_count is: 12 step count: 2561 time: 137.211 perplexity for hold out set: 4.892820358276
average_count is: 13 step count: 2817 time: 151.015 perplexity for hold out set: 4.886985301971
average_count is: 14 step count: 3073 time: 164.401 perplexity for hold out set: 4.881742477417
average_count is: 15 step count: 3329 time: 178.370 perplexity for hold out set: 4.876986980438
average_count is: 16 step count: 3585 time: 192.330 perplexity for hold out set: 4.872652530670
average_count is: 17 step count: 3841 time: 206.181 perplexity for hold out set: 4.868664264679
average_count is: 18 step count: 4097 time: 219.746 perplexity for hold out set: 4.864987850189
average_count is: 19 step count: 4353 time: 233.661 perplexity for hold out set: 4.861575126648
average_count is: 20 step count: 4609 time: 247.322 perplexity for hold out set: 4.858407020569
average_count is: 21 step count: 4865 time: 260.854 perplexity for hold out set: 4.855459690094
average_count is: 22 step count: 5121 time: 274.238 perplexity for hold out set: 4.852711200714
average_count is: 23 step count: 5377 time: 287.919 perplexity for hold out set: 4.850127696991
average_count is: 24 step count: 5633 time: 301.891 perplexity for hold out set: 4.847696781158
average_count is: 25 step count: 5889 time: 315.572 perplexity for hold out set: 4.845406532288
average_count is: 26 step count: 6145 time: 328.800 perplexity for hold out set: 4.843247413635
average_count is: 27 step count: 6401 time: 342.392 perplexity for hold out set: 4.841197967529
average_count is: 28 step count: 6657 time: 356.024 perplexity for hold out set: 4.839251041412
average_count is: 29 step count: 6913 time: 369.582 perplexity for hold out set: 4.837399959564
average_count is: 30 step count: 7169 time: 382.509 perplexity for hold out set: 4.835635185242
average_count is: 31 step count: 7425 time: 396.165 perplexity for hold out set: 4.833945274353
average_count is: 32 step count: 7681 time: 409.722 perplexity for hold out set: 4.832326889038
average_count is: 33 step count: 7937 time: 423.447 perplexity for hold out set: 4.830779075623
average_count is: 34 step count: 8193 time: 437.116 perplexity for hold out set: 4.829296112061
average_count is: 35 step count: 8449 time: 450.986 perplexity for hold out set: 4.827878475189
average_count is: 36 step count: 8705 time: 464.796 perplexity for hold out set: 4.826519489288
average_count is: 37 step count: 8961 time: 478.370 perplexity for hold out set: 4.825211048126
average_count is: 38 step count: 9217 time: 492.307 perplexity for hold out set: 4.823949337006
average_count is: 39 step count: 9473 time: 506.006 perplexity for hold out set: 4.822731494904
average_count is: 40 step count: 9729 time: 519.963 perplexity for hold out set: 4.821559906006
average_count is: 41 step count: 9985 time: 533.577 perplexity for hold out set: 4.820431709290
average_count is: 42 step count: 10241 time: 547.257 perplexity for hold out set: 4.819344520569
average_count is: 43 step count: 10497 time: 560.659 perplexity for hold out set: 4.818295001984
average_count is: 44 step count: 10753 time: 574.611 perplexity for hold out set: 4.817280292511
average_count is: 45 step count: 11009 time: 588.075 perplexity for hold out set: 4.816299438477
average_count is: 46 step count: 11265 time: 602.092 perplexity for hold out set: 4.815350055695
average_count is: 47 step count: 11521 time: 616.071 perplexity for hold out set: 4.814429759979
average_count is: 48 step count: 11777 time: 630.040 perplexity for hold out set: 4.813539028168
average_count is: 49 step count: 12033 time: 644.016 perplexity for hold out set: 4.812674045563
average_count is: 50 step count: 12289 time: 657.663 perplexity for hold out set: 4.811835765839
average_count is: 51 step count: 12545 time: 671.561 perplexity for hold out set: 4.811019897461
average_count is: 52 step count: 12801 time: 685.313 perplexity for hold out set: 4.810232639313
average_count is: 53 step count: 13057 time: 698.945 perplexity for hold out set: 4.809465885162
average_count is: 54 step count: 13313 time: 713.119 perplexity for hold out set: 4.808721065521
average_count is: 55 step count: 13569 time: 726.971 perplexity for hold out set: 4.807995319366
average_count is: 56 step count: 13825 time: 740.566 perplexity for hold out set: 4.807290554047
average_count is: 57 step count: 14081 time: 753.843 perplexity for hold out set: 4.806605339050
average_count is: 58 step count: 14337 time: 767.466 perplexity for hold out set: 4.805936336517
average_count is: 59 step count: 14593 time: 781.391 perplexity for hold out set: 4.805284500122
average_count is: 60 step count: 14849 time: 794.624 perplexity for hold out set: 4.804649829865
average_count is: 61 step count: 15105 time: 808.118 perplexity for hold out set: 4.804030895233
average_count is: 62 step count: 15361 time: 821.939 perplexity for hold out set: 4.803427696228
average_count is: 63 step count: 15617 time: 835.907 perplexity for hold out set: 4.802838325500
average_count is: 64 step count: 15873 time: 849.689 perplexity for hold out set: 4.802263736725
average_count is: 65 step count: 16129 time: 863.523 perplexity for hold out set: 4.801702499390
average_count is: 66 step count: 16385 time: 876.890 perplexity for hold out set: 4.801153659821
average_count is: 67 step count: 16641 time: 890.760 perplexity for hold out set: 4.800619125366
average_count is: 68 step count: 16897 time: 904.704 perplexity for hold out set: 4.800097942352
average_count is: 69 step count: 17153 time: 918.058 perplexity for hold out set: 4.799587726593
average_count is: 70 step count: 17409 time: 932.094 perplexity for hold out set: 4.799088478088
average_count is: 71 step count: 17665 time: 946.049 perplexity for hold out set: 4.798601627350
average_count is: 72 step count: 17921 time: 959.136 perplexity for hold out set: 4.798125743866
average_count is: 73 step count: 18177 time: 972.445 perplexity for hold out set: 4.797660827637
average_count is: 74 step count: 18433 time: 986.225 perplexity for hold out set: 4.797205448151
average_count is: 75 step count: 18689 time: 999.232 perplexity for hold out set: 4.796760082245
average_count is: 76 step count: 18945 time: 1012.979 perplexity for hold out set: 4.796323776245
average_count is: 77 step count: 19201 time: 1026.854 perplexity for hold out set: 4.795895576477
average_count is: 78 step count: 19457 time: 1040.787 perplexity for hold out set: 4.795475959778
average_count is: 79 step count: 19713 time: 1054.783 perplexity for hold out set: 4.795065402985
average_count is: 80 step count: 19969 time: 1068.509 perplexity for hold out set: 4.794661998749
average_count is: 81 step count: 20225 time: 1082.439 perplexity for hold out set: 4.794266223907
average_count is: 82 step count: 20481 time: 1096.319 perplexity for hold out set: 4.793878078461
average_count is: 83 step count: 20737 time: 1110.082 perplexity for hold out set: 4.793497085571
average_count is: 84 step count: 20993 time: 1123.683 perplexity for hold out set: 4.793123722076
average_count is: 85 step count: 21249 time: 1137.646 perplexity for hold out set: 4.792758941650
average_count is: 86 step count: 21505 time: 1151.363 perplexity for hold out set: 4.792398452759
average_count is: 87 step count: 21761 time: 1165.210 perplexity for hold out set: 4.792044639587
average_count is: 88 step count: 22017 time: 1178.724 perplexity for hold out set: 4.791697025299
average_count is: 89 step count: 22273 time: 1192.600 perplexity for hold out set: 4.791355133057
average_count is: 90 step count: 22529 time: 1205.841 perplexity for hold out set: 4.791018962860
average_count is: 91 step count: 22785 time: 1219.639 perplexity for hold out set: 4.790689468384
average_count is: 92 step count: 23041 time: 1233.089 perplexity for hold out set: 4.790365219116
average_count is: 93 step count: 23297 time: 1246.764 perplexity for hold out set: 4.790046691895
average_count is: 94 step count: 23553 time: 1260.402 perplexity for hold out set: 4.789733409882
average_count is: 95 step count: 23809 time: 1274.331 perplexity for hold out set: 4.789425849915
average_count is: 96 step count: 24065 time: 1287.952 perplexity for hold out set: 4.789123535156
average_count is: 97 step count: 24321 time: 1301.497 perplexity for hold out set: 4.788826465607
average_count is: 98 step count: 24577 time: 1315.499 perplexity for hold out set: 4.788534164429
average_count is: 99 step count: 24833 time: 1328.397 perplexity for hold out set: 4.788246631622
average_count is: 100 step count: 25089 time: 1341.872 perplexity for hold out set: 4.787964344025
average_count is: 101 step count: 25345 time: 1355.054 perplexity for hold out set: 4.787686347961
average_count is: 102 step count: 25601 time: 1368.941 perplexity for hold out set: 4.787412643433
average_count is: 103 step count: 25857 time: 1382.237 perplexity for hold out set: 4.787143707275
average_count is: 104 step count: 26113 time: 1396.040 perplexity for hold out set: 4.786878108978
average_count is: 105 step count: 26369 time: 1409.327 perplexity for hold out set: 4.786617755890
average_count is: 106 step count: 26625 time: 1422.334 perplexity for hold out set: 4.786360740662
average_count is: 107 step count: 26881 time: 1436.206 perplexity for hold out set: 4.786108493805
average_count is: 108 step count: 27137 time: 1449.626 perplexity for hold out set: 4.785860538483
average_count is: 109 step count: 27393 time: 1463.081 perplexity for hold out set: 4.785615921021
average_count is: 110 step count: 27649 time: 1476.912 perplexity for hold out set: 4.785375118256
average_count is: 111 step count: 27905 time: 1490.519 perplexity for hold out set: 4.785137653351
average_count is: 112 step count: 28161 time: 1504.330 perplexity for hold out set: 4.784903526306
average_count is: 113 step count: 28417 time: 1518.326 perplexity for hold out set: 4.784673213959
average_count is: 114 step count: 28673 time: 1532.208 perplexity for hold out set: 4.784445285797
average_count is: 115 step count: 28929 time: 1545.633 perplexity for hold out set: 4.784221649170
average_count is: 116 step count: 29185 time: 1559.166 perplexity for hold out set: 4.784000873566
average_count is: 117 step count: 29441 time: 1572.464 perplexity for hold out set: 4.783783435822
average_count is: 118 step count: 29697 time: 1586.072 perplexity for hold out set: 4.783569335938
average_count is: 119 step count: 29953 time: 1599.245 perplexity for hold out set: 4.783357620239
average_count is: 120 step count: 30209 time: 1612.624 perplexity for hold out set: 4.783150672913
average_count is: 121 step count: 30465 time: 1626.402 perplexity for hold out set: 4.782945632935
average_count is: 122 step count: 30721 time: 1640.283 perplexity for hold out set: 4.782743453979
average_count is: 123 step count: 30977 time: 1653.785 perplexity for hold out set: 4.782544136047
average_count is: 124 step count: 31233 time: 1667.053 perplexity for hold out set: 4.782347679138
average_count is: 125 step count: 31489 time: 1680.766 perplexity for hold out set: 4.782153606415
average_count is: 126 step count: 31745 time: 1694.131 perplexity for hold out set: 4.781962394714
average_count is: 127 step count: 32001 time: 1708.184 perplexity for hold out set: 4.781774044037
average_count is: 128 step count: 32257 time: 1722.158 perplexity for hold out set: 4.781587600708
average_count is: 129 step count: 32513 time: 1736.030 perplexity for hold out set: 4.781404018402
average_count is: 130 step count: 32769 time: 1749.969 perplexity for hold out set: 4.781222820282
average_count is: 131 step count: 33025 time: 1763.707 perplexity for hold out set: 4.781044006348
average_count is: 132 step count: 33281 time: 1777.484 perplexity for hold out set: 4.780867576599
average_count is: 133 step count: 33537 time: 1791.405 perplexity for hold out set: 4.780693054199
average_count is: 134 step count: 33793 time: 1804.438 perplexity for hold out set: 4.780521392822
average_count is: 135 step count: 34049 time: 1818.186 perplexity for hold out set: 4.780352115631
average_count is: 136 step count: 34305 time: 1831.429 perplexity for hold out set: 4.780184745789
average_count is: 137 step count: 34561 time: 1845.214 perplexity for hold out set: 4.780019283295
average_count is: 138 step count: 34817 time: 1859.071 perplexity for hold out set: 4.779856204987
average_count is: 139 step count: 35073 time: 1873.002 perplexity for hold out set: 4.779695510864
average_count is: 140 step count: 35329 time: 1887.053 perplexity for hold out set: 4.779536247253
average_count is: 141 step count: 35585 time: 1900.323 perplexity for hold out set: 4.779379367828
average_count is: 142 step count: 35841 time: 1914.165 perplexity for hold out set: 4.779223442078
average_count is: 143 step count: 36097 time: 1927.623 perplexity for hold out set: 4.779069900513
average_count is: 144 step count: 36353 time: 1941.422 perplexity for hold out set: 4.778917789459
average_count is: 145 step count: 36609 time: 1954.955 perplexity for hold out set: 4.778768539429
average_count is: 146 step count: 36865 time: 1968.535 perplexity for hold out set: 4.778620719910
average_count is: 147 step count: 37121 time: 1982.440 perplexity for hold out set: 4.778474807739
average_count is: 148 step count: 37377 time: 1996.106 perplexity for hold out set: 4.778330326080
average_count is: 149 step count: 37633 time: 2009.693 perplexity for hold out set: 4.778187274933
average_count is: 150 step count: 37889 time: 2023.379 perplexity for hold out set: 4.778046131134
average_count is: 151 step count: 38145 time: 2037.304 perplexity for hold out set: 4.777906417847
average_count is: 152 step count: 38401 time: 2050.667 perplexity for hold out set: 4.777768611908
average_count is: 153 step count: 38657 time: 2064.182 perplexity for hold out set: 4.777632236481
average_count is: 154 step count: 38913 time: 2077.959 perplexity for hold out set: 4.777498245239
average_count is: 155 step count: 39169 time: 2091.613 perplexity for hold out set: 4.777364730835
average_count is: 156 step count: 39425 time: 2105.176 perplexity for hold out set: 4.777233600616
average_count is: 157 step count: 39681 time: 2118.948 perplexity for hold out set: 4.777103424072
average_count is: 158 step count: 39937 time: 2132.628 perplexity for hold out set: 4.776975631714
average_count is: 159 step count: 40193 time: 2145.740 perplexity for hold out set: 4.776848793030
average_count is: 160 step count: 40449 time: 2159.149 perplexity for hold out set: 4.776723384857
average_count is: 161 step count: 40705 time: 2172.662 perplexity for hold out set: 4.776598930359
average_count is: 162 step count: 40961 time: 2186.716 perplexity for hold out set: 4.776476860046
average_count is: 163 step count: 41217 time: 2200.648 perplexity for hold out set: 4.776355266571
average_count is: 164 step count: 41473 time: 2214.701 perplexity for hold out set: 4.776235580444
average_count is: 165 step count: 41729 time: 2228.593 perplexity for hold out set: 4.776115894318
average_count is: 166 step count: 41985 time: 2242.434 perplexity for hold out set: 4.775999069214
average_count is: 167 step count: 42241 time: 2256.460 perplexity for hold out set: 4.775882720947
average_count is: 168 step count: 42497 time: 2269.625 perplexity for hold out set: 4.775767803192
average_count is: 169 step count: 42753 time: 2283.047 perplexity for hold out set: 4.775653839111
average_count is: 170 step count: 43009 time: 2296.777 perplexity for hold out set: 4.775541305542
average_count is: 171 step count: 43265 time: 2310.292 perplexity for hold out set: 4.775430202484
average_count is: 172 step count: 43521 time: 2323.924 perplexity for hold out set: 4.775320053101
average_count is: 173 step count: 43777 time: 2337.558 perplexity for hold out set: 4.775211811066
average_count is: 174 step count: 44033 time: 2351.318 perplexity for hold out set: 4.775104045868
average_count is: 175 step count: 44289 time: 2364.657 perplexity for hold out set: 4.774997234344
average_count is: 176 step count: 44545 time: 2378.389 perplexity for hold out set: 4.774891853333
average_count is: 177 step count: 44801 time: 2392.110 perplexity for hold out set: 4.774787425995
average_count is: 178 step count: 45057 time: 2405.873 perplexity for hold out set: 4.774684429169
average_count is: 179 step count: 45313 time: 2418.850 perplexity for hold out set: 4.774581909180
average_count is: 180 step count: 45569 time: 2432.377 perplexity for hold out set: 4.774481296539
average_count is: 181 step count: 45825 time: 2446.242 perplexity for hold out set: 4.774380683899
average_count is: 182 step count: 46081 time: 2460.261 perplexity for hold out set: 4.774281024933
average_count is: 183 step count: 46337 time: 2473.976 perplexity for hold out set: 4.774182796478
average_count is: 184 step count: 46593 time: 2487.877 perplexity for hold out set: 4.774086475372
average_count is: 185 step count: 46849 time: 2501.459 perplexity for hold out set: 4.773990631104
average_count is: 186 step count: 47105 time: 2515.466 perplexity for hold out set: 4.773895263672
average_count is: 187 step count: 47361 time: 2529.073 perplexity for hold out set: 4.773801326752
average_count is: 188 step count: 47617 time: 2542.913 perplexity for hold out set: 4.773707389832
average_count is: 189 step count: 47873 time: 2556.762 perplexity for hold out set: 4.773614883423
average_count is: 190 step count: 48129 time: 2570.648 perplexity for hold out set: 4.773523807526
average_count is: 191 step count: 48385 time: 2584.033 perplexity for hold out set: 4.773432731628
average_count is: 192 step count: 48641 time: 2597.395 perplexity for hold out set: 4.773342609406
average_count is: 193 step count: 48897 time: 2610.866 perplexity for hold out set: 4.773253440857
average_count is: 194 step count: 49153 time: 2624.854 perplexity for hold out set: 4.773165225983
average_count is: 195 step count: 49409 time: 2638.630 perplexity for hold out set: 4.773078441620
average_count is: 196 step count: 49665 time: 2652.018 perplexity for hold out set: 4.772991657257
average_count is: 197 step count: 49921 time: 2665.824 perplexity for hold out set: 4.772905826569
average_count is: 198 step count: 50177 time: 2678.861 perplexity for hold out set: 4.772821426392
average_count is: 199 step count: 50433 time: 2692.523 perplexity for hold out set: 4.772737979889
average_count is: 200 step count: 50689 time: 2706.430 perplexity for hold out set: 4.772654056549
average_count is: 201 step count: 50945 time: 2720.317 perplexity for hold out set: 4.772571563721
average_count is: 202 step count: 51201 time: 2734.108 perplexity for hold out set: 4.772490501404
average_count is: 203 step count: 51457 time: 2747.881 perplexity for hold out set: 4.772409439087
average_count is: 204 step count: 51713 time: 2761.186 perplexity for hold out set: 4.772329807281
average_count is: 205 step count: 51969 time: 2775.012 perplexity for hold out set: 4.772250652313
average_count is: 206 step count: 52225 time: 2789.021 perplexity for hold out set: 4.772172451019
average_count is: 207 step count: 52481 time: 2802.060 perplexity for hold out set: 4.772094249725
average_count is: 208 step count: 52737 time: 2816.097 perplexity for hold out set: 4.772017002106
average_count is: 209 step count: 52993 time: 2829.851 perplexity for hold out set: 4.771940708160
average_count is: 210 step count: 53249 time: 2843.633 perplexity for hold out set: 4.771865844727
average_count is: 211 step count: 53505 time: 2857.538 perplexity for hold out set: 4.771790027618
average_count is: 212 step count: 53761 time: 2871.159 perplexity for hold out set: 4.771716117859
average_count is: 213 step count: 54017 time: 2884.852 perplexity for hold out set: 4.771642684937
average_count is: 214 step count: 54273 time: 2898.413 perplexity for hold out set: 4.771568775177
average_count is: 215 step count: 54529 time: 2911.976 perplexity for hold out set: 4.771496772766
average_count is: 216 step count: 54785 time: 2925.761 perplexity for hold out set: 4.771424770355
average_count is: 217 step count: 55041 time: 2939.079 perplexity for hold out set: 4.771353244781
average_count is: 218 step count: 55297 time: 2952.757 perplexity for hold out set: 4.771282196045
average_count is: 219 step count: 55553 time: 2966.521 perplexity for hold out set: 4.771212100983
average_count is: 220 step count: 55809 time: 2979.948 perplexity for hold out set: 4.771142482758
average_count is: 221 step count: 56065 time: 2993.685 perplexity for hold out set: 4.771073818207
average_count is: 222 step count: 56321 time: 3007.576 perplexity for hold out set: 4.771005630493
average_count is: 223 step count: 56577 time: 3020.913 perplexity for hold out set: 4.770937919617
average_count is: 224 step count: 56833 time: 3034.421 perplexity for hold out set: 4.770870685577
average_count is: 225 step count: 57089 time: 3047.969 perplexity for hold out set: 4.770803928375
average_count is: 226 step count: 57345 time: 3061.669 perplexity for hold out set: 4.770737648010
average_count is: 227 step count: 57601 time: 3075.103 perplexity for hold out set: 4.770672321320
average_count is: 228 step count: 57857 time: 3088.716 perplexity for hold out set: 4.770607471466
average_count is: 229 step count: 58113 time: 3102.496 perplexity for hold out set: 4.770543575287
average_count is: 230 step count: 58369 time: 3116.190 perplexity for hold out set: 4.770479679108
average_count is: 231 step count: 58625 time: 3129.837 perplexity for hold out set: 4.770416736603
average_count is: 232 step count: 58881 time: 3143.709 perplexity for hold out set: 4.770353794098
average_count is: 233 step count: 59137 time: 3157.633 perplexity for hold out set: 4.770291805267
average_count is: 234 step count: 59393 time: 3171.572 perplexity for hold out set: 4.770230293274
average_count is: 235 step count: 59649 time: 3185.378 perplexity for hold out set: 4.770169258118
average_count is: 236 step count: 59905 time: 3199.275 perplexity for hold out set: 4.770108699799
average_count is: 237 step count: 60161 time: 3212.603 perplexity for hold out set: 4.770048618317
average_count is: 238 step count: 60417 time: 3226.522 perplexity for hold out set: 4.769989013672
average_count is: 239 step count: 60673 time: 3240.462 perplexity for hold out set: 4.769930362701
average_count is: 240 step count: 60929 time: 3253.815 perplexity for hold out set: 4.769871234894
average_count is: 241 step count: 61185 time: 3266.887 perplexity for hold out set: 4.769814014435
average_count is: 242 step count: 61441 time: 3280.071 perplexity for hold out set: 4.769755840302
average_count is: 243 step count: 61697 time: 3293.422 perplexity for hold out set: 4.769698619843
average_count is: 244 step count: 61953 time: 3306.729 perplexity for hold out set: 4.769641399384
average_count is: 245 step count: 62209 time: 3320.525 perplexity for hold out set: 4.769585132599
average_count is: 246 step count: 62465 time: 3334.279 perplexity for hold out set: 4.769529342651
average_count is: 247 step count: 62721 time: 3347.806 perplexity for hold out set: 4.769473552704
average_count is: 248 step count: 62977 time: 3361.766 perplexity for hold out set: 4.769418239594
average_count is: 249 step count: 63233 time: 3375.296 perplexity for hold out set: 4.769363403320
average_count is: 250 step count: 63489 time: 3388.972 perplexity for hold out set: 4.769309043884
average_count is: 251 step count: 63745 time: 3402.909 perplexity for hold out set: 4.769255161285
average_count is: 252 step count: 64001 time: 3416.887 perplexity for hold out set: 4.769201755524
average_count is: 253 step count: 64257 time: 3430.225 perplexity for hold out set: 4.769149780273
average_count is: 254 step count: 64513 time: 3443.474 perplexity for hold out set: 4.769096374512
average_count is: 255 step count: 64769 time: 3457.232 perplexity for hold out set: 4.769044876099
average_count is: 256 step count: 65025 time: 3470.880 perplexity for hold out set: 4.768992900848
average_count is: 257 step count: 65281 time: 3484.520 perplexity for hold out set: 4.768941879272
timer                                    total (s)    ticks  per tick (us)
  load network graph                        3.000        1    3000469.734
  initialize DKV store                      0.776        1     776055.486
  populate pi                               0.001        1       1417.394
  iteration                              3497.938    65535      53375.117
    deploy minibatch                      135.774    65536       2071.754
      scatter subgraph                     15.300    65536        233.470
        marshall edge count                 5.110    65536         77.982
        scatterv edges                      0.877    65536         13.391
        marshall edges                      6.911    65536        105.464
        scatterv edges                      2.221    65536         33.893
        unmarshall edges                    0.004    65536          0.074
      sample_mini_batch                    51.525    65536        786.214
      nodes_in_mini_batch                  23.456    65536        357.912
    broadcast theta/beta                  172.434    65535       2631.183
    update_phi_pi                        2247.761    65535      34298.637
      create minibatch slice chunks         0.024    65536          0.375
      reorder minibatch overlap     <unused>
      sample_neighbor_nodes                 6.897    65536        105.255
      resample_neighbor_nodes       <unused>
      load minibatch pi                     0.185   131071          1.418
      load neighbor pi                      0.081   131071          0.625
      update_phi                           13.328   131070        101.687
      barrier after update phi           1842.568    65535      28115.788
      update_pi                     <unused>
      store minibatch pi            <unused>
      barrier after update pi             248.263    65535       3788.258
    update_beta_theta                    1021.112    65535      15581.184
      zero beta grads                      19.197    65535        292.941
      rank minibatch nodes                  1.361    65535         20.777
      load pi update_beta                  65.058    65535        992.733
      beta calc grads                     105.364    65535       1607.759
      beta sum grads                       29.437    65535        449.192
      beta reduce(+) grads                619.086    65535       9446.651
      update theta                        131.493    65535       2006.460
  perplexity                               53.684      256     209704.663
      load perplexity pi                   42.316      256     165298.397
      calc edge likelihood                 10.639      256      41559.611
      purge perplexity pi                   0.000      256          3.799
      reduce/plus perplexity                0.718      256       2807.689
average_count is: 258 step count: 65537 time: 3498.239 perplexity for hold out set: 4.768890380859
average_count is: 259 step count: 65793 time: 3512.072 perplexity for hold out set: 4.768839836121
average_count is: 260 step count: 66049 time: 3525.876 perplexity for hold out set: 4.768789768219
average_count is: 261 step count: 66305 time: 3539.808 perplexity for hold out set: 4.768740177155
average_count is: 262 step count: 66561 time: 3553.478 perplexity for hold out set: 4.768690586090
average_count is: 263 step count: 66817 time: 3567.182 perplexity for hold out set: 4.768641948700
average_count is: 264 step count: 67073 time: 3580.254 perplexity for hold out set: 4.768592834473
average_count is: 265 step count: 67329 time: 3594.111 perplexity for hold out set: 4.768544673920
average_count is: 266 step count: 67585 time: 3608.034 perplexity for hold out set: 4.768496036530
average_count is: 267 step count: 67841 time: 3621.747 perplexity for hold out set: 4.768448352814
average_count is: 268 step count: 68097 time: 3635.496 perplexity for hold out set: 4.768401145935
average_count is: 269 step count: 68353 time: 3649.274 perplexity for hold out set: 4.768353939056
average_count is: 270 step count: 68609 time: 3662.594 perplexity for hold out set: 4.768307685852
average_count is: 271 step count: 68865 time: 3676.271 perplexity for hold out set: 4.768260955811
average_count is: 272 step count: 69121 time: 3690.201 perplexity for hold out set: 4.768215179443
average_count is: 273 step count: 69377 time: 3703.837 perplexity for hold out set: 4.768169403076
average_count is: 274 step count: 69633 time: 3717.923 perplexity for hold out set: 4.768123626709
average_count is: 275 step count: 69889 time: 3731.720 perplexity for hold out set: 4.768078327179
average_count is: 276 step count: 70145 time: 3745.593 perplexity for hold out set: 4.768033504486
average_count is: 277 step count: 70401 time: 3759.565 perplexity for hold out set: 4.767989635468
average_count is: 278 step count: 70657 time: 3772.926 perplexity for hold out set: 4.767944812775
average_count is: 279 step count: 70913 time: 3786.597 perplexity for hold out set: 4.767900466919
average_count is: 280 step count: 71169 time: 3800.348 perplexity for hold out set: 4.767857074738
average_count is: 281 step count: 71425 time: 3813.758 perplexity for hold out set: 4.767814159393
average_count is: 282 step count: 71681 time: 3827.568 perplexity for hold out set: 4.767771244049
average_count is: 283 step count: 71937 time: 3841.583 perplexity for hold out set: 4.767727851868
average_count is: 284 step count: 72193 time: 3855.115 perplexity for hold out set: 4.767685890198
average_count is: 285 step count: 72449 time: 3868.980 perplexity for hold out set: 4.767643928528
average_count is: 286 step count: 72705 time: 3882.826 perplexity for hold out set: 4.767602443695
average_count is: 287 step count: 72961 time: 3896.663 perplexity for hold out set: 4.767560958862
average_count is: 288 step count: 73217 time: 3910.216 perplexity for hold out set: 4.767519474030
average_count is: 289 step count: 73473 time: 3924.091 perplexity for hold out set: 4.767478466034
average_count is: 290 step count: 73729 time: 3937.305 perplexity for hold out set: 4.767437934875
average_count is: 291 step count: 73985 time: 3950.908 perplexity for hold out set: 4.767397880554
average_count is: 292 step count: 74241 time: 3964.618 perplexity for hold out set: 4.767357349396
average_count is: 293 step count: 74497 time: 3978.410 perplexity for hold out set: 4.767317295074
average_count is: 294 step count: 74753 time: 3992.132 perplexity for hold out set: 4.767278194427
average_count is: 295 step count: 75009 time: 4006.097 perplexity for hold out set: 4.767238616943
average_count is: 296 step count: 75265 time: 4019.915 perplexity for hold out set: 4.767199516296
average_count is: 297 step count: 75521 time: 4033.392 perplexity for hold out set: 4.767161369324
average_count is: 298 step count: 75777 time: 4047.402 perplexity for hold out set: 4.767122745514
average_count is: 299 step count: 76033 time: 4060.996 perplexity for hold out set: 4.767084598541
average_count is: 300 step count: 76289 time: 4074.825 perplexity for hold out set: 4.767046451569
average_count is: 301 step count: 76545 time: 4088.742 perplexity for hold out set: 4.767009258270
average_count is: 302 step count: 76801 time: 4102.436 perplexity for hold out set: 4.766972064972
average_count is: 303 step count: 77057 time: 4116.160 perplexity for hold out set: 4.766934871674
average_count is: 304 step count: 77313 time: 4129.494 perplexity for hold out set: 4.766898155212
average_count is: 305 step count: 77569 time: 4143.501 perplexity for hold out set: 4.766861438751
average_count is: 306 step count: 77825 time: 4157.315 perplexity for hold out set: 4.766825199127
average_count is: 307 step count: 78081 time: 4171.019 perplexity for hold out set: 4.766788959503
average_count is: 308 step count: 78337 time: 4184.850 perplexity for hold out set: 4.766753196716
average_count is: 309 step count: 78593 time: 4198.439 perplexity for hold out set: 4.766717910767
average_count is: 310 step count: 78849 time: 4212.321 perplexity for hold out set: 4.766682147980
average_count is: 311 step count: 79105 time: 4225.182 perplexity for hold out set: 4.766646385193
average_count is: 312 step count: 79361 time: 4239.073 perplexity for hold out set: 4.766611099243
average_count is: 313 step count: 79617 time: 4252.774 perplexity for hold out set: 4.766576766968
average_count is: 314 step count: 79873 time: 4266.778 perplexity for hold out set: 4.766541957855
average_count is: 315 step count: 80129 time: 4280.662 perplexity for hold out set: 4.766507625580
average_count is: 316 step count: 80385 time: 4293.964 perplexity for hold out set: 4.766473770142
average_count is: 317 step count: 80641 time: 4307.484 perplexity for hold out set: 4.766439914703
average_count is: 318 step count: 80897 time: 4321.300 perplexity for hold out set: 4.766405582428
average_count is: 319 step count: 81153 time: 4334.899 perplexity for hold out set: 4.766372203827
average_count is: 320 step count: 81409 time: 4348.836 perplexity for hold out set: 4.766339302063
average_count is: 321 step count: 81665 time: 4362.601 perplexity for hold out set: 4.766305923462
average_count is: 322 step count: 81921 time: 4376.163 perplexity for hold out set: 4.766273021698
average_count is: 323 step count: 82177 time: 4389.769 perplexity for hold out set: 4.766241073608
average_count is: 324 step count: 82433 time: 4403.723 perplexity for hold out set: 4.766208648682
average_count is: 325 step count: 82689 time: 4417.150 perplexity for hold out set: 4.766175746918
average_count is: 326 step count: 82945 time: 4431.040 perplexity for hold out set: 4.766143321991
average_count is: 327 step count: 83201 time: 4444.681 perplexity for hold out set: 4.766111373901
average_count is: 328 step count: 83457 time: 4457.528 perplexity for hold out set: 4.766079902649
average_count is: 329 step count: 83713 time: 4471.124 perplexity for hold out set: 4.766048908234
average_count is: 330 step count: 83969 time: 4484.799 perplexity for hold out set: 4.766017436981
average_count is: 331 step count: 84225 time: 4498.181 perplexity for hold out set: 4.765986442566
average_count is: 332 step count: 84481 time: 4511.950 perplexity for hold out set: 4.765955448151
average_count is: 333 step count: 84737 time: 4525.556 perplexity for hold out set: 4.765924930573
average_count is: 334 step count: 84993 time: 4539.330 perplexity for hold out set: 4.765894412994
average_count is: 335 step count: 85249 time: 4553.257 perplexity for hold out set: 4.765864372253
average_count is: 336 step count: 85505 time: 4566.467 perplexity for hold out set: 4.765833377838
average_count is: 337 step count: 85761 time: 4580.160 perplexity for hold out set: 4.765803813934
average_count is: 338 step count: 86017 time: 4593.516 perplexity for hold out set: 4.765773773193
average_count is: 339 step count: 86273 time: 4607.316 perplexity for hold out set: 4.765744209290
average_count is: 340 step count: 86529 time: 4621.120 perplexity for hold out set: 4.765714645386
average_count is: 341 step count: 86785 time: 4634.057 perplexity for hold out set: 4.765685081482
average_count is: 342 step count: 87041 time: 4647.799 perplexity for hold out set: 4.765656471252
average_count is: 343 step count: 87297 time: 4661.353 perplexity for hold out set: 4.765626907349
average_count is: 344 step count: 87553 time: 4674.652 perplexity for hold out set: 4.765598297119
average_count is: 345 step count: 87809 time: 4688.024 perplexity for hold out set: 4.765569686890
average_count is: 346 step count: 88065 time: 4701.515 perplexity for hold out set: 4.765541076660
average_count is: 347 step count: 88321 time: 4714.835 perplexity for hold out set: 4.765512943268
average_count is: 348 step count: 88577 time: 4728.474 perplexity for hold out set: 4.765484333038
average_count is: 349 step count: 88833 time: 4742.315 perplexity for hold out set: 4.765455722809
average_count is: 350 step count: 89089 time: 4756.126 perplexity for hold out set: 4.765428066254
average_count is: 351 step count: 89345 time: 4769.573 perplexity for hold out set: 4.765400409698
average_count is: 352 step count: 89601 time: 4783.330 perplexity for hold out set: 4.765372753143
average_count is: 353 step count: 89857 time: 4796.578 perplexity for hold out set: 4.765345096588
average_count is: 354 step count: 90113 time: 4810.468 perplexity for hold out set: 4.765317916870
average_count is: 355 step count: 90369 time: 4824.097 perplexity for hold out set: 4.765291213989
average_count is: 356 step count: 90625 time: 4837.668 perplexity for hold out set: 4.765264034271
average_count is: 357 step count: 90881 time: 4851.428 perplexity for hold out set: 4.765237331390
average_count is: 358 step count: 91137 time: 4864.912 perplexity for hold out set: 4.765210151672
average_count is: 359 step count: 91393 time: 4878.284 perplexity for hold out set: 4.765183925629
average_count is: 360 step count: 91649 time: 4892.255 perplexity for hold out set: 4.765158176422
average_count is: 361 step count: 91905 time: 4906.276 perplexity for hold out set: 4.765131473541
average_count is: 362 step count: 92161 time: 4920.429 perplexity for hold out set: 4.765105247498
average_count is: 363 step count: 92417 time: 4934.091 perplexity for hold out set: 4.765079498291
average_count is: 364 step count: 92673 time: 4947.949 perplexity for hold out set: 4.765053749084
average_count is: 365 step count: 92929 time: 4961.735 perplexity for hold out set: 4.765027999878
average_count is: 366 step count: 93185 time: 4975.286 perplexity for hold out set: 4.765002727509
average_count is: 367 step count: 93441 time: 4988.967 perplexity for hold out set: 4.764977455139
average_count is: 368 step count: 93697 time: 5002.741 perplexity for hold out set: 4.764952182770
average_count is: 369 step count: 93953 time: 5016.427 perplexity for hold out set: 4.764927387238
average_count is: 370 step count: 94209 time: 5030.393 perplexity for hold out set: 4.764902114868
average_count is: 371 step count: 94465 time: 5044.386 perplexity for hold out set: 4.764877319336
average_count is: 372 step count: 94721 time: 5057.672 perplexity for hold out set: 4.764853000641
average_count is: 373 step count: 94977 time: 5071.696 perplexity for hold out set: 4.764828205109
average_count is: 374 step count: 95233 time: 5085.176 perplexity for hold out set: 4.764803886414
average_count is: 375 step count: 95489 time: 5099.104 perplexity for hold out set: 4.764779567719
average_count is: 376 step count: 95745 time: 5113.043 perplexity for hold out set: 4.764755725861
average_count is: 377 step count: 96001 time: 5126.375 perplexity for hold out set: 4.764731884003
average_count is: 378 step count: 96257 time: 5140.104 perplexity for hold out set: 4.764708042145
average_count is: 379 step count: 96513 time: 5153.804 perplexity for hold out set: 4.764684200287
average_count is: 380 step count: 96769 time: 5167.317 perplexity for hold out set: 4.764660358429
average_count is: 381 step count: 97025 time: 5181.014 perplexity for hold out set: 4.764636993408
average_count is: 382 step count: 97281 time: 5194.464 perplexity for hold out set: 4.764613151550
average_count is: 383 step count: 97537 time: 5208.206 perplexity for hold out set: 4.764590263367
average_count is: 384 step count: 97793 time: 5222.026 perplexity for hold out set: 4.764566898346
average_count is: 385 step count: 98049 time: 5235.465 perplexity for hold out set: 4.764544010162
average_count is: 386 step count: 98305 time: 5249.495 perplexity for hold out set: 4.764521121979
average_count is: 387 step count: 98561 time: 5262.794 perplexity for hold out set: 4.764498233795
average_count is: 388 step count: 98817 time: 5276.667 perplexity for hold out set: 4.764475345612
average_count is: 389 step count: 99073 time: 5290.648 perplexity for hold out set: 4.764452934265
average_count is: 390 step count: 99329 time: 5304.270 perplexity for hold out set: 4.764430046082
average_count is: 391 step count: 99585 time: 5317.847 perplexity for hold out set: 4.764408111572
average_count is: 392 step count: 99841 time: 5331.542 perplexity for hold out set: 4.764385700226
average_count is: 393 step count: 100097 time: 5344.752 perplexity for hold out set: 4.764363288879
average_count is: 394 step count: 100353 time: 5358.702 perplexity for hold out set: 4.764341354370
average_count is: 395 step count: 100609 time: 5372.002 perplexity for hold out set: 4.764319419861
average_count is: 396 step count: 100865 time: 5385.639 perplexity for hold out set: 4.764297485352
average_count is: 397 step count: 101121 time: 5399.458 perplexity for hold out set: 4.764275550842
average_count is: 398 step count: 101377 time: 5412.993 perplexity for hold out set: 4.764254093170
average_count is: 399 step count: 101633 time: 5426.900 perplexity for hold out set: 4.764232635498
average_count is: 400 step count: 101889 time: 5440.823 perplexity for hold out set: 4.764211654663
average_count is: 401 step count: 102145 time: 5454.476 perplexity for hold out set: 4.764190196991
average_count is: 402 step count: 102401 time: 5467.993 perplexity for hold out set: 4.764168739319
average_count is: 403 step count: 102657 time: 5481.159 perplexity for hold out set: 4.764148235321
average_count is: 404 step count: 102913 time: 5494.556 perplexity for hold out set: 4.764127254486
average_count is: 405 step count: 103169 time: 5508.066 perplexity for hold out set: 4.764106273651
average_count is: 406 step count: 103425 time: 5521.892 perplexity for hold out set: 4.764085292816
average_count is: 407 step count: 103681 time: 5535.822 perplexity for hold out set: 4.764064788818
average_count is: 408 step count: 103937 time: 5549.514 perplexity for hold out set: 4.764044284821
average_count is: 409 step count: 104193 time: 5563.231 perplexity for hold out set: 4.764024257660
average_count is: 410 step count: 104449 time: 5576.922 perplexity for hold out set: 4.764003753662
average_count is: 411 step count: 104705 time: 5590.185 perplexity for hold out set: 4.763983249664
average_count is: 412 step count: 104961 time: 5604.041 perplexity for hold out set: 4.763963222504
average_count is: 413 step count: 105217 time: 5617.524 perplexity for hold out set: 4.763942718506
average_count is: 414 step count: 105473 time: 5631.388 perplexity for hold out set: 4.763923168182
average_count is: 415 step count: 105729 time: 5645.049 perplexity for hold out set: 4.763903617859
average_count is: 416 step count: 105985 time: 5658.728 perplexity for hold out set: 4.763884067535
average_count is: 417 step count: 106241 time: 5672.790 perplexity for hold out set: 4.763864040375
average_count is: 418 step count: 106497 time: 5686.413 perplexity for hold out set: 4.763844490051
average_count is: 419 step count: 106753 time: 5699.830 perplexity for hold out set: 4.763824939728
average_count is: 420 step count: 107009 time: 5713.652 perplexity for hold out set: 4.763805389404
average_count is: 421 step count: 107265 time: 5727.617 perplexity for hold out set: 4.763786792755
average_count is: 422 step count: 107521 time: 5741.037 perplexity for hold out set: 4.763767242432
average_count is: 423 step count: 107777 time: 5754.780 perplexity for hold out set: 4.763748168945
average_count is: 424 step count: 108033 time: 5768.562 perplexity for hold out set: 4.763729572296
average_count is: 425 step count: 108289 time: 5782.247 perplexity for hold out set: 4.763710021973
average_count is: 426 step count: 108545 time: 5796.066 perplexity for hold out set: 4.763691425323
average_count is: 427 step count: 108801 time: 5809.516 perplexity for hold out set: 4.763672828674
average_count is: 428 step count: 109057 time: 5823.149 perplexity for hold out set: 4.763653755188
average_count is: 429 step count: 109313 time: 5836.103 perplexity for hold out set: 4.763635635376
average_count is: 430 step count: 109569 time: 5850.011 perplexity for hold out set: 4.763617038727
average_count is: 431 step count: 109825 time: 5863.870 perplexity for hold out set: 4.763598442078
average_count is: 432 step count: 110081 time: 5877.619 perplexity for hold out set: 4.763580322266
average_count is: 433 step count: 110337 time: 5891.541 perplexity for hold out set: 4.763561725616
average_count is: 434 step count: 110593 time: 5905.323 perplexity for hold out set: 4.763544082642
average_count is: 435 step count: 110849 time: 5918.853 perplexity for hold out set: 4.763526439667
average_count is: 436 step count: 111105 time: 5932.422 perplexity for hold out set: 4.763508319855
average_count is: 437 step count: 111361 time: 5946.450 perplexity for hold out set: 4.763490676880
average_count is: 438 step count: 111617 time: 5960.154 perplexity for hold out set: 4.763473033905
average_count is: 439 step count: 111873 time: 5973.848 perplexity for hold out set: 4.763455390930
average_count is: 440 step count: 112129 time: 5987.862 perplexity for hold out set: 4.763437271118
average_count is: 441 step count: 112385 time: 6001.322 perplexity for hold out set: 4.763419628143
average_count is: 442 step count: 112641 time: 6014.463 perplexity for hold out set: 4.763402462006
average_count is: 443 step count: 112897 time: 6028.255 perplexity for hold out set: 4.763385295868
average_count is: 444 step count: 113153 time: 6042.156 perplexity for hold out set: 4.763367652893
average_count is: 445 step count: 113409 time: 6055.809 perplexity for hold out set: 4.763350486755
average_count is: 446 step count: 113665 time: 6069.577 perplexity for hold out set: 4.763333797455
average_count is: 447 step count: 113921 time: 6082.878 perplexity for hold out set: 4.763316631317
average_count is: 448 step count: 114177 time: 6096.720 perplexity for hold out set: 4.763299465179
average_count is: 449 step count: 114433 time: 6110.472 perplexity for hold out set: 4.763282299042
average_count is: 450 step count: 114689 time: 6124.247 perplexity for hold out set: 4.763265609741
average_count is: 451 step count: 114945 time: 6137.928 perplexity for hold out set: 4.763249397278
average_count is: 452 step count: 115201 time: 6151.230 perplexity for hold out set: 4.763232231140
average_count is: 453 step count: 115457 time: 6164.990 perplexity for hold out set: 4.763215541840
average_count is: 454 step count: 115713 time: 6178.541 perplexity for hold out set: 4.763198852539
average_count is: 455 step count: 115969 time: 6192.230 perplexity for hold out set: 4.763183116913
average_count is: 456 step count: 116225 time: 6206.267 perplexity for hold out set: 4.763166427612
average_count is: 457 step count: 116481 time: 6219.664 perplexity for hold out set: 4.763150215149
average_count is: 458 step count: 116737 time: 6233.587 perplexity for hold out set: 4.763134002686
average_count is: 459 step count: 116993 time: 6246.811 perplexity for hold out set: 4.763117790222
average_count is: 460 step count: 117249 time: 6260.644 perplexity for hold out set: 4.763102054596
average_count is: 461 step count: 117505 time: 6274.409 perplexity for hold out set: 4.763085365295
average_count is: 462 step count: 117761 time: 6287.876 perplexity for hold out set: 4.763069629669
average_count is: 463 step count: 118017 time: 6301.556 perplexity for hold out set: 4.763053894043
average_count is: 464 step count: 118273 time: 6315.307 perplexity for hold out set: 4.763037681580
average_count is: 465 step count: 118529 time: 6328.927 perplexity for hold out set: 4.763021945953
average_count is: 466 step count: 118785 time: 6342.725 perplexity for hold out set: 4.763006687164
average_count is: 467 step count: 119041 time: 6356.676 perplexity for hold out set: 4.762990474701
average_count is: 468 step count: 119297 time: 6370.295 perplexity for hold out set: 4.762974739075
average_count is: 469 step count: 119553 time: 6383.521 perplexity for hold out set: 4.762959480286
average_count is: 470 step count: 119809 time: 6396.764 perplexity for hold out set: 4.762944221497
average_count is: 471 step count: 120065 time: 6410.237 perplexity for hold out set: 4.762928485870
average_count is: 472 step count: 120321 time: 6423.855 perplexity for hold out set: 4.762913227081
average_count is: 473 step count: 120577 time: 6436.989 perplexity for hold out set: 4.762897968292
average_count is: 474 step count: 120833 time: 6450.678 perplexity for hold out set: 4.762882232666
average_count is: 475 step count: 121089 time: 6464.683 perplexity for hold out set: 4.762866973877
average_count is: 476 step count: 121345 time: 6478.577 perplexity for hold out set: 4.762852191925
average_count is: 477 step count: 121601 time: 6492.520 perplexity for hold out set: 4.762837409973
average_count is: 478 step count: 121857 time: 6506.504 perplexity for hold out set: 4.762822628021
average_count is: 479 step count: 122113 time: 6519.870 perplexity for hold out set: 4.762807846069
average_count is: 480 step count: 122369 time: 6533.823 perplexity for hold out set: 4.762792587280
average_count is: 481 step count: 122625 time: 6546.936 perplexity for hold out set: 4.762777805328
average_count is: 482 step count: 122881 time: 6560.098 perplexity for hold out set: 4.762763500214
average_count is: 483 step count: 123137 time: 6573.704 perplexity for hold out set: 4.762748718262
average_count is: 484 step count: 123393 time: 6587.464 perplexity for hold out set: 4.762733459473
average_count is: 485 step count: 123649 time: 6601.213 perplexity for hold out set: 4.762719631195
average_count is: 486 step count: 123905 time: 6614.795 perplexity for hold out set: 4.762705326080
average_count is: 487 step count: 124161 time: 6628.601 perplexity for hold out set: 4.762690544128
average_count is: 488 step count: 124417 time: 6642.208 perplexity for hold out set: 4.762676715851
average_count is: 489 step count: 124673 time: 6655.810 perplexity for hold out set: 4.762661933899
average_count is: 490 step count: 124929 time: 6669.614 perplexity for hold out set: 4.762648105621
average_count is: 491 step count: 125185 time: 6683.382 perplexity for hold out set: 4.762634277344
average_count is: 492 step count: 125441 time: 6697.245 perplexity for hold out set: 4.762619495392
average_count is: 493 step count: 125697 time: 6710.863 perplexity for hold out set: 4.762606143951
average_count is: 494 step count: 125953 time: 6724.715 perplexity for hold out set: 4.762591838837
average_count is: 495 step count: 126209 time: 6738.585 perplexity for hold out set: 4.762578010559
average_count is: 496 step count: 126465 time: 6752.310 perplexity for hold out set: 4.762563705444
average_count is: 497 step count: 126721 time: 6765.895 perplexity for hold out set: 4.762550354004
average_count is: 498 step count: 126977 time: 6779.743 perplexity for hold out set: 4.762537002563
average_count is: 499 step count: 127233 time: 6793.475 perplexity for hold out set: 4.762522697449
average_count is: 500 step count: 127489 time: 6807.011 perplexity for hold out set: 4.762509346008
average_count is: 501 step count: 127745 time: 6820.878 perplexity for hold out set: 4.762495517731
average_count is: 502 step count: 128001 time: 6834.385 perplexity for hold out set: 4.762481689453
average_count is: 503 step count: 128257 time: 6846.961 perplexity for hold out set: 4.762468338013
average_count is: 504 step count: 128513 time: 6860.262 perplexity for hold out set: 4.762454509735
average_count is: 505 step count: 128769 time: 6873.657 perplexity for hold out set: 4.762441635132
average_count is: 506 step count: 129025 time: 6887.538 perplexity for hold out set: 4.762428283691
average_count is: 507 step count: 129281 time: 6901.322 perplexity for hold out set: 4.762414455414
average_count is: 508 step count: 129537 time: 6915.018 perplexity for hold out set: 4.762401580811
average_count is: 509 step count: 129793 time: 6928.742 perplexity for hold out set: 4.762388229370
average_count is: 510 step count: 130049 time: 6942.562 perplexity for hold out set: 4.762374877930
average_count is: 511 step count: 130305 time: 6956.357 perplexity for hold out set: 4.762362003326
average_count is: 512 step count: 130561 time: 6969.559 perplexity for hold out set: 4.762349128723
average_count is: 513 step count: 130817 time: 6983.380 perplexity for hold out set: 4.762335777283
timer                                    total (s)    ticks  per tick (us)
  load network graph                        3.000        1    3000469.734
  initialize DKV store                      0.776        1     776055.486
  populate pi                               0.001        1       1417.394
  iteration                              6996.896   131071      53382.494
    deploy minibatch                      272.141   131072       2076.275
      scatter subgraph                     30.666   131072        233.967
        marshall edge count                10.524   131072         80.298
        scatterv edges                      1.753   131072         13.374
        marshall edges                     13.564   131072        103.493
        scatterv edges                      4.463   131072         34.051
        unmarshall edges                    0.009   131072          0.074
      sample_mini_batch                   102.820   131072        784.457
      nodes_in_mini_batch                  46.401   131072        354.013
    broadcast theta/beta                  344.540   131071       2628.658
    update_phi_pi                        4495.346   131071      34297.030
      create minibatch slice chunks         0.048   131072          0.372
      reorder minibatch overlap     <unused>
      sample_neighbor_nodes                13.832   131072        105.537
      resample_neighbor_nodes       <unused>
      load minibatch pi                     0.376   262143          1.436
      load neighbor pi                      0.165   262143          0.633
      update_phi                           26.301   262142        100.334
      barrier after update phi           3686.530   131071      28126.208
      update_pi                     <unused>
      store minibatch pi            <unused>
      barrier after update pi             494.660   131071       3773.990
    update_beta_theta                    2043.859   131071      15593.528
      zero beta grads                      38.203   131071        291.471
      rank minibatch nodes                  2.720   131071         20.755
      load pi update_beta                 130.346   131071        994.472
      beta calc grads                     210.633   131071       1607.015
      beta sum grads                       58.740   131071        448.154
      beta reduce(+) grads               1240.598   131071       9465.086
      update theta                        262.619   131071       2003.646
  perplexity                              107.230      512     209435.006
      load perplexity pi                   84.611      512     165257.194
      calc edge likelihood                 21.218      512      41442.599
      purge perplexity pi                   0.001      512          3.792
      reduce/plus perplexity                1.378      512       2692.259
average_count is: 514 step count: 131073 time: 6997.221 perplexity for hold out set: 4.762322902679
average_count is: 515 step count: 131329 time: 7011.120 perplexity for hold out set: 4.762310504913
average_count is: 516 step count: 131585 time: 7024.981 perplexity for hold out set: 4.762297153473
average_count is: 517 step count: 131841 time: 7038.258 perplexity for hold out set: 4.762284755707
average_count is: 518 step count: 132097 time: 7051.432 perplexity for hold out set: 4.762271881104
average_count is: 519 step count: 132353 time: 7065.143 perplexity for hold out set: 4.762259483337
average_count is: 520 step count: 132609 time: 7078.732 perplexity for hold out set: 4.762246608734
average_count is: 521 step count: 132865 time: 7092.456 perplexity for hold out set: 4.762234210968
average_count is: 522 step count: 133121 time: 7106.357 perplexity for hold out set: 4.762221813202
average_count is: 523 step count: 133377 time: 7120.034 perplexity for hold out set: 4.762209415436
average_count is: 524 step count: 133633 time: 7133.921 perplexity for hold out set: 4.762197017670
average_count is: 525 step count: 133889 time: 7147.763 perplexity for hold out set: 4.762184619904
average_count is: 526 step count: 134145 time: 7161.006 perplexity for hold out set: 4.762172222137
average_count is: 527 step count: 134401 time: 7174.589 perplexity for hold out set: 4.762160301208
average_count is: 528 step count: 134657 time: 7188.028 perplexity for hold out set: 4.762147903442
average_count is: 529 step count: 134913 time: 7201.252 perplexity for hold out set: 4.762135028839
average_count is: 530 step count: 135169 time: 7214.766 perplexity for hold out set: 4.762123107910
average_count is: 531 step count: 135425 time: 7228.726 perplexity for hold out set: 4.762111663818
average_count is: 532 step count: 135681 time: 7241.570 perplexity for hold out set: 4.762099266052
average_count is: 533 step count: 135937 time: 7255.299 perplexity for hold out set: 4.762087345123
average_count is: 534 step count: 136193 time: 7269.053 perplexity for hold out set: 4.762074947357
average_count is: 535 step count: 136449 time: 7282.360 perplexity for hold out set: 4.762063026428
average_count is: 536 step count: 136705 time: 7295.519 perplexity for hold out set: 4.762051582336
average_count is: 537 step count: 136961 time: 7309.322 perplexity for hold out set: 4.762039184570
average_count is: 538 step count: 137217 time: 7322.869 perplexity for hold out set: 4.762027263641
average_count is: 539 step count: 137473 time: 7336.401 perplexity for hold out set: 4.762016296387
average_count is: 540 step count: 137729 time: 7349.831 perplexity for hold out set: 4.762004375458
average_count is: 541 step count: 137985 time: 7363.499 perplexity for hold out set: 4.761992931366
average_count is: 542 step count: 138241 time: 7376.984 perplexity for hold out set: 4.761981010437
average_count is: 543 step count: 138497 time: 7390.974 perplexity for hold out set: 4.761969566345
average_count is: 544 step count: 138753 time: 7404.976 perplexity for hold out set: 4.761957645416
average_count is: 545 step count: 139009 time: 7418.509 perplexity for hold out set: 4.761946678162
average_count is: 546 step count: 139265 time: 7432.502 perplexity for hold out set: 4.761935234070
average_count is: 547 step count: 139521 time: 7445.971 perplexity for hold out set: 4.761923313141
average_count is: 548 step count: 139777 time: 7459.292 perplexity for hold out set: 4.761911869049
average_count is: 549 step count: 140033 time: 7473.183 perplexity for hold out set: 4.761900901794
average_count is: 550 step count: 140289 time: 7486.745 perplexity for hold out set: 4.761889457703
average_count is: 551 step count: 140545 time: 7500.244 perplexity for hold out set: 4.761878490448
average_count is: 552 step count: 140801 time: 7513.627 perplexity for hold out set: 4.761866569519
average_count is: 553 step count: 141057 time: 7527.202 perplexity for hold out set: 4.761856079102
average_count is: 554 step count: 141313 time: 7540.877 perplexity for hold out set: 4.761844635010
average_count is: 555 step count: 141569 time: 7554.827 perplexity for hold out set: 4.761833667755
average_count is: 556 step count: 141825 time: 7568.343 perplexity for hold out set: 4.761822700500
average_count is: 557 step count: 142081 time: 7582.287 perplexity for hold out set: 4.761811733246
average_count is: 558 step count: 142337 time: 7595.880 perplexity for hold out set: 4.761800765991
average_count is: 559 step count: 142593 time: 7609.576 perplexity for hold out set: 4.761789798737
average_count is: 560 step count: 142849 time: 7623.431 perplexity for hold out set: 4.761779308319
average_count is: 561 step count: 143105 time: 7636.945 perplexity for hold out set: 4.761767864227
average_count is: 562 step count: 143361 time: 7650.759 perplexity for hold out set: 4.761757373810
average_count is: 563 step count: 143617 time: 7664.496 perplexity for hold out set: 4.761746406555
average_count is: 564 step count: 143873 time: 7678.077 perplexity for hold out set: 4.761735439301
average_count is: 565 step count: 144129 time: 7690.890 perplexity for hold out set: 4.761724948883
average_count is: 566 step count: 144385 time: 7704.705 perplexity for hold out set: 4.761714458466
average_count is: 567 step count: 144641 time: 7718.544 perplexity for hold out set: 4.761703968048
average_count is: 568 step count: 144897 time: 7732.290 perplexity for hold out set: 4.761693000793
average_count is: 569 step count: 145153 time: 7746.011 perplexity for hold out set: 4.761682987213
average_count is: 570 step count: 145409 time: 7759.823 perplexity for hold out set: 4.761672496796
average_count is: 571 step count: 145665 time: 7773.463 perplexity for hold out set: 4.761662006378
average_count is: 572 step count: 145921 time: 7787.372 perplexity for hold out set: 4.761651515961
average_count is: 573 step count: 146177 time: 7801.128 perplexity for hold out set: 4.761641502380
average_count is: 574 step count: 146433 time: 7815.139 perplexity for hold out set: 4.761630535126
average_count is: 575 step count: 146689 time: 7828.943 perplexity for hold out set: 4.761620521545
average_count is: 576 step count: 146945 time: 7842.772 perplexity for hold out set: 4.761610031128
average_count is: 577 step count: 147201 time: 7856.579 perplexity for hold out set: 4.761600017548
average_count is: 578 step count: 147457 time: 7870.145 perplexity for hold out set: 4.761590003967
average_count is: 579 step count: 147713 time: 7883.839 perplexity for hold out set: 4.761579513550
average_count is: 580 step count: 147969 time: 7897.506 perplexity for hold out set: 4.761569499969
average_count is: 581 step count: 148225 time: 7911.222 perplexity for hold out set: 4.761559486389
average_count is: 582 step count: 148481 time: 7924.645 perplexity for hold out set: 4.761549949646
average_count is: 583 step count: 148737 time: 7938.371 perplexity for hold out set: 4.761539459229
average_count is: 584 step count: 148993 time: 7952.318 perplexity for hold out set: 4.761529445648
average_count is: 585 step count: 149249 time: 7966.302 perplexity for hold out set: 4.761519908905
average_count is: 586 step count: 149505 time: 7979.936 perplexity for hold out set: 4.761509895325
average_count is: 587 step count: 149761 time: 7993.625 perplexity for hold out set: 4.761499881744
average_count is: 588 step count: 150017 time: 8007.374 perplexity for hold out set: 4.761490345001
average_count is: 589 step count: 150273 time: 8021.325 perplexity for hold out set: 4.761480808258
average_count is: 590 step count: 150529 time: 8034.903 perplexity for hold out set: 4.761470794678
average_count is: 591 step count: 150785 time: 8047.819 perplexity for hold out set: 4.761461257935
average_count is: 592 step count: 151041 time: 8061.311 perplexity for hold out set: 4.761451721191
average_count is: 593 step count: 151297 time: 8074.781 perplexity for hold out set: 4.761441707611
average_count is: 594 step count: 151553 time: 8088.529 perplexity for hold out set: 4.761432647705
average_count is: 595 step count: 151809 time: 8101.689 perplexity for hold out set: 4.761423110962
average_count is: 596 step count: 152065 time: 8114.848 perplexity for hold out set: 4.761413574219
average_count is: 597 step count: 152321 time: 8128.443 perplexity for hold out set: 4.761403560638
average_count is: 598 step count: 152577 time: 8142.348 perplexity for hold out set: 4.761394500732
average_count is: 599 step count: 152833 time: 8155.909 perplexity for hold out set: 4.761384963989
average_count is: 600 step count: 153089 time: 8169.800 perplexity for hold out set: 4.761375427246
average_count is: 601 step count: 153345 time: 8183.044 perplexity for hold out set: 4.761365890503
average_count is: 602 step count: 153601 time: 8196.509 perplexity for hold out set: 4.761356353760
average_count is: 603 step count: 153857 time: 8210.082 perplexity for hold out set: 4.761347293854
average_count is: 604 step count: 154113 time: 8223.520 perplexity for hold out set: 4.761337757111
average_count is: 605 step count: 154369 time: 8236.996 perplexity for hold out set: 4.761328697205
average_count is: 606 step count: 154625 time: 8250.930 perplexity for hold out set: 4.761319160461
average_count is: 607 step count: 154881 time: 8264.256 perplexity for hold out set: 4.761310577393
average_count is: 608 step count: 155137 time: 8277.905 perplexity for hold out set: 4.761301040649
average_count is: 609 step count: 155393 time: 8291.254 perplexity for hold out set: 4.761291980743
average_count is: 610 step count: 155649 time: 8305.206 perplexity for hold out set: 4.761282920837
average_count is: 611 step count: 155905 time: 8318.594 perplexity for hold out set: 4.761273384094
average_count is: 612 step count: 156161 time: 8331.998 perplexity for hold out set: 4.761265277863
average_count is: 613 step count: 156417 time: 8345.860 perplexity for hold out set: 4.761255741119
average_count is: 614 step count: 156673 time: 8359.176 perplexity for hold out set: 4.761246681213
average_count is: 615 step count: 156929 time: 8373.107 perplexity for hold out set: 4.761237621307
average_count is: 616 step count: 157185 time: 8386.770 perplexity for hold out set: 4.761229038239
average_count is: 617 step count: 157441 time: 8400.441 perplexity for hold out set: 4.761219978333
average_count is: 618 step count: 157697 time: 8414.020 perplexity for hold out set: 4.761210918427
average_count is: 619 step count: 157953 time: 8427.608 perplexity for hold out set: 4.761201858521
average_count is: 620 step count: 158209 time: 8441.407 perplexity for hold out set: 4.761193275452
average_count is: 621 step count: 158465 time: 8455.144 perplexity for hold out set: 4.761184215546
average_count is: 622 step count: 158721 time: 8468.630 perplexity for hold out set: 4.761175632477
average_count is: 623 step count: 158977 time: 8482.319 perplexity for hold out set: 4.761166572571
average_count is: 624 step count: 159233 time: 8495.769 perplexity for hold out set: 4.761157512665
average_count is: 625 step count: 159489 time: 8509.090 perplexity for hold out set: 4.761149406433
average_count is: 626 step count: 159745 time: 8522.931 perplexity for hold out set: 4.761140346527
average_count is: 627 step count: 160001 time: 8536.775 perplexity for hold out set: 4.761131763458
average_count is: 628 step count: 160257 time: 8550.241 perplexity for hold out set: 4.761123657227
average_count is: 629 step count: 160513 time: 8563.718 perplexity for hold out set: 4.761115074158
average_count is: 630 step count: 160769 time: 8577.468 perplexity for hold out set: 4.761106491089
average_count is: 631 step count: 161025 time: 8591.234 perplexity for hold out set: 4.761098384857
average_count is: 632 step count: 161281 time: 8604.678 perplexity for hold out set: 4.761089801788
average_count is: 633 step count: 161537 time: 8618.640 perplexity for hold out set: 4.761081218719
average_count is: 634 step count: 161793 time: 8632.335 perplexity for hold out set: 4.761072635651
average_count is: 635 step count: 162049 time: 8645.842 perplexity for hold out set: 4.761064052582
average_count is: 636 step count: 162305 time: 8659.563 perplexity for hold out set: 4.761055946350
average_count is: 637 step count: 162561 time: 8673.023 perplexity for hold out set: 4.761047840118
average_count is: 638 step count: 162817 time: 8686.975 perplexity for hold out set: 4.761038780212
average_count is: 639 step count: 163073 time: 8700.750 perplexity for hold out set: 4.761030673981
average_count is: 640 step count: 163329 time: 8713.954 perplexity for hold out set: 4.761022090912
average_count is: 641 step count: 163585 time: 8727.738 perplexity for hold out set: 4.761014461517
average_count is: 642 step count: 163841 time: 8740.539 perplexity for hold out set: 4.761005878448
average_count is: 643 step count: 164097 time: 8754.018 perplexity for hold out set: 4.760997772217
average_count is: 644 step count: 164353 time: 8767.409 perplexity for hold out set: 4.760989189148
average_count is: 645 step count: 164609 time: 8781.026 perplexity for hold out set: 4.760981559753
average_count is: 646 step count: 164865 time: 8794.430 perplexity for hold out set: 4.760973930359
average_count is: 647 step count: 165121 time: 8808.054 perplexity for hold out set: 4.760965824127
average_count is: 648 step count: 165377 time: 8821.749 perplexity for hold out set: 4.760957717896
average_count is: 649 step count: 165633 time: 8835.381 perplexity for hold out set: 4.760949611664
average_count is: 650 step count: 165889 time: 8849.379 perplexity for hold out set: 4.760941505432
average_count is: 651 step count: 166145 time: 8863.142 perplexity for hold out set: 4.760933399200
average_count is: 652 step count: 166401 time: 8875.846 perplexity for hold out set: 4.760925292969
average_count is: 653 step count: 166657 time: 8889.698 perplexity for hold out set: 4.760917186737
average_count is: 654 step count: 166913 time: 8902.901 perplexity for hold out set: 4.760909557343
average_count is: 655 step count: 167169 time: 8916.541 perplexity for hold out set: 4.760901451111
average_count is: 656 step count: 167425 time: 8930.186 perplexity for hold out set: 4.760893344879
average_count is: 657 step count: 167681 time: 8943.275 perplexity for hold out set: 4.760885715485
average_count is: 658 step count: 167937 time: 8956.869 perplexity for hold out set: 4.760878086090
average_count is: 659 step count: 168193 time: 8970.416 perplexity for hold out set: 4.760869979858
average_count is: 660 step count: 168449 time: 8983.685 perplexity for hold out set: 4.760862350464
average_count is: 661 step count: 168705 time: 8997.585 perplexity for hold out set: 4.760854721069
average_count is: 662 step count: 168961 time: 9011.559 perplexity for hold out set: 4.760846614838
average_count is: 663 step count: 169217 time: 9025.173 perplexity for hold out set: 4.760838985443
average_count is: 664 step count: 169473 time: 9039.101 perplexity for hold out set: 4.760831356049
average_count is: 665 step count: 169729 time: 9052.422 perplexity for hold out set: 4.760823726654
average_count is: 666 step count: 169985 time: 9065.614 perplexity for hold out set: 4.760815620422
average_count is: 667 step count: 170241 time: 9079.244 perplexity for hold out set: 4.760808467865
average_count is: 668 step count: 170497 time: 9093.207 perplexity for hold out set: 4.760800361633
average_count is: 669 step count: 170753 time: 9106.897 perplexity for hold out set: 4.760792732239
average_count is: 670 step count: 171009 time: 9120.256 perplexity for hold out set: 4.760785579681
average_count is: 671 step count: 171265 time: 9133.750 perplexity for hold out set: 4.760778427124
average_count is: 672 step count: 171521 time: 9147.613 perplexity for hold out set: 4.760770320892
average_count is: 673 step count: 171777 time: 9161.367 perplexity for hold out set: 4.760763168335
average_count is: 674 step count: 172033 time: 9175.069 perplexity for hold out set: 4.760755538940
average_count is: 675 step count: 172289 time: 9188.556 perplexity for hold out set: 4.760748386383
average_count is: 676 step count: 172545 time: 9202.480 perplexity for hold out set: 4.760741233826
average_count is: 677 step count: 172801 time: 9216.193 perplexity for hold out set: 4.760733127594
average_count is: 678 step count: 173057 time: 9230.162 perplexity for hold out set: 4.760725975037
average_count is: 679 step count: 173313 time: 9243.945 perplexity for hold out set: 4.760718822479
average_count is: 680 step count: 173569 time: 9257.829 perplexity for hold out set: 4.760711193085
average_count is: 681 step count: 173825 time: 9271.707 perplexity for hold out set: 4.760704040527
average_count is: 682 step count: 174081 time: 9285.573 perplexity for hold out set: 4.760696887970
average_count is: 683 step count: 174337 time: 9299.497 perplexity for hold out set: 4.760689735413
average_count is: 684 step count: 174593 time: 9312.498 perplexity for hold out set: 4.760682582855
average_count is: 685 step count: 174849 time: 9326.179 perplexity for hold out set: 4.760674953461
average_count is: 686 step count: 175105 time: 9340.116 perplexity for hold out set: 4.760667800903
average_count is: 687 step count: 175361 time: 9353.848 perplexity for hold out set: 4.760661125183
average_count is: 688 step count: 175617 time: 9367.661 perplexity for hold out set: 4.760653495789
average_count is: 689 step count: 175873 time: 9381.489 perplexity for hold out set: 4.760646343231
average_count is: 690 step count: 176129 time: 9395.169 perplexity for hold out set: 4.760639190674
average_count is: 691 step count: 176385 time: 9409.021 perplexity for hold out set: 4.760632514954
average_count is: 692 step count: 176641 time: 9422.762 perplexity for hold out set: 4.760625362396
average_count is: 693 step count: 176897 time: 9436.490 perplexity for hold out set: 4.760618209839
average_count is: 694 step count: 177153 time: 9450.421 perplexity for hold out set: 4.760611057281
average_count is: 695 step count: 177409 time: 9464.037 perplexity for hold out set: 4.760603904724
average_count is: 696 step count: 177665 time: 9477.974 perplexity for hold out set: 4.760597705841
average_count is: 697 step count: 177921 time: 9492.013 perplexity for hold out set: 4.760590553284
average_count is: 698 step count: 178177 time: 9505.652 perplexity for hold out set: 4.760582923889
average_count is: 699 step count: 178433 time: 9518.736 perplexity for hold out set: 4.760576248169
average_count is: 700 step count: 178689 time: 9532.695 perplexity for hold out set: 4.760569572449
average_count is: 701 step count: 178945 time: 9545.752 perplexity for hold out set: 4.760561943054
average_count is: 702 step count: 179201 time: 9558.933 perplexity for hold out set: 4.760555744171
average_count is: 703 step count: 179457 time: 9572.334 perplexity for hold out set: 4.760549068451
average_count is: 704 step count: 179713 time: 9585.145 perplexity for hold out set: 4.760541915894
average_count is: 705 step count: 179969 time: 9599.024 perplexity for hold out set: 4.760535240173
average_count is: 706 step count: 180225 time: 9612.372 perplexity for hold out set: 4.760528564453
average_count is: 707 step count: 180481 time: 9625.993 perplexity for hold out set: 4.760521411896
average_count is: 708 step count: 180737 time: 9639.844 perplexity for hold out set: 4.760514736176
average_count is: 709 step count: 180993 time: 9653.213 perplexity for hold out set: 4.760508060455
average_count is: 710 step count: 181249 time: 9666.871 perplexity for hold out set: 4.760501384735
average_count is: 711 step count: 181505 time: 9680.519 perplexity for hold out set: 4.760495185852
average_count is: 712 step count: 181761 time: 9694.050 perplexity for hold out set: 4.760488033295
average_count is: 713 step count: 182017 time: 9707.224 perplexity for hold out set: 4.760481834412
average_count is: 714 step count: 182273 time: 9721.048 perplexity for hold out set: 4.760474681854
average_count is: 715 step count: 182529 time: 9734.812 perplexity for hold out set: 4.760468482971
average_count is: 716 step count: 182785 time: 9748.410 perplexity for hold out set: 4.760461330414
average_count is: 717 step count: 183041 time: 9762.208 perplexity for hold out set: 4.760455131531
average_count is: 718 step count: 183297 time: 9775.895 perplexity for hold out set: 4.760448932648
average_count is: 719 step count: 183553 time: 9789.494 perplexity for hold out set: 4.760441780090
average_count is: 720 step count: 183809 time: 9803.081 perplexity for hold out set: 4.760435104370
average_count is: 721 step count: 184065 time: 9816.995 perplexity for hold out set: 4.760428905487
average_count is: 722 step count: 184321 time: 9830.807 perplexity for hold out set: 4.760422229767
average_count is: 723 step count: 184577 time: 9844.248 perplexity for hold out set: 4.760416030884
average_count is: 724 step count: 184833 time: 9857.590 perplexity for hold out set: 4.760409355164
average_count is: 725 step count: 185089 time: 9870.598 perplexity for hold out set: 4.760403156281
average_count is: 726 step count: 185345 time: 9884.116 perplexity for hold out set: 4.760396480560
average_count is: 727 step count: 185601 time: 9897.787 perplexity for hold out set: 4.760390281677
average_count is: 728 step count: 185857 time: 9911.077 perplexity for hold out set: 4.760383605957
average_count is: 729 step count: 186113 time: 9924.921 perplexity for hold out set: 4.760376930237
average_count is: 730 step count: 186369 time: 9938.715 perplexity for hold out set: 4.760371208191
average_count is: 731 step count: 186625 time: 9952.417 perplexity for hold out set: 4.760364532471
average_count is: 732 step count: 186881 time: 9966.297 perplexity for hold out set: 4.760358333588
average_count is: 733 step count: 187137 time: 9980.303 perplexity for hold out set: 4.760352134705
average_count is: 734 step count: 187393 time: 9994.241 perplexity for hold out set: 4.760345458984
average_count is: 735 step count: 187649 time: 10007.642 perplexity for hold out set: 4.760338783264
average_count is: 736 step count: 187905 time: 10021.721 perplexity for hold out set: 4.760333061218
average_count is: 737 step count: 188161 time: 10035.280 perplexity for hold out set: 4.760326385498
average_count is: 738 step count: 188417 time: 10048.932 perplexity for hold out set: 4.760320186615
average_count is: 739 step count: 188673 time: 10062.496 perplexity for hold out set: 4.760314464569
average_count is: 740 step count: 188929 time: 10076.261 perplexity for hold out set: 4.760307788849
average_count is: 741 step count: 189185 time: 10089.851 perplexity for hold out set: 4.760301589966
average_count is: 742 step count: 189441 time: 10103.024 perplexity for hold out set: 4.760295867920
average_count is: 743 step count: 189697 time: 10116.111 perplexity for hold out set: 4.760289669037
average_count is: 744 step count: 189953 time: 10129.746 perplexity for hold out set: 4.760283470154
average_count is: 745 step count: 190209 time: 10143.632 perplexity for hold out set: 4.760277748108
average_count is: 746 step count: 190465 time: 10157.328 perplexity for hold out set: 4.760271072388
average_count is: 747 step count: 190721 time: 10170.457 perplexity for hold out set: 4.760264873505
average_count is: 748 step count: 190977 time: 10183.280 perplexity for hold out set: 4.760259151459
average_count is: 749 step count: 191233 time: 10196.931 perplexity for hold out set: 4.760253906250
average_count is: 750 step count: 191489 time: 10210.757 perplexity for hold out set: 4.760247230530
average_count is: 751 step count: 191745 time: 10223.562 perplexity for hold out set: 4.760241031647
average_count is: 752 step count: 192001 time: 10236.965 perplexity for hold out set: 4.760235309601
average_count is: 753 step count: 192257 time: 10250.270 perplexity for hold out set: 4.760229110718
average_count is: 754 step count: 192513 time: 10264.033 perplexity for hold out set: 4.760222911835
average_count is: 755 step count: 192769 time: 10277.805 perplexity for hold out set: 4.760217666626
average_count is: 756 step count: 193025 time: 10291.565 perplexity for hold out set: 4.760211467743
average_count is: 757 step count: 193281 time: 10305.216 perplexity for hold out set: 4.760205745697
average_count is: 758 step count: 193537 time: 10319.025 perplexity for hold out set: 4.760199546814
average_count is: 759 step count: 193793 time: 10332.695 perplexity for hold out set: 4.760193824768
average_count is: 760 step count: 194049 time: 10346.409 perplexity for hold out set: 4.760188102722
average_count is: 761 step count: 194305 time: 10359.820 perplexity for hold out set: 4.760182380676
average_count is: 762 step count: 194561 time: 10373.713 perplexity for hold out set: 4.760175704956
average_count is: 763 step count: 194817 time: 10387.546 perplexity for hold out set: 4.760169982910
average_count is: 764 step count: 195073 time: 10401.024 perplexity for hold out set: 4.760164260864
average_count is: 765 step count: 195329 time: 10414.866 perplexity for hold out set: 4.760158538818
average_count is: 766 step count: 195585 time: 10428.632 perplexity for hold out set: 4.760153293610
average_count is: 767 step count: 195841 time: 10442.451 perplexity for hold out set: 4.760147094727
average_count is: 768 step count: 196097 time: 10456.372 perplexity for hold out set: 4.760141372681
average_count is: 769 step count: 196353 time: 10470.037 perplexity for hold out set: 4.760135650635
timer                                    total (s)    ticks  per tick (us)
  load network graph                        3.000        1    3000469.734
  initialize DKV store                      0.776        1     776055.486
  populate pi                               0.001        1       1417.394
  iteration                             10482.865   196607      53318.880
    deploy minibatch                      404.943   196608       2059.647
      scatter subgraph                     44.979   196608        228.776
        marshall edge count                15.986   196608         81.314
        scatterv edges                      2.611   196608         13.285
        marshall edges                     19.310   196608         98.217
        scatterv edges                      6.528   196608         33.208
        unmarshall edges                    0.014   196608          0.074
      sample_mini_batch                   151.986   196608        773.043
      nodes_in_mini_batch                  69.072   196608        351.321
    broadcast theta/beta                  516.833   196607       2628.764
    update_phi_pi                        6738.904   196607      34276.017
      create minibatch slice chunks         0.072   196608          0.371
      reorder minibatch overlap     <unused>
      sample_neighbor_nodes                18.876   196608         96.010
      resample_neighbor_nodes       <unused>
      load minibatch pi                     0.572   393215          1.457
      load neighbor pi                      0.249   393215          0.635
      update_phi                           37.593   393214         95.607
      barrier after update phi           5534.620   196607      28150.676
      update_pi                     <unused>
      store minibatch pi            <unused>
      barrier after update pi             740.026   196607       3763.987
    update_beta_theta                    3057.243   196607      15550.022
      zero beta grads                      56.546   196607        287.610
      rank minibatch nodes                  4.080   196607         20.752
      load pi update_beta                 195.968   196607        996.754
      beta calc grads                     315.176   196607       1603.078
      beta sum grads                       87.461   196607        444.855
      beta reduce(+) grads               1852.498   196607       9422.345
      update theta                        395.594   196607       2012.106
  perplexity                              160.983      768     209614.426
      load perplexity pi                  127.012      768     165381.001
      calc edge likelihood                 31.922      768      41566.396
      purge perplexity pi                   0.002      768          3.705
      reduce/plus perplexity                2.015      768       2624.182
average_count is: 770 step count: 196609 time: 10483.210 perplexity for hold out set: 4.760129928589
average_count is: 771 step count: 196865 time: 10496.793 perplexity for hold out set: 4.760124683380
average_count is: 772 step count: 197121 time: 10510.395 perplexity for hold out set: 4.760119438171
average_count is: 773 step count: 197377 time: 10524.147 perplexity for hold out set: 4.760113239288
average_count is: 774 step count: 197633 time: 10537.665 perplexity for hold out set: 4.760107517242
average_count is: 775 step count: 197889 time: 10551.522 perplexity for hold out set: 4.760101795197
average_count is: 776 step count: 198145 time: 10565.459 perplexity for hold out set: 4.760096549988
average_count is: 777 step count: 198401 time: 10578.735 perplexity for hold out set: 4.760090827942
average_count is: 778 step count: 198657 time: 10592.734 perplexity for hold out set: 4.760085105896
average_count is: 779 step count: 198913 time: 10606.701 perplexity for hold out set: 4.760079860687
average_count is: 780 step count: 199169 time: 10620.338 perplexity for hold out set: 4.760074138641
average_count is: 781 step count: 199425 time: 10634.311 perplexity for hold out set: 4.760068416595
average_count is: 782 step count: 199681 time: 10647.971 perplexity for hold out set: 4.760063171387
average_count is: 783 step count: 199937 time: 10661.739 perplexity for hold out set: 4.760057449341
average_count is: 784 step count: 200193 time: 10675.376 perplexity for hold out set: 4.760052204132
average_count is: 785 step count: 200449 time: 10689.210 perplexity for hold out set: 4.760046958923
average_count is: 786 step count: 200705 time: 10703.005 perplexity for hold out set: 4.760041236877
average_count is: 787 step count: 200961 time: 10716.973 perplexity for hold out set: 4.760035514832
average_count is: 788 step count: 201217 time: 10730.367 perplexity for hold out set: 4.760030269623
average_count is: 789 step count: 201473 time: 10744.127 perplexity for hold out set: 4.760025024414
average_count is: 790 step count: 201729 time: 10758.049 perplexity for hold out set: 4.760019779205
average_count is: 791 step count: 201985 time: 10771.454 perplexity for hold out set: 4.760014057159
average_count is: 792 step count: 202241 time: 10784.997 perplexity for hold out set: 4.760008335114
average_count is: 793 step count: 202497 time: 10798.647 perplexity for hold out set: 4.760003566742
average_count is: 794 step count: 202753 time: 10812.344 perplexity for hold out set: 4.759997844696
average_count is: 795 step count: 203009 time: 10826.416 perplexity for hold out set: 4.759992599487
average_count is: 796 step count: 203265 time: 10840.024 perplexity for hold out set: 4.759987354279
average_count is: 797 step count: 203521 time: 10853.733 perplexity for hold out set: 4.759982109070
average_count is: 798 step count: 203777 time: 10867.142 perplexity for hold out set: 4.759976863861
average_count is: 799 step count: 204033 time: 10880.413 perplexity for hold out set: 4.759971618652
average_count is: 800 step count: 204289 time: 10893.949 perplexity for hold out set: 4.759965896606
average_count is: 801 step count: 204545 time: 10906.878 perplexity for hold out set: 4.759960651398
average_count is: 802 step count: 204801 time: 10920.603 perplexity for hold out set: 4.759955406189
average_count is: 803 step count: 205057 time: 10934.276 perplexity for hold out set: 4.759950160980
average_count is: 804 step count: 205313 time: 10948.119 perplexity for hold out set: 4.759944915771
average_count is: 805 step count: 205569 time: 10961.928 perplexity for hold out set: 4.759939670563
average_count is: 806 step count: 205825 time: 10975.802 perplexity for hold out set: 4.759934425354
average_count is: 807 step count: 206081 time: 10989.003 perplexity for hold out set: 4.759929180145
average_count is: 808 step count: 206337 time: 11002.125 perplexity for hold out set: 4.759924411774
average_count is: 809 step count: 206593 time: 11015.878 perplexity for hold out set: 4.759918689728
average_count is: 810 step count: 206849 time: 11029.703 perplexity for hold out set: 4.759913921356
average_count is: 811 step count: 207105 time: 11043.174 perplexity for hold out set: 4.759908676147
average_count is: 812 step count: 207361 time: 11056.909 perplexity for hold out set: 4.759903430939
average_count is: 813 step count: 207617 time: 11070.707 perplexity for hold out set: 4.759898662567
average_count is: 814 step count: 207873 time: 11084.668 perplexity for hold out set: 4.759893417358
average_count is: 815 step count: 208129 time: 11097.932 perplexity for hold out set: 4.759888648987
average_count is: 816 step count: 208385 time: 11111.329 perplexity for hold out set: 4.759882926941
average_count is: 817 step count: 208641 time: 11124.868 perplexity for hold out set: 4.759877681732
average_count is: 818 step count: 208897 time: 11138.752 perplexity for hold out set: 4.759872913361
average_count is: 819 step count: 209153 time: 11152.303 perplexity for hold out set: 4.759868144989
average_count is: 820 step count: 209409 time: 11165.793 perplexity for hold out set: 4.759862899780
average_count is: 821 step count: 209665 time: 11179.673 perplexity for hold out set: 4.759857654572
average_count is: 822 step count: 209921 time: 11193.735 perplexity for hold out set: 4.759852409363
average_count is: 823 step count: 210177 time: 11207.516 perplexity for hold out set: 4.759847640991
average_count is: 824 step count: 210433 time: 11221.147 perplexity for hold out set: 4.759842872620
average_count is: 825 step count: 210689 time: 11234.757 perplexity for hold out set: 4.759838104248
average_count is: 826 step count: 210945 time: 11248.485 perplexity for hold out set: 4.759833335876
average_count is: 827 step count: 211201 time: 11262.336 perplexity for hold out set: 4.759827613831
average_count is: 828 step count: 211457 time: 11275.602 perplexity for hold out set: 4.759823799133
average_count is: 829 step count: 211713 time: 11289.342 perplexity for hold out set: 4.759818077087
average_count is: 830 step count: 211969 time: 11303.000 perplexity for hold out set: 4.759813308716
average_count is: 831 step count: 212225 time: 11316.383 perplexity for hold out set: 4.759808063507
average_count is: 832 step count: 212481 time: 11329.553 perplexity for hold out set: 4.759803295135
average_count is: 833 step count: 212737 time: 11343.273 perplexity for hold out set: 4.759798526764
average_count is: 834 step count: 212993 time: 11356.878 perplexity for hold out set: 4.759793758392
average_count is: 835 step count: 213249 time: 11370.623 perplexity for hold out set: 4.759788990021
average_count is: 836 step count: 213505 time: 11384.436 perplexity for hold out set: 4.759784221649
average_count is: 837 step count: 213761 time: 11398.227 perplexity for hold out set: 4.759779453278
average_count is: 838 step count: 214017 time: 11411.523 perplexity for hold out set: 4.759774208069
average_count is: 839 step count: 214273 time: 11425.121 perplexity for hold out set: 4.759769916534
average_count is: 840 step count: 214529 time: 11438.767 perplexity for hold out set: 4.759765148163
average_count is: 841 step count: 214785 time: 11452.655 perplexity for hold out set: 4.759759902954
average_count is: 842 step count: 215041 time: 11466.553 perplexity for hold out set: 4.759755134583
average_count is: 843 step count: 215297 time: 11480.173 perplexity for hold out set: 4.759750366211
average_count is: 844 step count: 215553 time: 11494.154 perplexity for hold out set: 4.759746074677
average_count is: 845 step count: 215809 time: 11508.129 perplexity for hold out set: 4.759741306305
average_count is: 846 step count: 216065 time: 11521.781 perplexity for hold out set: 4.759736537933
average_count is: 847 step count: 216321 time: 11535.072 perplexity for hold out set: 4.759731769562
average_count is: 848 step count: 216577 time: 11548.928 perplexity for hold out set: 4.759727478027
average_count is: 849 step count: 216833 time: 11562.811 perplexity for hold out set: 4.759722232819
average_count is: 850 step count: 217089 time: 11576.629 perplexity for hold out set: 4.759717464447
average_count is: 851 step count: 217345 time: 11590.347 perplexity for hold out set: 4.759712696075
average_count is: 852 step count: 217601 time: 11604.021 perplexity for hold out set: 4.759707927704
average_count is: 853 step count: 217857 time: 11617.370 perplexity for hold out set: 4.759703159332
average_count is: 854 step count: 218113 time: 11631.223 perplexity for hold out set: 4.759699344635
average_count is: 855 step count: 218369 time: 11645.219 perplexity for hold out set: 4.759694576263
average_count is: 856 step count: 218625 time: 11658.912 perplexity for hold out set: 4.759689807892
average_count is: 857 step count: 218881 time: 11672.668 perplexity for hold out set: 4.759685039520
average_count is: 858 step count: 219137 time: 11686.710 perplexity for hold out set: 4.759680747986
average_count is: 859 step count: 219393 time: 11700.632 perplexity for hold out set: 4.759675979614
average_count is: 860 step count: 219649 time: 11714.355 perplexity for hold out set: 4.759671211243
average_count is: 861 step count: 219905 time: 11728.373 perplexity for hold out set: 4.759666919708
average_count is: 862 step count: 220161 time: 11741.888 perplexity for hold out set: 4.759662151337
average_count is: 863 step count: 220417 time: 11755.614 perplexity for hold out set: 4.759657382965
average_count is: 864 step count: 220673 time: 11769.217 perplexity for hold out set: 4.759653568268
average_count is: 865 step count: 220929 time: 11782.680 perplexity for hold out set: 4.759648799896
average_count is: 866 step count: 221185 time: 11796.559 perplexity for hold out set: 4.759644508362
average_count is: 867 step count: 221441 time: 11810.558 perplexity for hold out set: 4.759639739990
average_count is: 868 step count: 221697 time: 11823.628 perplexity for hold out set: 4.759635448456
average_count is: 869 step count: 221953 time: 11836.771 perplexity for hold out set: 4.759630680084
average_count is: 870 step count: 222209 time: 11850.736 perplexity for hold out set: 4.759625911713
average_count is: 871 step count: 222465 time: 11864.460 perplexity for hold out set: 4.759621620178
average_count is: 872 step count: 222721 time: 11878.189 perplexity for hold out set: 4.759617805481
average_count is: 873 step count: 222977 time: 11891.896 perplexity for hold out set: 4.759612083435
average_count is: 874 step count: 223233 time: 11905.405 perplexity for hold out set: 4.759608745575
average_count is: 875 step count: 223489 time: 11919.161 perplexity for hold out set: 4.759603977203
average_count is: 876 step count: 223745 time: 11932.460 perplexity for hold out set: 4.759599208832
average_count is: 877 step count: 224001 time: 11946.251 perplexity for hold out set: 4.759595394135
average_count is: 878 step count: 224257 time: 11959.750 perplexity for hold out set: 4.759590625763
average_count is: 879 step count: 224513 time: 11973.260 perplexity for hold out set: 4.759586811066
average_count is: 880 step count: 224769 time: 11986.699 perplexity for hold out set: 4.759582042694
average_count is: 881 step count: 225025 time: 12000.499 perplexity for hold out set: 4.759577751160
average_count is: 882 step count: 225281 time: 12014.271 perplexity for hold out set: 4.759573459625
average_count is: 883 step count: 225537 time: 12027.913 perplexity for hold out set: 4.759568691254
average_count is: 884 step count: 225793 time: 12041.692 perplexity for hold out set: 4.759564876556
average_count is: 885 step count: 226049 time: 12055.601 perplexity for hold out set: 4.759560585022
average_count is: 886 step count: 226305 time: 12069.540 perplexity for hold out set: 4.759556293488
average_count is: 887 step count: 226561 time: 12082.760 perplexity for hold out set: 4.759552001953
average_count is: 888 step count: 226817 time: 12096.803 perplexity for hold out set: 4.759547233582
average_count is: 889 step count: 227073 time: 12110.822 perplexity for hold out set: 4.759543418884
average_count is: 890 step count: 227329 time: 12124.761 perplexity for hold out set: 4.759539127350
average_count is: 891 step count: 227585 time: 12138.712 perplexity for hold out set: 4.759534835815
average_count is: 892 step count: 227841 time: 12152.368 perplexity for hold out set: 4.759530544281
average_count is: 893 step count: 228097 time: 12165.720 perplexity for hold out set: 4.759526729584
average_count is: 894 step count: 228353 time: 12179.287 perplexity for hold out set: 4.759522438049
average_count is: 895 step count: 228609 time: 12192.787 perplexity for hold out set: 4.759518146515
average_count is: 896 step count: 228865 time: 12206.649 perplexity for hold out set: 4.759513854980
average_count is: 897 step count: 229121 time: 12220.504 perplexity for hold out set: 4.759510040283
average_count is: 898 step count: 229377 time: 12234.399 perplexity for hold out set: 4.759505271912
average_count is: 899 step count: 229633 time: 12247.875 perplexity for hold out set: 4.759501457214
average_count is: 900 step count: 229889 time: 12261.433 perplexity for hold out set: 4.759497165680
average_count is: 901 step count: 230145 time: 12274.970 perplexity for hold out set: 4.759492397308
average_count is: 902 step count: 230401 time: 12288.821 perplexity for hold out set: 4.759489059448
average_count is: 903 step count: 230657 time: 12302.533 perplexity for hold out set: 4.759485244751
average_count is: 904 step count: 230913 time: 12315.820 perplexity for hold out set: 4.759480953217
average_count is: 905 step count: 231169 time: 12329.229 perplexity for hold out set: 4.759476184845
average_count is: 906 step count: 231425 time: 12343.100 perplexity for hold out set: 4.759472846985
average_count is: 907 step count: 231681 time: 12356.912 perplexity for hold out set: 4.759468555450
average_count is: 908 step count: 231937 time: 12370.306 perplexity for hold out set: 4.759464740753
average_count is: 909 step count: 232193 time: 12384.235 perplexity for hold out set: 4.759460449219
average_count is: 910 step count: 232449 time: 12397.870 perplexity for hold out set: 4.759456157684
average_count is: 911 step count: 232705 time: 12411.551 perplexity for hold out set: 4.759452342987
average_count is: 912 step count: 232961 time: 12425.223 perplexity for hold out set: 4.759448051453
average_count is: 913 step count: 233217 time: 12438.771 perplexity for hold out set: 4.759444236755
average_count is: 914 step count: 233473 time: 12452.715 perplexity for hold out set: 4.759440422058
average_count is: 915 step count: 233729 time: 12466.576 perplexity for hold out set: 4.759436130524
average_count is: 916 step count: 233985 time: 12480.407 perplexity for hold out set: 4.759432315826
average_count is: 917 step count: 234241 time: 12493.859 perplexity for hold out set: 4.759428024292
average_count is: 918 step count: 234497 time: 12507.500 perplexity for hold out set: 4.759424209595
average_count is: 919 step count: 234753 time: 12521.318 perplexity for hold out set: 4.759420394897
average_count is: 920 step count: 235009 time: 12534.807 perplexity for hold out set: 4.759416580200
average_count is: 921 step count: 235265 time: 12547.943 perplexity for hold out set: 4.759412288666
average_count is: 922 step count: 235521 time: 12561.400 perplexity for hold out set: 4.759408473969
average_count is: 923 step count: 235777 time: 12575.281 perplexity for hold out set: 4.759404659271
average_count is: 924 step count: 236033 time: 12588.449 perplexity for hold out set: 4.759400367737
average_count is: 925 step count: 236289 time: 12602.118 perplexity for hold out set: 4.759396553040
average_count is: 926 step count: 236545 time: 12615.747 perplexity for hold out set: 4.759392738342
average_count is: 927 step count: 236801 time: 12629.246 perplexity for hold out set: 4.759388923645
average_count is: 928 step count: 237057 time: 12642.821 perplexity for hold out set: 4.759385108948
average_count is: 929 step count: 237313 time: 12656.742 perplexity for hold out set: 4.759380817413
average_count is: 930 step count: 237569 time: 12670.396 perplexity for hold out set: 4.759377002716
average_count is: 931 step count: 237825 time: 12684.252 perplexity for hold out set: 4.759373188019
average_count is: 932 step count: 238081 time: 12698.021 perplexity for hold out set: 4.759369373322
average_count is: 933 step count: 238337 time: 12711.278 perplexity for hold out set: 4.759365558624
average_count is: 934 step count: 238593 time: 12725.227 perplexity for hold out set: 4.759361267090
average_count is: 935 step count: 238849 time: 12739.140 perplexity for hold out set: 4.759356975555
average_count is: 936 step count: 239105 time: 12752.726 perplexity for hold out set: 4.759353637695
average_count is: 937 step count: 239361 time: 12766.339 perplexity for hold out set: 4.759349822998
average_count is: 938 step count: 239617 time: 12779.992 perplexity for hold out set: 4.759346008301
average_count is: 939 step count: 239873 time: 12793.849 perplexity for hold out set: 4.759342193604
average_count is: 940 step count: 240129 time: 12807.822 perplexity for hold out set: 4.759338378906
average_count is: 941 step count: 240385 time: 12821.353 perplexity for hold out set: 4.759334087372
average_count is: 942 step count: 240641 time: 12835.009 perplexity for hold out set: 4.759330749512
average_count is: 943 step count: 240897 time: 12848.526 perplexity for hold out set: 4.759326934814
average_count is: 944 step count: 241153 time: 12862.138 perplexity for hold out set: 4.759323120117
average_count is: 945 step count: 241409 time: 12875.908 perplexity for hold out set: 4.759319305420
average_count is: 946 step count: 241665 time: 12889.751 perplexity for hold out set: 4.759315490723
average_count is: 947 step count: 241921 time: 12903.551 perplexity for hold out set: 4.759312152863
average_count is: 948 step count: 242177 time: 12917.082 perplexity for hold out set: 4.759307861328
average_count is: 949 step count: 242433 time: 12930.686 perplexity for hold out set: 4.759304046631
average_count is: 950 step count: 242689 time: 12944.447 perplexity for hold out set: 4.759300231934
average_count is: 951 step count: 242945 time: 12958.029 perplexity for hold out set: 4.759296894073
average_count is: 952 step count: 243201 time: 12971.490 perplexity for hold out set: 4.759293079376
average_count is: 953 step count: 243457 time: 12985.643 perplexity for hold out set: 4.759289264679
average_count is: 954 step count: 243713 time: 12999.446 perplexity for hold out set: 4.759285449982
average_count is: 955 step count: 243969 time: 13012.850 perplexity for hold out set: 4.759281635284
average_count is: 956 step count: 244225 time: 13025.918 perplexity for hold out set: 4.759277820587
average_count is: 957 step count: 244481 time: 13039.477 perplexity for hold out set: 4.759274482727
average_count is: 958 step count: 244737 time: 13053.069 perplexity for hold out set: 4.759270668030
average_count is: 959 step count: 244993 time: 13066.524 perplexity for hold out set: 4.759266853333
average_count is: 960 step count: 245249 time: 13080.416 perplexity for hold out set: 4.759263038635
average_count is: 961 step count: 245505 time: 13094.207 perplexity for hold out set: 4.759259700775
average_count is: 962 step count: 245761 time: 13108.024 perplexity for hold out set: 4.759255886078
average_count is: 963 step count: 246017 time: 13121.934 perplexity for hold out set: 4.759252548218
average_count is: 964 step count: 246273 time: 13135.167 perplexity for hold out set: 4.759248733521
average_count is: 965 step count: 246529 time: 13148.653 perplexity for hold out set: 4.759244918823
average_count is: 966 step count: 246785 time: 13161.519 perplexity for hold out set: 4.759241104126
average_count is: 967 step count: 247041 time: 13175.105 perplexity for hold out set: 4.759238243103
average_count is: 968 step count: 247297 time: 13188.663 perplexity for hold out set: 4.759234428406
average_count is: 969 step count: 247553 time: 13202.270 perplexity for hold out set: 4.759230613708
average_count is: 970 step count: 247809 time: 13215.389 perplexity for hold out set: 4.759226799011
average_count is: 971 step count: 248065 time: 13229.118 perplexity for hold out set: 4.759223461151
average_count is: 972 step count: 248321 time: 13242.784 perplexity for hold out set: 4.759220123291
average_count is: 973 step count: 248577 time: 13256.399 perplexity for hold out set: 4.759216785431
average_count is: 974 step count: 248833 time: 13270.246 perplexity for hold out set: 4.759212970734
average_count is: 975 step count: 249089 time: 13283.859 perplexity for hold out set: 4.759209632874
average_count is: 976 step count: 249345 time: 13297.526 perplexity for hold out set: 4.759205818176
average_count is: 977 step count: 249601 time: 13311.673 perplexity for hold out set: 4.759202003479
average_count is: 978 step count: 249857 time: 13325.598 perplexity for hold out set: 4.759198665619
average_count is: 979 step count: 250113 time: 13338.873 perplexity for hold out set: 4.759195327759
average_count is: 980 step count: 250369 time: 13352.695 perplexity for hold out set: 4.759191513062
average_count is: 981 step count: 250625 time: 13366.398 perplexity for hold out set: 4.759188175201
average_count is: 982 step count: 250881 time: 13380.104 perplexity for hold out set: 4.759184837341
average_count is: 983 step count: 251137 time: 13393.967 perplexity for hold out set: 4.759181499481
average_count is: 984 step count: 251393 time: 13407.580 perplexity for hold out set: 4.759177207947
average_count is: 985 step count: 251649 time: 13421.383 perplexity for hold out set: 4.759174346924
average_count is: 986 step count: 251905 time: 13435.190 perplexity for hold out set: 4.759171009064
average_count is: 987 step count: 252161 time: 13448.588 perplexity for hold out set: 4.759167194366
average_count is: 988 step count: 252417 time: 13462.126 perplexity for hold out set: 4.759163856506
average_count is: 989 step count: 252673 time: 13476.044 perplexity for hold out set: 4.759160518646
average_count is: 990 step count: 252929 time: 13489.342 perplexity for hold out set: 4.759156703949
average_count is: 991 step count: 253185 time: 13503.133 perplexity for hold out set: 4.759153366089
average_count is: 992 step count: 253441 time: 13516.948 perplexity for hold out set: 4.759149551392
average_count is: 993 step count: 253697 time: 13530.953 perplexity for hold out set: 4.759147167206
average_count is: 994 step count: 253953 time: 13544.410 perplexity for hold out set: 4.759143352509
average_count is: 995 step count: 254209 time: 13558.032 perplexity for hold out set: 4.759140014648
average_count is: 996 step count: 254465 time: 13571.950 perplexity for hold out set: 4.759136199951
average_count is: 997 step count: 254721 time: 13585.806 perplexity for hold out set: 4.759133338928
average_count is: 998 step count: 254977 time: 13599.507 perplexity for hold out set: 4.759129524231
average_count is: 999 step count: 255233 time: 13613.336 perplexity for hold out set: 4.759126186371
average_count is: 1000 step count: 255489 time: 13627.062 perplexity for hold out set: 4.759122848511
average_count is: 1001 step count: 255745 time: 13640.769 perplexity for hold out set: 4.759119510651
average_count is: 1002 step count: 256001 time: 13654.284 perplexity for hold out set: 4.759116172791
average_count is: 1003 step count: 256257 time: 13668.071 perplexity for hold out set: 4.759112358093
average_count is: 1004 step count: 256513 time: 13681.992 perplexity for hold out set: 4.759109020233
average_count is: 1005 step count: 256769 time: 13695.392 perplexity for hold out set: 4.759106159210
average_count is: 1006 step count: 257025 time: 13709.218 perplexity for hold out set: 4.759102821350
average_count is: 1007 step count: 257281 time: 13722.866 perplexity for hold out set: 4.759099483490
average_count is: 1008 step count: 257537 time: 13736.243 perplexity for hold out set: 4.759095668793
average_count is: 1009 step count: 257793 time: 13749.414 perplexity for hold out set: 4.759092807770
average_count is: 1010 step count: 258049 time: 13762.609 perplexity for hold out set: 4.759089469910
average_count is: 1011 step count: 258305 time: 13776.512 perplexity for hold out set: 4.759086132050
average_count is: 1012 step count: 258561 time: 13790.006 perplexity for hold out set: 4.759082794189
average_count is: 1013 step count: 258817 time: 13803.622 perplexity for hold out set: 4.759079456329
average_count is: 1014 step count: 259073 time: 13817.481 perplexity for hold out set: 4.759076595306
average_count is: 1015 step count: 259329 time: 13831.162 perplexity for hold out set: 4.759072780609
average_count is: 1016 step count: 259585 time: 13844.115 perplexity for hold out set: 4.759069442749
average_count is: 1017 step count: 259841 time: 13857.917 perplexity for hold out set: 4.759066581726
average_count is: 1018 step count: 260097 time: 13871.932 perplexity for hold out set: 4.759062290192
average_count is: 1019 step count: 260353 time: 13885.531 perplexity for hold out set: 4.759059429169
average_count is: 1020 step count: 260609 time: 13899.352 perplexity for hold out set: 4.759057044983
average_count is: 1021 step count: 260865 time: 13913.437 perplexity for hold out set: 4.759053230286
average_count is: 1022 step count: 261121 time: 13927.291 perplexity for hold out set: 4.759049892426
average_count is: 1023 step count: 261377 time: 13940.680 perplexity for hold out set: 4.759047031403
average_count is: 1024 step count: 261633 time: 13954.036 perplexity for hold out set: 4.759043693542
average_count is: 1025 step count: 261889 time: 13967.630 perplexity for hold out set: 4.759040355682
timer                                    total (s)    ticks  per tick (us)
  load network graph                        3.000        1    3000469.734
  initialize DKV store                      0.776        1     776055.486
  populate pi                               0.001        1       1417.394
  iteration                             13981.243   262143      53334.414
    deploy minibatch                      537.612   262144       2050.829
      scatter subgraph                     59.210   262144        225.869
        marshall edge count                21.291   262144         81.222
        scatterv edges                      3.470   262144         13.239
        marshall edges                     25.087   262144         95.700
        scatterv edges                      8.639   262144         32.958
        unmarshall edges                    0.019   262144          0.074
      sample_mini_batch                   201.086   262144        767.084
      nodes_in_mini_batch                  91.697   262144        349.796
    broadcast theta/beta                  689.053   262143       2628.540
    update_phi_pi                        8984.840   262143      34274.578
      create minibatch slice chunks         0.096   262144          0.370
      reorder minibatch overlap     <unused>
      sample_neighbor_nodes                23.965   262144         91.419
      resample_neighbor_nodes       <unused>
      load minibatch pi                     0.761   524287          1.453
      load neighbor pi                      0.333   524287          0.637
      update_phi                           48.960   524286         93.385
      barrier after update phi           7385.293   262143      28172.765
      update_pi                     <unused>
      store minibatch pi            <unused>
      barrier after update pi             985.220   262143       3758.332
    update_beta_theta                    4080.948   262143      15567.642
      zero beta grads                      74.977   262143        286.018
      rank minibatch nodes                  5.437   262143         20.741
      load pi update_beta                 261.545   262143        997.721
      beta calc grads                     419.844   262143       1601.584
      beta sum grads                      116.016   262143        442.571
      beta reduce(+) grads               2476.216   262143       9446.051
      update theta                        527.125   262143       2010.833
  perplexity                              214.511     1024     209484.254
      load perplexity pi                  169.302     1024     165334.311
      calc edge likelihood                 42.467     1024      41472.206
      purge perplexity pi                   0.003     1024          3.651
      reduce/plus perplexity                2.698     1024       2635.036
average_count is: 1026 step count: 262145 time: 13981.608 perplexity for hold out set: 4.759037017822
average_count is: 1027 step count: 262401 time: 13995.315 perplexity for hold out set: 4.759034156799
average_count is: 1028 step count: 262657 time: 14008.657 perplexity for hold out set: 4.759030818939
average_count is: 1029 step count: 262913 time: 14022.554 perplexity for hold out set: 4.759027957916
average_count is: 1030 step count: 263169 time: 14036.532 perplexity for hold out set: 4.759024620056
average_count is: 1031 step count: 263425 time: 14050.210 perplexity for hold out set: 4.759021759033
average_count is: 1032 step count: 263681 time: 14063.670 perplexity for hold out set: 4.759018421173
average_count is: 1033 step count: 263937 time: 14076.965 perplexity for hold out set: 4.759015083313
average_count is: 1034 step count: 264193 time: 14090.599 perplexity for hold out set: 4.759011745453
average_count is: 1035 step count: 264449 time: 14104.200 perplexity for hold out set: 4.759009361267
average_count is: 1036 step count: 264705 time: 14117.875 perplexity for hold out set: 4.759006023407
average_count is: 1037 step count: 264961 time: 14131.087 perplexity for hold out set: 4.759002685547
average_count is: 1038 step count: 265217 time: 14144.816 perplexity for hold out set: 4.758999824524
average_count is: 1039 step count: 265473 time: 14158.551 perplexity for hold out set: 4.758996963501
average_count is: 1040 step count: 265729 time: 14172.382 perplexity for hold out set: 4.758993148804
average_count is: 1041 step count: 265985 time: 14186.074 perplexity for hold out set: 4.758990287781
average_count is: 1042 step count: 266241 time: 14199.920 perplexity for hold out set: 4.758987426758
average_count is: 1043 step count: 266497 time: 14213.322 perplexity for hold out set: 4.758984565735
average_count is: 1044 step count: 266753 time: 14226.855 perplexity for hold out set: 4.758981704712
average_count is: 1045 step count: 267009 time: 14240.750 perplexity for hold out set: 4.758977890015
average_count is: 1046 step count: 267265 time: 14254.135 perplexity for hold out set: 4.758975028992
average_count is: 1047 step count: 267521 time: 14267.686 perplexity for hold out set: 4.758972167969
average_count is: 1048 step count: 267777 time: 14281.701 perplexity for hold out set: 4.758968830109
average_count is: 1049 step count: 268033 time: 14295.557 perplexity for hold out set: 4.758965969086
average_count is: 1050 step count: 268289 time: 14309.434 perplexity for hold out set: 4.758963584900
average_count is: 1051 step count: 268545 time: 14323.063 perplexity for hold out set: 4.758960723877
average_count is: 1052 step count: 268801 time: 14336.936 perplexity for hold out set: 4.758956909180
average_count is: 1053 step count: 269057 time: 14350.858 perplexity for hold out set: 4.758954048157
average_count is: 1054 step count: 269313 time: 14364.669 perplexity for hold out set: 4.758951663971
average_count is: 1055 step count: 269569 time: 14377.712 perplexity for hold out set: 4.758948326111
average_count is: 1056 step count: 269825 time: 14391.115 perplexity for hold out set: 4.758945465088
average_count is: 1057 step count: 270081 time: 14404.529 perplexity for hold out set: 4.758942127228
average_count is: 1058 step count: 270337 time: 14418.408 perplexity for hold out set: 4.758938789368
average_count is: 1059 step count: 270593 time: 14432.275 perplexity for hold out set: 4.758936405182
average_count is: 1060 step count: 270849 time: 14446.119 perplexity for hold out set: 4.758933067322
average_count is: 1061 step count: 271105 time: 14460.004 perplexity for hold out set: 4.758930206299
average_count is: 1062 step count: 271361 time: 14473.945 perplexity for hold out set: 4.758926868439
average_count is: 1063 step count: 271617 time: 14487.673 perplexity for hold out set: 4.758924007416
average_count is: 1064 step count: 271873 time: 14501.546 perplexity for hold out set: 4.758921146393
average_count is: 1065 step count: 272129 time: 14515.549 perplexity for hold out set: 4.758918285370
average_count is: 1066 step count: 272385 time: 14529.491 perplexity for hold out set: 4.758914947510
average_count is: 1067 step count: 272641 time: 14542.656 perplexity for hold out set: 4.758912086487
average_count is: 1068 step count: 272897 time: 14556.710 perplexity for hold out set: 4.758909702301
average_count is: 1069 step count: 273153 time: 14570.500 perplexity for hold out set: 4.758906364441
average_count is: 1070 step count: 273409 time: 14584.222 perplexity for hold out set: 4.758903503418
average_count is: 1071 step count: 273665 time: 14597.886 perplexity for hold out set: 4.758900642395
average_count is: 1072 step count: 273921 time: 14611.683 perplexity for hold out set: 4.758897304535
average_count is: 1073 step count: 274177 time: 14625.194 perplexity for hold out set: 4.758894443512
average_count is: 1074 step count: 274433 time: 14638.932 perplexity for hold out set: 4.758891582489
average_count is: 1075 step count: 274689 time: 14652.436 perplexity for hold out set: 4.758889198303
average_count is: 1076 step count: 274945 time: 14666.197 perplexity for hold out set: 4.758886337280
average_count is: 1077 step count: 275201 time: 14680.229 perplexity for hold out set: 4.758883476257
average_count is: 1078 step count: 275457 time: 14693.750 perplexity for hold out set: 4.758880138397
average_count is: 1079 step count: 275713 time: 14707.101 perplexity for hold out set: 4.758877277374
average_count is: 1080 step count: 275969 time: 14720.515 perplexity for hold out set: 4.758874893188
average_count is: 1081 step count: 276225 time: 14733.537 perplexity for hold out set: 4.758871555328
average_count is: 1082 step count: 276481 time: 14746.925 perplexity for hold out set: 4.758868694305
average_count is: 1083 step count: 276737 time: 14760.508 perplexity for hold out set: 4.758865833282
average_count is: 1084 step count: 276993 time: 14774.013 perplexity for hold out set: 4.758862972260
average_count is: 1085 step count: 277249 time: 14787.902 perplexity for hold out set: 4.758859634399
average_count is: 1086 step count: 277505 time: 14801.382 perplexity for hold out set: 4.758857250214
average_count is: 1087 step count: 277761 time: 14815.156 perplexity for hold out set: 4.758854389191
average_count is: 1088 step count: 278017 time: 14828.804 perplexity for hold out set: 4.758852005005
average_count is: 1089 step count: 278273 time: 14842.543 perplexity for hold out set: 4.758849620819
average_count is: 1090 step count: 278529 time: 14856.329 perplexity for hold out set: 4.758845806122
average_count is: 1091 step count: 278785 time: 14869.674 perplexity for hold out set: 4.758843421936
average_count is: 1092 step count: 279041 time: 14883.539 perplexity for hold out set: 4.758840560913
average_count is: 1093 step count: 279297 time: 14896.959 perplexity for hold out set: 4.758837699890
average_count is: 1094 step count: 279553 time: 14910.834 perplexity for hold out set: 4.758835315704
average_count is: 1095 step count: 279809 time: 14924.471 perplexity for hold out set: 4.758831977844
average_count is: 1096 step count: 280065 time: 14938.193 perplexity for hold out set: 4.758829593658
average_count is: 1097 step count: 280321 time: 14951.943 perplexity for hold out set: 4.758826255798
average_count is: 1098 step count: 280577 time: 14965.360 perplexity for hold out set: 4.758823871613
average_count is: 1099 step count: 280833 time: 14978.920 perplexity for hold out set: 4.758821010590
average_count is: 1100 step count: 281089 time: 14992.477 perplexity for hold out set: 4.758818149567
average_count is: 1101 step count: 281345 time: 15006.296 perplexity for hold out set: 4.758815765381
average_count is: 1102 step count: 281601 time: 15019.699 perplexity for hold out set: 4.758812904358
average_count is: 1103 step count: 281857 time: 15032.884 perplexity for hold out set: 4.758810043335
average_count is: 1104 step count: 282113 time: 15046.243 perplexity for hold out set: 4.758807659149
average_count is: 1105 step count: 282369 time: 15060.140 perplexity for hold out set: 4.758804321289
average_count is: 1106 step count: 282625 time: 15073.965 perplexity for hold out set: 4.758801937103
average_count is: 1107 step count: 282881 time: 15087.759 perplexity for hold out set: 4.758799552917
average_count is: 1108 step count: 283137 time: 15100.784 perplexity for hold out set: 4.758796215057
average_count is: 1109 step count: 283393 time: 15114.951 perplexity for hold out set: 4.758793830872
average_count is: 1110 step count: 283649 time: 15127.918 perplexity for hold out set: 4.758790969849
average_count is: 1111 step count: 283905 time: 15141.453 perplexity for hold out set: 4.758788108826
average_count is: 1112 step count: 284161 time: 15155.240 perplexity for hold out set: 4.758785724640
average_count is: 1113 step count: 284417 time: 15169.043 perplexity for hold out set: 4.758783340454
average_count is: 1114 step count: 284673 time: 15182.270 perplexity for hold out set: 4.758780479431
average_count is: 1115 step count: 284929 time: 15195.839 perplexity for hold out set: 4.758777618408
average_count is: 1116 step count: 285185 time: 15209.353 perplexity for hold out set: 4.758774757385
average_count is: 1117 step count: 285441 time: 15223.136 perplexity for hold out set: 4.758772373199
average_count is: 1118 step count: 285697 time: 15236.948 perplexity for hold out set: 4.758769512177
average_count is: 1119 step count: 285953 time: 15250.293 perplexity for hold out set: 4.758767127991
average_count is: 1120 step count: 286209 time: 15264.210 perplexity for hold out set: 4.758764266968
average_count is: 1121 step count: 286465 time: 15277.681 perplexity for hold out set: 4.758761405945
average_count is: 1122 step count: 286721 time: 15291.531 perplexity for hold out set: 4.758759021759
average_count is: 1123 step count: 286977 time: 15305.215 perplexity for hold out set: 4.758756637573
average_count is: 1124 step count: 287233 time: 15318.433 perplexity for hold out set: 4.758753776550
average_count is: 1125 step count: 287489 time: 15332.388 perplexity for hold out set: 4.758750915527
average_count is: 1126 step count: 287745 time: 15345.714 perplexity for hold out set: 4.758748531342
average_count is: 1127 step count: 288001 time: 15359.458 perplexity for hold out set: 4.758746147156
average_count is: 1128 step count: 288257 time: 15373.164 perplexity for hold out set: 4.758743762970
average_count is: 1129 step count: 288513 time: 15386.454 perplexity for hold out set: 4.758740901947
average_count is: 1130 step count: 288769 time: 15400.088 perplexity for hold out set: 4.758738517761
average_count is: 1131 step count: 289025 time: 15413.379 perplexity for hold out set: 4.758735179901
average_count is: 1132 step count: 289281 time: 15426.991 perplexity for hold out set: 4.758732795715
average_count is: 1133 step count: 289537 time: 15440.677 perplexity for hold out set: 4.758730411530
average_count is: 1134 step count: 289793 time: 15454.566 perplexity for hold out set: 4.758728027344
average_count is: 1135 step count: 290049 time: 15468.440 perplexity for hold out set: 4.758725166321
average_count is: 1136 step count: 290305 time: 15481.882 perplexity for hold out set: 4.758722782135
average_count is: 1137 step count: 290561 time: 15495.411 perplexity for hold out set: 4.758719921112
average_count is: 1138 step count: 290817 time: 15509.043 perplexity for hold out set: 4.758718013763
average_count is: 1139 step count: 291073 time: 15522.860 perplexity for hold out set: 4.758714675903
average_count is: 1140 step count: 291329 time: 15536.513 perplexity for hold out set: 4.758712768555
average_count is: 1141 step count: 291585 time: 15550.143 perplexity for hold out set: 4.758709907532
average_count is: 1142 step count: 291841 time: 15563.616 perplexity for hold out set: 4.758707523346
average_count is: 1143 step count: 292097 time: 15577.471 perplexity for hold out set: 4.758704662323
average_count is: 1144 step count: 292353 time: 15591.040 perplexity for hold out set: 4.758702278137
average_count is: 1145 step count: 292609 time: 15604.328 perplexity for hold out set: 4.758699893951
average_count is: 1146 step count: 292865 time: 15617.734 perplexity for hold out set: 4.758697032928
average_count is: 1147 step count: 293121 time: 15631.439 perplexity for hold out set: 4.758694648743
average_count is: 1148 step count: 293377 time: 15645.178 perplexity for hold out set: 4.758691787720
average_count is: 1149 step count: 293633 time: 15658.984 perplexity for hold out set: 4.758689880371
average_count is: 1150 step count: 293889 time: 15672.784 perplexity for hold out set: 4.758687019348
average_count is: 1151 step count: 294145 time: 15686.625 perplexity for hold out set: 4.758684158325
average_count is: 1152 step count: 294401 time: 15700.051 perplexity for hold out set: 4.758681774139
average_count is: 1153 step count: 294657 time: 15714.028 perplexity for hold out set: 4.758679389954
average_count is: 1154 step count: 294913 time: 15727.632 perplexity for hold out set: 4.758677005768
average_count is: 1155 step count: 295169 time: 15741.154 perplexity for hold out set: 4.758674144745
average_count is: 1156 step count: 295425 time: 15755.048 perplexity for hold out set: 4.758671760559
average_count is: 1157 step count: 295681 time: 15768.846 perplexity for hold out set: 4.758668899536
average_count is: 1158 step count: 295937 time: 15782.428 perplexity for hold out set: 4.758666992188
average_count is: 1159 step count: 296193 time: 15795.527 perplexity for hold out set: 4.758664608002
average_count is: 1160 step count: 296449 time: 15808.591 perplexity for hold out set: 4.758661746979
average_count is: 1161 step count: 296705 time: 15821.571 perplexity for hold out set: 4.758659362793
average_count is: 1162 step count: 296961 time: 15835.232 perplexity for hold out set: 4.758656978607
average_count is: 1163 step count: 297217 time: 15848.938 perplexity for hold out set: 4.758654594421
average_count is: 1164 step count: 297473 time: 15862.363 perplexity for hold out set: 4.758651733398
average_count is: 1165 step count: 297729 time: 15875.619 perplexity for hold out set: 4.758649349213
average_count is: 1166 step count: 297985 time: 15889.408 perplexity for hold out set: 4.758646965027
average_count is: 1167 step count: 298241 time: 15903.153 perplexity for hold out set: 4.758644580841
average_count is: 1168 step count: 298497 time: 15916.922 perplexity for hold out set: 4.758642196655
average_count is: 1169 step count: 298753 time: 15930.420 perplexity for hold out set: 4.758639812469
average_count is: 1170 step count: 299009 time: 15944.351 perplexity for hold out set: 4.758636951447
average_count is: 1171 step count: 299265 time: 15957.768 perplexity for hold out set: 4.758635044098
average_count is: 1172 step count: 299521 time: 15971.285 perplexity for hold out set: 4.758632183075
average_count is: 1173 step count: 299777 time: 15985.064 perplexity for hold out set: 4.758629798889
average_count is: 1174 step count: 300033 time: 15998.789 perplexity for hold out set: 4.758627414703
average_count is: 1175 step count: 300289 time: 16012.613 perplexity for hold out set: 4.758625507355
average_count is: 1176 step count: 300545 time: 16026.438 perplexity for hold out set: 4.758622646332
average_count is: 1177 step count: 300801 time: 16040.044 perplexity for hold out set: 4.758620262146
average_count is: 1178 step count: 301057 time: 16053.508 perplexity for hold out set: 4.758617877960
average_count is: 1179 step count: 301313 time: 16067.400 perplexity for hold out set: 4.758615493774
average_count is: 1180 step count: 301569 time: 16081.449 perplexity for hold out set: 4.758613586426
average_count is: 1181 step count: 301825 time: 16095.720 perplexity for hold out set: 4.758611202240
average_count is: 1182 step count: 302081 time: 16109.668 perplexity for hold out set: 4.758608341217
average_count is: 1183 step count: 302337 time: 16122.368 perplexity for hold out set: 4.758605957031
average_count is: 1184 step count: 302593 time: 16136.035 perplexity for hold out set: 4.758603096008
average_count is: 1185 step count: 302849 time: 16149.444 perplexity for hold out set: 4.758601665497
average_count is: 1186 step count: 303105 time: 16163.219 perplexity for hold out set: 4.758598804474
average_count is: 1187 step count: 303361 time: 16176.829 perplexity for hold out set: 4.758596420288
average_count is: 1188 step count: 303617 time: 16190.214 perplexity for hold out set: 4.758593559265
average_count is: 1189 step count: 303873 time: 16204.069 perplexity for hold out set: 4.758591175079
average_count is: 1190 step count: 304129 time: 16217.886 perplexity for hold out set: 4.758588790894
average_count is: 1191 step count: 304385 time: 16231.572 perplexity for hold out set: 4.758586406708
average_count is: 1192 step count: 304641 time: 16244.556 perplexity for hold out set: 4.758584976196
average_count is: 1193 step count: 304897 time: 16258.492 perplexity for hold out set: 4.758582115173
average_count is: 1194 step count: 305153 time: 16272.272 perplexity for hold out set: 4.758580207825
average_count is: 1195 step count: 305409 time: 16286.043 perplexity for hold out set: 4.758577346802
average_count is: 1196 step count: 305665 time: 16299.856 perplexity for hold out set: 4.758574962616
average_count is: 1197 step count: 305921 time: 16312.917 perplexity for hold out set: 4.758573055267
average_count is: 1198 step count: 306177 time: 16326.786 perplexity for hold out set: 4.758570671082
average_count is: 1199 step count: 306433 time: 16340.355 perplexity for hold out set: 4.758568286896
average_count is: 1200 step count: 306689 time: 16354.221 perplexity for hold out set: 4.758565902710
average_count is: 1201 step count: 306945 time: 16368.022 perplexity for hold out set: 4.758563518524
average_count is: 1202 step count: 307201 time: 16381.474 perplexity for hold out set: 4.758561134338
average_count is: 1203 step count: 307457 time: 16394.954 perplexity for hold out set: 4.758558750153
average_count is: 1204 step count: 307713 time: 16408.151 perplexity for hold out set: 4.758556365967
average_count is: 1205 step count: 307969 time: 16421.398 perplexity for hold out set: 4.758553981781
average_count is: 1206 step count: 308225 time: 16435.300 perplexity for hold out set: 4.758552074432
average_count is: 1207 step count: 308481 time: 16449.258 perplexity for hold out set: 4.758549690247
average_count is: 1208 step count: 308737 time: 16462.503 perplexity for hold out set: 4.758547782898
average_count is: 1209 step count: 308993 time: 16476.118 perplexity for hold out set: 4.758544921875
average_count is: 1210 step count: 309249 time: 16489.487 perplexity for hold out set: 4.758543014526
average_count is: 1211 step count: 309505 time: 16503.227 perplexity for hold out set: 4.758540630341
average_count is: 1212 step count: 309761 time: 16516.918 perplexity for hold out set: 4.758538246155
average_count is: 1213 step count: 310017 time: 16530.049 perplexity for hold out set: 4.758535861969
average_count is: 1214 step count: 310273 time: 16543.367 perplexity for hold out set: 4.758533477783
average_count is: 1215 step count: 310529 time: 16556.772 perplexity for hold out set: 4.758531570435
average_count is: 1216 step count: 310785 time: 16570.116 perplexity for hold out set: 4.758528709412
average_count is: 1217 step count: 311041 time: 16583.706 perplexity for hold out set: 4.758526325226
average_count is: 1218 step count: 311297 time: 16597.117 perplexity for hold out set: 4.758524417877
average_count is: 1219 step count: 311553 time: 16611.102 perplexity for hold out set: 4.758522033691
average_count is: 1220 step count: 311809 time: 16624.699 perplexity for hold out set: 4.758519649506
average_count is: 1221 step count: 312065 time: 16638.064 perplexity for hold out set: 4.758517742157
average_count is: 1222 step count: 312321 time: 16652.008 perplexity for hold out set: 4.758515834808
average_count is: 1223 step count: 312577 time: 16665.734 perplexity for hold out set: 4.758513450623
average_count is: 1224 step count: 312833 time: 16678.964 perplexity for hold out set: 4.758511066437
average_count is: 1225 step count: 313089 time: 16691.539 perplexity for hold out set: 4.758508682251
average_count is: 1226 step count: 313345 time: 16705.168 perplexity for hold out set: 4.758506298065
average_count is: 1227 step count: 313601 time: 16718.055 perplexity for hold out set: 4.758504390717
average_count is: 1228 step count: 313857 time: 16731.663 perplexity for hold out set: 4.758502006531
average_count is: 1229 step count: 314113 time: 16745.219 perplexity for hold out set: 4.758500099182
average_count is: 1230 step count: 314369 time: 16758.003 perplexity for hold out set: 4.758497714996
average_count is: 1231 step count: 314625 time: 16771.647 perplexity for hold out set: 4.758495330811
average_count is: 1232 step count: 314881 time: 16785.446 perplexity for hold out set: 4.758493423462
average_count is: 1233 step count: 315137 time: 16798.612 perplexity for hold out set: 4.758491039276
average_count is: 1234 step count: 315393 time: 16811.784 perplexity for hold out set: 4.758489131927
average_count is: 1235 step count: 315649 time: 16825.350 perplexity for hold out set: 4.758486747742
average_count is: 1236 step count: 315905 time: 16839.194 perplexity for hold out set: 4.758484840393
average_count is: 1237 step count: 316161 time: 16852.749 perplexity for hold out set: 4.758482933044
average_count is: 1238 step count: 316417 time: 16865.618 perplexity for hold out set: 4.758480548859
average_count is: 1239 step count: 316673 time: 16878.996 perplexity for hold out set: 4.758478164673
average_count is: 1240 step count: 316929 time: 16892.586 perplexity for hold out set: 4.758475780487
average_count is: 1241 step count: 317185 time: 16906.396 perplexity for hold out set: 4.758473396301
average_count is: 1242 step count: 317441 time: 16920.424 perplexity for hold out set: 4.758471488953
average_count is: 1243 step count: 317697 time: 16934.054 perplexity for hold out set: 4.758469581604
average_count is: 1244 step count: 317953 time: 16947.864 perplexity for hold out set: 4.758467674255
average_count is: 1245 step count: 318209 time: 16961.427 perplexity for hold out set: 4.758465290070
average_count is: 1246 step count: 318465 time: 16974.969 perplexity for hold out set: 4.758462905884
average_count is: 1247 step count: 318721 time: 16988.782 perplexity for hold out set: 4.758460521698
average_count is: 1248 step count: 318977 time: 17002.667 perplexity for hold out set: 4.758458614349
average_count is: 1249 step count: 319233 time: 17016.035 perplexity for hold out set: 4.758456707001
average_count is: 1250 step count: 319489 time: 17029.670 perplexity for hold out set: 4.758454322815
average_count is: 1251 step count: 319745 time: 17043.447 perplexity for hold out set: 4.758451938629
average_count is: 1252 step count: 320001 time: 17056.670 perplexity for hold out set: 4.758450031281
average_count is: 1253 step count: 320257 time: 17070.679 perplexity for hold out set: 4.758448123932
average_count is: 1254 step count: 320513 time: 17083.629 perplexity for hold out set: 4.758445739746
average_count is: 1255 step count: 320769 time: 17097.135 perplexity for hold out set: 4.758443832397
average_count is: 1256 step count: 321025 time: 17110.887 perplexity for hold out set: 4.758441448212
average_count is: 1257 step count: 321281 time: 17124.748 perplexity for hold out set: 4.758439064026
average_count is: 1258 step count: 321537 time: 17138.379 perplexity for hold out set: 4.758437156677
average_count is: 1259 step count: 321793 time: 17152.181 perplexity for hold out set: 4.758435249329
average_count is: 1260 step count: 322049 time: 17166.198 perplexity for hold out set: 4.758433341980
average_count is: 1261 step count: 322305 time: 17179.793 perplexity for hold out set: 4.758430957794
average_count is: 1262 step count: 322561 time: 17193.817 perplexity for hold out set: 4.758428573608
average_count is: 1263 step count: 322817 time: 17207.752 perplexity for hold out set: 4.758426666260
average_count is: 1264 step count: 323073 time: 17221.429 perplexity for hold out set: 4.758424282074
average_count is: 1265 step count: 323329 time: 17234.896 perplexity for hold out set: 4.758422374725
average_count is: 1266 step count: 323585 time: 17248.633 perplexity for hold out set: 4.758420944214
average_count is: 1267 step count: 323841 time: 17262.470 perplexity for hold out set: 4.758418083191
average_count is: 1268 step count: 324097 time: 17276.434 perplexity for hold out set: 4.758416175842
average_count is: 1269 step count: 324353 time: 17290.331 perplexity for hold out set: 4.758414268494
average_count is: 1270 step count: 324609 time: 17303.841 perplexity for hold out set: 4.758412361145
average_count is: 1271 step count: 324865 time: 17317.382 perplexity for hold out set: 4.758410453796
average_count is: 1272 step count: 325121 time: 17331.332 perplexity for hold out set: 4.758408069611
average_count is: 1273 step count: 325377 time: 17344.785 perplexity for hold out set: 4.758406162262
average_count is: 1274 step count: 325633 time: 17358.081 perplexity for hold out set: 4.758403778076
average_count is: 1275 step count: 325889 time: 17371.687 perplexity for hold out set: 4.758401870728
average_count is: 1276 step count: 326145 time: 17385.429 perplexity for hold out set: 4.758399963379
average_count is: 1277 step count: 326401 time: 17399.237 perplexity for hold out set: 4.758398056030
average_count is: 1278 step count: 326657 time: 17412.926 perplexity for hold out set: 4.758396148682
average_count is: 1279 step count: 326913 time: 17426.821 perplexity for hold out set: 4.758393764496
average_count is: 1280 step count: 327169 time: 17440.756 perplexity for hold out set: 4.758391380310
average_count is: 1281 step count: 327425 time: 17454.755 perplexity for hold out set: 4.758389472961
timer                                    total (s)    ticks  per tick (us)
  load network graph                        3.000        1    3000469.734
  initialize DKV store                      0.776        1     776055.486
  populate pi                               0.001        1       1417.394
  iteration                             17468.043   327679      53308.400
    deploy minibatch                      672.473   327680       2052.228
      scatter subgraph                     73.916   327680        225.576
        marshall edge count                26.425   327680         80.644
        scatterv edges                      4.345   327680         13.261
        marshall edges                     31.410   327680         95.857
        scatterv edges                     10.835   327680         33.068
        unmarshall edges                    0.024   327680          0.074
      sample_mini_batch                   251.600   327680        767.824
      nodes_in_mini_batch                 114.482   327680        349.372
    broadcast theta/beta                  861.151   327679       2628.033
    update_phi_pi                       11230.011   327679      34271.379
      create minibatch slice chunks         0.121   327680          0.370
      reorder minibatch overlap     <unused>
      sample_neighbor_nodes                30.202   327680         92.170
      resample_neighbor_nodes       <unused>
      load minibatch pi                     0.951   655359          1.452
      load neighbor pi                      0.418   655359          0.639
      update_phi                           61.638   655358         94.052
      barrier after update phi           9230.013   327679      28167.852
      update_pi                     <unused>
      store minibatch pi            <unused>
      barrier after update pi            1230.938   327679       3756.537
    update_beta_theta                    5093.652   327679      15544.642
      zero beta grads                      93.767   327679        286.156
      rank minibatch nodes                  6.794   327679         20.734
      load pi update_beta                 327.409   327679        999.176
      beta calc grads                     525.121   327679       1602.548
      beta sum grads                      145.110   327679        442.844
      beta reduce(+) grads               3085.137   327679       9415.120
      update theta                        661.030   327679       2017.312
  perplexity                              268.347     1280     209646.361
      load perplexity pi                  211.897     1280     165545.143
      calc edge likelihood                 53.075     1280      41465.413
      purge perplexity pi                   0.004     1280          3.652
      reduce/plus perplexity                3.320     1280       2594.201
average_count is: 1282 step count: 327681 time: 17468.430 perplexity for hold out set: 4.758387565613
average_count is: 1283 step count: 327937 time: 17481.870 perplexity for hold out set: 4.758385181427
average_count is: 1284 step count: 328193 time: 17494.645 perplexity for hold out set: 4.758383750916
average_count is: 1285 step count: 328449 time: 17508.435 perplexity for hold out set: 4.758381843567
average_count is: 1286 step count: 328705 time: 17522.170 perplexity for hold out set: 4.758379459381
average_count is: 1287 step count: 328961 time: 17534.895 perplexity for hold out set: 4.758377552032
average_count is: 1288 step count: 329217 time: 17548.876 perplexity for hold out set: 4.758375167847
average_count is: 1289 step count: 329473 time: 17562.537 perplexity for hold out set: 4.758373260498
average_count is: 1290 step count: 329729 time: 17576.202 perplexity for hold out set: 4.758371829987
average_count is: 1291 step count: 329985 time: 17589.917 perplexity for hold out set: 4.758369445801
average_count is: 1292 step count: 330241 time: 17603.696 perplexity for hold out set: 4.758368015289
average_count is: 1293 step count: 330497 time: 17617.049 perplexity for hold out set: 4.758365631104
average_count is: 1294 step count: 330753 time: 17630.177 perplexity for hold out set: 4.758363723755
average_count is: 1295 step count: 331009 time: 17643.594 perplexity for hold out set: 4.758361339569
average_count is: 1296 step count: 331265 time: 17656.953 perplexity for hold out set: 4.758359909058
average_count is: 1297 step count: 331521 time: 17670.698 perplexity for hold out set: 4.758357524872
average_count is: 1298 step count: 331777 time: 17684.587 perplexity for hold out set: 4.758356094360
average_count is: 1299 step count: 332033 time: 17698.467 perplexity for hold out set: 4.758354187012
average_count is: 1300 step count: 332289 time: 17711.728 perplexity for hold out set: 4.758351802826
average_count is: 1301 step count: 332545 time: 17724.982 perplexity for hold out set: 4.758349895477
average_count is: 1302 step count: 332801 time: 17738.608 perplexity for hold out set: 4.758347988129
average_count is: 1303 step count: 333057 time: 17752.375 perplexity for hold out set: 4.758346557617
average_count is: 1304 step count: 333313 time: 17766.294 perplexity for hold out set: 4.758344173431
average_count is: 1305 step count: 333569 time: 17780.137 perplexity for hold out set: 4.758342266083
average_count is: 1306 step count: 333825 time: 17793.635 perplexity for hold out set: 4.758340358734
average_count is: 1307 step count: 334081 time: 17807.197 perplexity for hold out set: 4.758338451385
average_count is: 1308 step count: 334337 time: 17820.945 perplexity for hold out set: 4.758336544037
average_count is: 1309 step count: 334593 time: 17834.834 perplexity for hold out set: 4.758334636688
average_count is: 1310 step count: 334849 time: 17848.564 perplexity for hold out set: 4.758332729340
average_count is: 1311 step count: 335105 time: 17862.320 perplexity for hold out set: 4.758330345154
average_count is: 1312 step count: 335361 time: 17876.177 perplexity for hold out set: 4.758328914642
average_count is: 1313 step count: 335617 time: 17890.185 perplexity for hold out set: 4.758326530457
average_count is: 1314 step count: 335873 time: 17903.983 perplexity for hold out set: 4.758324623108
average_count is: 1315 step count: 336129 time: 17917.538 perplexity for hold out set: 4.758322715759
average_count is: 1316 step count: 336385 time: 17931.421 perplexity for hold out set: 4.758321285248
average_count is: 1317 step count: 336641 time: 17945.235 perplexity for hold out set: 4.758319377899
average_count is: 1318 step count: 336897 time: 17958.801 perplexity for hold out set: 4.758317947388
average_count is: 1319 step count: 337153 time: 17972.744 perplexity for hold out set: 4.758315563202
average_count is: 1320 step count: 337409 time: 17986.549 perplexity for hold out set: 4.758313655853
average_count is: 1321 step count: 337665 time: 18000.420 perplexity for hold out set: 4.758311748505
average_count is: 1322 step count: 337921 time: 18014.269 perplexity for hold out set: 4.758309841156
average_count is: 1323 step count: 338177 time: 18028.243 perplexity for hold out set: 4.758308410645
average_count is: 1324 step count: 338433 time: 18041.770 perplexity for hold out set: 4.758306026459
average_count is: 1325 step count: 338689 time: 18055.386 perplexity for hold out set: 4.758304595947
average_count is: 1326 step count: 338945 time: 18069.179 perplexity for hold out set: 4.758302211761
average_count is: 1327 step count: 339201 time: 18082.769 perplexity for hold out set: 4.758300304413
average_count is: 1328 step count: 339457 time: 18096.436 perplexity for hold out set: 4.758298873901
average_count is: 1329 step count: 339713 time: 18110.362 perplexity for hold out set: 4.758296489716
average_count is: 1330 step count: 339969 time: 18123.113 perplexity for hold out set: 4.758295059204
average_count is: 1331 step count: 340225 time: 18136.876 perplexity for hold out set: 4.758292675018
average_count is: 1332 step count: 340481 time: 18150.518 perplexity for hold out set: 4.758290767670
average_count is: 1333 step count: 340737 time: 18164.238 perplexity for hold out set: 4.758289337158
average_count is: 1334 step count: 340993 time: 18178.186 perplexity for hold out set: 4.758286952972
average_count is: 1335 step count: 341249 time: 18191.508 perplexity for hold out set: 4.758285045624
average_count is: 1336 step count: 341505 time: 18204.755 perplexity for hold out set: 4.758283615112
average_count is: 1337 step count: 341761 time: 18218.590 perplexity for hold out set: 4.758282184601
average_count is: 1338 step count: 342017 time: 18232.323 perplexity for hold out set: 4.758280277252
average_count is: 1339 step count: 342273 time: 18246.039 perplexity for hold out set: 4.758278369904
average_count is: 1340 step count: 342529 time: 18259.827 perplexity for hold out set: 4.758276462555
average_count is: 1341 step count: 342785 time: 18273.669 perplexity for hold out set: 4.758274555206
average_count is: 1342 step count: 343041 time: 18287.464 perplexity for hold out set: 4.758272647858
average_count is: 1343 step count: 343297 time: 18301.268 perplexity for hold out set: 4.758270740509
average_count is: 1344 step count: 343553 time: 18315.082 perplexity for hold out set: 4.758268833160
average_count is: 1345 step count: 343809 time: 18328.961 perplexity for hold out set: 4.758267402649
average_count is: 1346 step count: 344065 time: 18342.855 perplexity for hold out set: 4.758265018463
average_count is: 1347 step count: 344321 time: 18356.329 perplexity for hold out set: 4.758263111115
average_count is: 1348 step count: 344577 time: 18369.851 perplexity for hold out set: 4.758261680603
average_count is: 1349 step count: 344833 time: 18383.874 perplexity for hold out set: 4.758259296417
average_count is: 1350 step count: 345089 time: 18397.734 perplexity for hold out set: 4.758257865906
average_count is: 1351 step count: 345345 time: 18411.324 perplexity for hold out set: 4.758255958557
average_count is: 1352 step count: 345601 time: 18425.018 perplexity for hold out set: 4.758254528046
average_count is: 1353 step count: 345857 time: 18438.640 perplexity for hold out set: 4.758252143860
average_count is: 1354 step count: 346113 time: 18451.693 perplexity for hold out set: 4.758250713348
average_count is: 1355 step count: 346369 time: 18465.126 perplexity for hold out set: 4.758248806000
average_count is: 1356 step count: 346625 time: 18478.757 perplexity for hold out set: 4.758247375488
average_count is: 1357 step count: 346881 time: 18492.631 perplexity for hold out set: 4.758244991302
average_count is: 1358 step count: 347137 time: 18506.417 perplexity for hold out set: 4.758243560791
average_count is: 1359 step count: 347393 time: 18520.085 perplexity for hold out set: 4.758241653442
average_count is: 1360 step count: 347649 time: 18533.975 perplexity for hold out set: 4.758239746094
average_count is: 1361 step count: 347905 time: 18547.784 perplexity for hold out set: 4.758237838745
average_count is: 1362 step count: 348161 time: 18561.208 perplexity for hold out set: 4.758236408234
average_count is: 1363 step count: 348417 time: 18574.793 perplexity for hold out set: 4.758234500885
average_count is: 1364 step count: 348673 time: 18588.281 perplexity for hold out set: 4.758232593536
average_count is: 1365 step count: 348929 time: 18601.970 perplexity for hold out set: 4.758230686188
average_count is: 1366 step count: 349185 time: 18615.869 perplexity for hold out set: 4.758229255676
average_count is: 1367 step count: 349441 time: 18629.731 perplexity for hold out set: 4.758227348328
average_count is: 1368 step count: 349697 time: 18643.171 perplexity for hold out set: 4.758225440979
average_count is: 1369 step count: 349953 time: 18656.571 perplexity for hold out set: 4.758223533630
average_count is: 1370 step count: 350209 time: 18670.299 perplexity for hold out set: 4.758222103119
average_count is: 1371 step count: 350465 time: 18684.137 perplexity for hold out set: 4.758220195770
average_count is: 1372 step count: 350721 time: 18697.657 perplexity for hold out set: 4.758218765259
average_count is: 1373 step count: 350977 time: 18711.458 perplexity for hold out set: 4.758216857910
average_count is: 1374 step count: 351233 time: 18725.437 perplexity for hold out set: 4.758214950562
average_count is: 1375 step count: 351489 time: 18739.159 perplexity for hold out set: 4.758213520050
average_count is: 1376 step count: 351745 time: 18752.844 perplexity for hold out set: 4.758211612701
average_count is: 1377 step count: 352001 time: 18766.465 perplexity for hold out set: 4.758210182190
average_count is: 1378 step count: 352257 time: 18780.023 perplexity for hold out set: 4.758207798004
average_count is: 1379 step count: 352513 time: 18793.634 perplexity for hold out set: 4.758206367493
average_count is: 1380 step count: 352769 time: 18807.287 perplexity for hold out set: 4.758204460144
average_count is: 1381 step count: 353025 time: 18820.995 perplexity for hold out set: 4.758203029633
average_count is: 1382 step count: 353281 time: 18834.397 perplexity for hold out set: 4.758200645447
average_count is: 1383 step count: 353537 time: 18847.710 perplexity for hold out set: 4.758199214935
average_count is: 1384 step count: 353793 time: 18860.868 perplexity for hold out set: 4.758197307587
average_count is: 1385 step count: 354049 time: 18874.762 perplexity for hold out set: 4.758195400238
average_count is: 1386 step count: 354305 time: 18888.047 perplexity for hold out set: 4.758193492889
average_count is: 1387 step count: 354561 time: 18901.407 perplexity for hold out set: 4.758192062378
average_count is: 1388 step count: 354817 time: 18914.710 perplexity for hold out set: 4.758190155029
average_count is: 1389 step count: 355073 time: 18928.641 perplexity for hold out set: 4.758188724518
average_count is: 1390 step count: 355329 time: 18942.159 perplexity for hold out set: 4.758187294006
average_count is: 1391 step count: 355585 time: 18955.674 perplexity for hold out set: 4.758184909821
average_count is: 1392 step count: 355841 time: 18969.169 perplexity for hold out set: 4.758183956146
average_count is: 1393 step count: 356097 time: 18983.016 perplexity for hold out set: 4.758182048798
average_count is: 1394 step count: 356353 time: 18996.995 perplexity for hold out set: 4.758180141449
average_count is: 1395 step count: 356609 time: 19010.984 perplexity for hold out set: 4.758178234100
average_count is: 1396 step count: 356865 time: 19024.424 perplexity for hold out set: 4.758176803589
average_count is: 1397 step count: 357121 time: 19037.816 perplexity for hold out set: 4.758174896240
average_count is: 1398 step count: 357377 time: 19051.103 perplexity for hold out set: 4.758173942566
average_count is: 1399 step count: 357633 time: 19064.174 perplexity for hold out set: 4.758172035217
average_count is: 1400 step count: 357889 time: 19078.114 perplexity for hold out set: 4.758169651031
average_count is: 1401 step count: 358145 time: 19091.590 perplexity for hold out set: 4.758168697357
average_count is: 1402 step count: 358401 time: 19104.860 perplexity for hold out set: 4.758166790009
average_count is: 1403 step count: 358657 time: 19117.665 perplexity for hold out set: 4.758164882660
average_count is: 1404 step count: 358913 time: 19130.924 perplexity for hold out set: 4.758163452148
average_count is: 1405 step count: 359169 time: 19144.312 perplexity for hold out set: 4.758162021637
average_count is: 1406 step count: 359425 time: 19158.050 perplexity for hold out set: 4.758160114288
average_count is: 1407 step count: 359681 time: 19171.562 perplexity for hold out set: 4.758158206940
average_count is: 1408 step count: 359937 time: 19185.023 perplexity for hold out set: 4.758156299591
average_count is: 1409 step count: 360193 time: 19198.884 perplexity for hold out set: 4.758154869080
average_count is: 1410 step count: 360449 time: 19212.437 perplexity for hold out set: 4.758153438568
average_count is: 1411 step count: 360705 time: 19226.227 perplexity for hold out set: 4.758152008057
average_count is: 1412 step count: 360961 time: 19239.411 perplexity for hold out set: 4.758150100708
average_count is: 1413 step count: 361217 time: 19253.356 perplexity for hold out set: 4.758148670197
average_count is: 1414 step count: 361473 time: 19267.281 perplexity for hold out set: 4.758146762848
average_count is: 1415 step count: 361729 time: 19281.145 perplexity for hold out set: 4.758145332336
average_count is: 1416 step count: 361985 time: 19294.903 perplexity for hold out set: 4.758143424988
average_count is: 1417 step count: 362241 time: 19308.456 perplexity for hold out set: 4.758141994476
average_count is: 1418 step count: 362497 time: 19322.218 perplexity for hold out set: 4.758140087128
average_count is: 1419 step count: 362753 time: 19336.058 perplexity for hold out set: 4.758138656616
average_count is: 1420 step count: 363009 time: 19349.487 perplexity for hold out set: 4.758136749268
average_count is: 1421 step count: 363265 time: 19362.714 perplexity for hold out set: 4.758135318756
average_count is: 1422 step count: 363521 time: 19376.188 perplexity for hold out set: 4.758133888245
average_count is: 1423 step count: 363777 time: 19389.764 perplexity for hold out set: 4.758131504059
average_count is: 1424 step count: 364033 time: 19403.367 perplexity for hold out set: 4.758130073547
average_count is: 1425 step count: 364289 time: 19416.561 perplexity for hold out set: 4.758128643036
average_count is: 1426 step count: 364545 time: 19429.971 perplexity for hold out set: 4.758127212524
average_count is: 1427 step count: 364801 time: 19443.533 perplexity for hold out set: 4.758125305176
average_count is: 1428 step count: 365057 time: 19457.034 perplexity for hold out set: 4.758123874664
average_count is: 1429 step count: 365313 time: 19470.624 perplexity for hold out set: 4.758121967316
average_count is: 1430 step count: 365569 time: 19483.301 perplexity for hold out set: 4.758120059967
average_count is: 1431 step count: 365825 time: 19496.913 perplexity for hold out set: 4.758119106293
average_count is: 1432 step count: 366081 time: 19510.659 perplexity for hold out set: 4.758117675781
average_count is: 1433 step count: 366337 time: 19524.387 perplexity for hold out set: 4.758115768433
average_count is: 1434 step count: 366593 time: 19538.035 perplexity for hold out set: 4.758114337921
average_count is: 1435 step count: 366849 time: 19551.428 perplexity for hold out set: 4.758112430573
average_count is: 1436 step count: 367105 time: 19565.297 perplexity for hold out set: 4.758110523224
average_count is: 1437 step count: 367361 time: 19579.081 perplexity for hold out set: 4.758109569550
average_count is: 1438 step count: 367617 time: 19592.464 perplexity for hold out set: 4.758108139038
average_count is: 1439 step count: 367873 time: 19606.344 perplexity for hold out set: 4.758106231689
average_count is: 1440 step count: 368129 time: 19620.119 perplexity for hold out set: 4.758104801178
average_count is: 1441 step count: 368385 time: 19633.970 perplexity for hold out set: 4.758102893829
average_count is: 1442 step count: 368641 time: 19647.316 perplexity for hold out set: 4.758100986481
average_count is: 1443 step count: 368897 time: 19661.086 perplexity for hold out set: 4.758099555969
average_count is: 1444 step count: 369153 time: 19675.052 perplexity for hold out set: 4.758098125458
average_count is: 1445 step count: 369409 time: 19688.232 perplexity for hold out set: 4.758096218109
average_count is: 1446 step count: 369665 time: 19702.078 perplexity for hold out set: 4.758094787598
average_count is: 1447 step count: 369921 time: 19714.917 perplexity for hold out set: 4.758093357086
average_count is: 1448 step count: 370177 time: 19728.690 perplexity for hold out set: 4.758091449738
average_count is: 1449 step count: 370433 time: 19742.682 perplexity for hold out set: 4.758089542389
average_count is: 1450 step count: 370689 time: 19756.152 perplexity for hold out set: 4.758088588715
average_count is: 1451 step count: 370945 time: 19769.128 perplexity for hold out set: 4.758086681366
average_count is: 1452 step count: 371201 time: 19782.619 perplexity for hold out set: 4.758085250854
average_count is: 1453 step count: 371457 time: 19796.232 perplexity for hold out set: 4.758083820343
average_count is: 1454 step count: 371713 time: 19809.869 perplexity for hold out set: 4.758082389832
average_count is: 1455 step count: 371969 time: 19822.962 perplexity for hold out set: 4.758080959320
average_count is: 1456 step count: 372225 time: 19836.460 perplexity for hold out set: 4.758079528809
average_count is: 1457 step count: 372481 time: 19850.409 perplexity for hold out set: 4.758077144623
average_count is: 1458 step count: 372737 time: 19863.964 perplexity for hold out set: 4.758076190948
average_count is: 1459 step count: 372993 time: 19877.754 perplexity for hold out set: 4.758074283600
average_count is: 1460 step count: 373249 time: 19891.344 perplexity for hold out set: 4.758072853088
average_count is: 1461 step count: 373505 time: 19904.954 perplexity for hold out set: 4.758070945740
average_count is: 1462 step count: 373761 time: 19918.997 perplexity for hold out set: 4.758069992065
average_count is: 1463 step count: 374017 time: 19932.572 perplexity for hold out set: 4.758068561554
average_count is: 1464 step count: 374273 time: 19946.428 perplexity for hold out set: 4.758066654205
average_count is: 1465 step count: 374529 time: 19960.094 perplexity for hold out set: 4.758065223694
average_count is: 1466 step count: 374785 time: 19973.928 perplexity for hold out set: 4.758063316345
average_count is: 1467 step count: 375041 time: 19987.386 perplexity for hold out set: 4.758061885834
average_count is: 1468 step count: 375297 time: 20000.564 perplexity for hold out set: 4.758060455322
average_count is: 1469 step count: 375553 time: 20014.362 perplexity for hold out set: 4.758058547974
average_count is: 1470 step count: 375809 time: 20028.264 perplexity for hold out set: 4.758057117462
average_count is: 1471 step count: 376065 time: 20041.847 perplexity for hold out set: 4.758055686951
average_count is: 1472 step count: 376321 time: 20055.520 perplexity for hold out set: 4.758053779602
average_count is: 1473 step count: 376577 time: 20069.043 perplexity for hold out set: 4.758052349091
average_count is: 1474 step count: 376833 time: 20082.505 perplexity for hold out set: 4.758050918579
average_count is: 1475 step count: 377089 time: 20096.327 perplexity for hold out set: 4.758049488068
average_count is: 1476 step count: 377345 time: 20109.913 perplexity for hold out set: 4.758048057556
average_count is: 1477 step count: 377601 time: 20123.602 perplexity for hold out set: 4.758046627045
average_count is: 1478 step count: 377857 time: 20137.373 perplexity for hold out set: 4.758045196533
average_count is: 1479 step count: 378113 time: 20151.096 perplexity for hold out set: 4.758043766022
average_count is: 1480 step count: 378369 time: 20164.547 perplexity for hold out set: 4.758042335510
average_count is: 1481 step count: 378625 time: 20177.278 perplexity for hold out set: 4.758040428162
average_count is: 1482 step count: 378881 time: 20190.474 perplexity for hold out set: 4.758038520813
average_count is: 1483 step count: 379137 time: 20204.110 perplexity for hold out set: 4.758037567139
average_count is: 1484 step count: 379393 time: 20218.055 perplexity for hold out set: 4.758036136627
average_count is: 1485 step count: 379649 time: 20231.908 perplexity for hold out set: 4.758034229279
average_count is: 1486 step count: 379905 time: 20245.732 perplexity for hold out set: 4.758032798767
average_count is: 1487 step count: 380161 time: 20259.488 perplexity for hold out set: 4.758031368256
average_count is: 1488 step count: 380417 time: 20273.261 perplexity for hold out set: 4.758029937744
average_count is: 1489 step count: 380673 time: 20286.776 perplexity for hold out set: 4.758028507233
average_count is: 1490 step count: 380929 time: 20300.061 perplexity for hold out set: 4.758027076721
average_count is: 1491 step count: 381185 time: 20313.900 perplexity for hold out set: 4.758025169373
average_count is: 1492 step count: 381441 time: 20327.462 perplexity for hold out set: 4.758023738861
average_count is: 1493 step count: 381697 time: 20340.996 perplexity for hold out set: 4.758022308350
average_count is: 1494 step count: 381953 time: 20354.343 perplexity for hold out set: 4.758020877838
average_count is: 1495 step count: 382209 time: 20368.163 perplexity for hold out set: 4.758019447327
average_count is: 1496 step count: 382465 time: 20381.663 perplexity for hold out set: 4.758018493652
average_count is: 1497 step count: 382721 time: 20395.416 perplexity for hold out set: 4.758016586304
average_count is: 1498 step count: 382977 time: 20409.071 perplexity for hold out set: 4.758015155792
average_count is: 1499 step count: 383233 time: 20422.381 perplexity for hold out set: 4.758013725281
average_count is: 1500 step count: 383489 time: 20436.132 perplexity for hold out set: 4.758012294769
average_count is: 1501 step count: 383745 time: 20450.081 perplexity for hold out set: 4.758010387421
average_count is: 1502 step count: 384001 time: 20464.071 perplexity for hold out set: 4.758008956909
average_count is: 1503 step count: 384257 time: 20477.598 perplexity for hold out set: 4.758007526398
average_count is: 1504 step count: 384513 time: 20491.629 perplexity for hold out set: 4.758006095886
average_count is: 1505 step count: 384769 time: 20505.641 perplexity for hold out set: 4.758004665375
average_count is: 1506 step count: 385025 time: 20519.272 perplexity for hold out set: 4.758003234863
average_count is: 1507 step count: 385281 time: 20533.131 perplexity for hold out set: 4.758001804352
average_count is: 1508 step count: 385537 time: 20547.033 perplexity for hold out set: 4.758000373840
average_count is: 1509 step count: 385793 time: 20560.993 perplexity for hold out set: 4.757998466492
average_count is: 1510 step count: 386049 time: 20574.710 perplexity for hold out set: 4.757997035980
average_count is: 1511 step count: 386305 time: 20588.047 perplexity for hold out set: 4.757996082306
average_count is: 1512 step count: 386561 time: 20600.908 perplexity for hold out set: 4.757994651794
average_count is: 1513 step count: 386817 time: 20614.620 perplexity for hold out set: 4.757993221283
average_count is: 1514 step count: 387073 time: 20628.135 perplexity for hold out set: 4.757991313934
average_count is: 1515 step count: 387329 time: 20641.774 perplexity for hold out set: 4.757989883423
average_count is: 1516 step count: 387585 time: 20655.554 perplexity for hold out set: 4.757988452911
average_count is: 1517 step count: 387841 time: 20669.012 perplexity for hold out set: 4.757986545563
average_count is: 1518 step count: 388097 time: 20682.533 perplexity for hold out set: 4.757986068726
average_count is: 1519 step count: 388353 time: 20696.453 perplexity for hold out set: 4.757984161377
average_count is: 1520 step count: 388609 time: 20710.386 perplexity for hold out set: 4.757982730865
average_count is: 1521 step count: 388865 time: 20724.299 perplexity for hold out set: 4.757982254028
average_count is: 1522 step count: 389121 time: 20737.474 perplexity for hold out set: 4.757979869843
average_count is: 1523 step count: 389377 time: 20751.227 perplexity for hold out set: 4.757978916168
average_count is: 1524 step count: 389633 time: 20764.732 perplexity for hold out set: 4.757977485657
average_count is: 1525 step count: 389889 time: 20778.233 perplexity for hold out set: 4.757975578308
average_count is: 1526 step count: 390145 time: 20791.819 perplexity for hold out set: 4.757974147797
average_count is: 1527 step count: 390401 time: 20805.731 perplexity for hold out set: 4.757972717285
average_count is: 1528 step count: 390657 time: 20819.555 perplexity for hold out set: 4.757971286774
average_count is: 1529 step count: 390913 time: 20832.778 perplexity for hold out set: 4.757970333099
average_count is: 1530 step count: 391169 time: 20846.618 perplexity for hold out set: 4.757968425751
average_count is: 1531 step count: 391425 time: 20860.170 perplexity for hold out set: 4.757966995239
average_count is: 1532 step count: 391681 time: 20873.899 perplexity for hold out set: 4.757965564728
average_count is: 1533 step count: 391937 time: 20887.111 perplexity for hold out set: 4.757963657379
average_count is: 1534 step count: 392193 time: 20900.765 perplexity for hold out set: 4.757962703705
average_count is: 1535 step count: 392449 time: 20914.637 perplexity for hold out set: 4.757961750031
average_count is: 1536 step count: 392705 time: 20928.382 perplexity for hold out set: 4.757959842682
average_count is: 1537 step count: 392961 time: 20941.955 perplexity for hold out set: 4.757958412170
timer                                    total (s)    ticks  per tick (us)
  load network graph                        3.000        1    3000469.734
  initialize DKV store                      0.776        1     776055.486
  populate pi                               0.001        1       1417.394
  iteration                             20954.683   393215      53290.652
    deploy minibatch                      807.098   393216       2052.557
      scatter subgraph                     88.793   393216        225.814
        marshall edge count                31.748   393216         80.740
        scatterv edges                      5.224   393216         13.287
        marshall edges                     37.676   393216         95.816
        scatterv edges                     13.063   393216         33.222
        unmarshall edges                    0.029   393216          0.074
      sample_mini_batch                   301.729   393216        767.337
      nodes_in_mini_batch                 137.277   393216        349.116
    broadcast theta/beta                 1033.181   393215       2627.524
    update_phi_pi                       13472.902   393215      34263.450
      create minibatch slice chunks         0.144   393216          0.369
      reorder minibatch overlap     <unused>
      sample_neighbor_nodes                36.274   393216         92.250
      resample_neighbor_nodes       <unused>
      load minibatch pi                     1.138   786431          1.448
      load neighbor pi                      0.502   786431          0.638
      update_phi                           74.150   786430         94.288
      barrier after update phi          11074.112   393215      28162.995
      update_pi                     <unused>
      store minibatch pi            <unused>
      barrier after update pi            1475.575   393215       3752.593
    update_beta_theta                    6108.805   393215      15535.535
      zero beta grads                     112.493   393215        286.086
      rank minibatch nodes                  8.151   393215         20.731
      load pi update_beta                 393.228   393215       1000.034
      beta calc grads                     630.154   393215       1602.571
      beta sum grads                      174.056   393215        442.650
      beta reduce(+) grads               3696.918   393215       9401.774
      update theta                        794.928   393215       2021.614
  perplexity                              321.927     1536     209587.921
      load perplexity pi                  254.229     1536     165514.007
      calc edge likelihood                 63.717     1536      41482.811
      purge perplexity pi                   0.005     1536          3.641
      reduce/plus perplexity                3.917     1536       2550.410
average_count is: 1538 step count: 393217 time: 20955.088 perplexity for hold out set: 4.757956981659
average_count is: 1539 step count: 393473 time: 20968.831 perplexity for hold out set: 4.757956027985
average_count is: 1540 step count: 393729 time: 20982.207 perplexity for hold out set: 4.757954597473
average_count is: 1541 step count: 393985 time: 20995.991 perplexity for hold out set: 4.757953166962
average_count is: 1542 step count: 394241 time: 21009.846 perplexity for hold out set: 4.757951736450
average_count is: 1543 step count: 394497 time: 21023.591 perplexity for hold out set: 4.757950305939
average_count is: 1544 step count: 394753 time: 21037.271 perplexity for hold out set: 4.757948875427
average_count is: 1545 step count: 395009 time: 21051.084 perplexity for hold out set: 4.757947921753
average_count is: 1546 step count: 395265 time: 21064.576 perplexity for hold out set: 4.757946014404
average_count is: 1547 step count: 395521 time: 21077.842 perplexity for hold out set: 4.757944583893
average_count is: 1548 step count: 395777 time: 21091.537 perplexity for hold out set: 4.757943153381
average_count is: 1549 step count: 396033 time: 21105.274 perplexity for hold out set: 4.757941722870
average_count is: 1550 step count: 396289 time: 21119.321 perplexity for hold out set: 4.757940769196
average_count is: 1551 step count: 396545 time: 21133.152 perplexity for hold out set: 4.757939338684
average_count is: 1552 step count: 396801 time: 21146.936 perplexity for hold out set: 4.757937431335
average_count is: 1553 step count: 397057 time: 21160.466 perplexity for hold out set: 4.757936000824
average_count is: 1554 step count: 397313 time: 21173.926 perplexity for hold out set: 4.757935047150
average_count is: 1555 step count: 397569 time: 21187.751 perplexity for hold out set: 4.757933616638
average_count is: 1556 step count: 397825 time: 21201.315 perplexity for hold out set: 4.757931709290
average_count is: 1557 step count: 398081 time: 21214.981 perplexity for hold out set: 4.757930755615
average_count is: 1558 step count: 398337 time: 21228.336 perplexity for hold out set: 4.757929325104
average_count is: 1559 step count: 398593 time: 21241.989 perplexity for hold out set: 4.757927894592
average_count is: 1560 step count: 398849 time: 21255.841 perplexity for hold out set: 4.757926464081
average_count is: 1561 step count: 399105 time: 21269.559 perplexity for hold out set: 4.757925033569
average_count is: 1562 step count: 399361 time: 21283.241 perplexity for hold out set: 4.757923603058
average_count is: 1563 step count: 399617 time: 21297.263 perplexity for hold out set: 4.757922649384
average_count is: 1564 step count: 399873 time: 21311.092 perplexity for hold out set: 4.757921218872
average_count is: 1565 step count: 400129 time: 21324.418 perplexity for hold out set: 4.757919788361
average_count is: 1566 step count: 400385 time: 21338.003 perplexity for hold out set: 4.757918357849
average_count is: 1567 step count: 400641 time: 21351.491 perplexity for hold out set: 4.757916927338
average_count is: 1568 step count: 400897 time: 21365.129 perplexity for hold out set: 4.757915496826
average_count is: 1569 step count: 401153 time: 21378.925 perplexity for hold out set: 4.757914543152
average_count is: 1570 step count: 401409 time: 21392.847 perplexity for hold out set: 4.757912635803
average_count is: 1571 step count: 401665 time: 21406.278 perplexity for hold out set: 4.757911682129
average_count is: 1572 step count: 401921 time: 21420.314 perplexity for hold out set: 4.757910251617
average_count is: 1573 step count: 402177 time: 21433.994 perplexity for hold out set: 4.757909297943
average_count is: 1574 step count: 402433 time: 21447.773 perplexity for hold out set: 4.757907390594
average_count is: 1575 step count: 402689 time: 21461.359 perplexity for hold out set: 4.757906436920
average_count is: 1576 step count: 402945 time: 21475.266 perplexity for hold out set: 4.757905006409
average_count is: 1577 step count: 403201 time: 21489.130 perplexity for hold out set: 4.757903575897
average_count is: 1578 step count: 403457 time: 21502.765 perplexity for hold out set: 4.757902145386
average_count is: 1579 step count: 403713 time: 21516.218 perplexity for hold out set: 4.757901191711
average_count is: 1580 step count: 403969 time: 21529.473 perplexity for hold out set: 4.757899761200
average_count is: 1581 step count: 404225 time: 21543.074 perplexity for hold out set: 4.757897853851
average_count is: 1582 step count: 404481 time: 21556.630 perplexity for hold out set: 4.757896900177
average_count is: 1583 step count: 404737 time: 21570.560 perplexity for hold out set: 4.757894992828
average_count is: 1584 step count: 404993 time: 21584.347 perplexity for hold out set: 4.757894039154
average_count is: 1585 step count: 405249 time: 21598.198 perplexity for hold out set: 4.757893085480
average_count is: 1586 step count: 405505 time: 21611.838 perplexity for hold out set: 4.757891654968
average_count is: 1587 step count: 405761 time: 21625.687 perplexity for hold out set: 4.757890224457
average_count is: 1588 step count: 406017 time: 21639.371 perplexity for hold out set: 4.757888793945
average_count is: 1589 step count: 406273 time: 21652.884 perplexity for hold out set: 4.757887363434
average_count is: 1590 step count: 406529 time: 21666.886 perplexity for hold out set: 4.757885932922
average_count is: 1591 step count: 406785 time: 21680.505 perplexity for hold out set: 4.757884979248
average_count is: 1592 step count: 407041 time: 21694.052 perplexity for hold out set: 4.757884025574
average_count is: 1593 step count: 407297 time: 21707.592 perplexity for hold out set: 4.757882595062
average_count is: 1594 step count: 407553 time: 21721.588 perplexity for hold out set: 4.757881641388
average_count is: 1595 step count: 407809 time: 21735.477 perplexity for hold out set: 4.757879734039
average_count is: 1596 step count: 408065 time: 21749.450 perplexity for hold out set: 4.757878780365
average_count is: 1597 step count: 408321 time: 21763.190 perplexity for hold out set: 4.757877349854
average_count is: 1598 step count: 408577 time: 21776.806 perplexity for hold out set: 4.757875919342
average_count is: 1599 step count: 408833 time: 21790.239 perplexity for hold out set: 4.757874488831
average_count is: 1600 step count: 409089 time: 21803.877 perplexity for hold out set: 4.757873535156
average_count is: 1601 step count: 409345 time: 21817.550 perplexity for hold out set: 4.757872104645
average_count is: 1602 step count: 409601 time: 21831.334 perplexity for hold out set: 4.757870674133
average_count is: 1603 step count: 409857 time: 21845.220 perplexity for hold out set: 4.757869720459
average_count is: 1604 step count: 410113 time: 21859.183 perplexity for hold out set: 4.757868289948
average_count is: 1605 step count: 410369 time: 21872.944 perplexity for hold out set: 4.757866859436
average_count is: 1606 step count: 410625 time: 21886.858 perplexity for hold out set: 4.757865428925
average_count is: 1607 step count: 410881 time: 21900.815 perplexity for hold out set: 4.757864475250
average_count is: 1608 step count: 411137 time: 21914.733 perplexity for hold out set: 4.757862567902
average_count is: 1609 step count: 411393 time: 21927.610 perplexity for hold out set: 4.757861614227
average_count is: 1610 step count: 411649 time: 21941.489 perplexity for hold out set: 4.757860183716
average_count is: 1611 step count: 411905 time: 21955.208 perplexity for hold out set: 4.757859230042
average_count is: 1612 step count: 412161 time: 21969.136 perplexity for hold out set: 4.757857799530
average_count is: 1613 step count: 412417 time: 21982.644 perplexity for hold out set: 4.757856369019
average_count is: 1614 step count: 412673 time: 21996.169 perplexity for hold out set: 4.757854938507
average_count is: 1615 step count: 412929 time: 22009.964 perplexity for hold out set: 4.757853507996
average_count is: 1616 step count: 413185 time: 22023.162 perplexity for hold out set: 4.757852077484
average_count is: 1617 step count: 413441 time: 22036.422 perplexity for hold out set: 4.757851123810
average_count is: 1618 step count: 413697 time: 22050.330 perplexity for hold out set: 4.757849693298
average_count is: 1619 step count: 413953 time: 22063.761 perplexity for hold out set: 4.757848739624
average_count is: 1620 step count: 414209 time: 22077.594 perplexity for hold out set: 4.757847309113
average_count is: 1621 step count: 414465 time: 22091.175 perplexity for hold out set: 4.757846355438
average_count is: 1622 step count: 414721 time: 22104.774 perplexity for hold out set: 4.757844924927
average_count is: 1623 step count: 414977 time: 22118.373 perplexity for hold out set: 4.757843971252
average_count is: 1624 step count: 415233 time: 22132.179 perplexity for hold out set: 4.757842540741
average_count is: 1625 step count: 415489 time: 22145.799 perplexity for hold out set: 4.757841110229
average_count is: 1626 step count: 415745 time: 22159.681 perplexity for hold out set: 4.757839679718
average_count is: 1627 step count: 416001 time: 22173.269 perplexity for hold out set: 4.757838726044
average_count is: 1628 step count: 416257 time: 22187.016 perplexity for hold out set: 4.757837295532
average_count is: 1629 step count: 416513 time: 22200.736 perplexity for hold out set: 4.757835865021
average_count is: 1630 step count: 416769 time: 22214.478 perplexity for hold out set: 4.757834911346
average_count is: 1631 step count: 417025 time: 22228.424 perplexity for hold out set: 4.757833957672
average_count is: 1632 step count: 417281 time: 22241.986 perplexity for hold out set: 4.757832527161
average_count is: 1633 step count: 417537 time: 22255.530 perplexity for hold out set: 4.757831096649
average_count is: 1634 step count: 417793 time: 22269.387 perplexity for hold out set: 4.757830142975
average_count is: 1635 step count: 418049 time: 22282.951 perplexity for hold out set: 4.757828235626
average_count is: 1636 step count: 418305 time: 22296.562 perplexity for hold out set: 4.757827281952
average_count is: 1637 step count: 418561 time: 22309.891 perplexity for hold out set: 4.757826328278
average_count is: 1638 step count: 418817 time: 22323.765 perplexity for hold out set: 4.757824420929
average_count is: 1639 step count: 419073 time: 22337.416 perplexity for hold out set: 4.757823467255
average_count is: 1640 step count: 419329 time: 22351.059 perplexity for hold out set: 4.757822513580
average_count is: 1641 step count: 419585 time: 22364.436 perplexity for hold out set: 4.757821083069
average_count is: 1642 step count: 419841 time: 22378.258 perplexity for hold out set: 4.757819652557
average_count is: 1643 step count: 420097 time: 22391.830 perplexity for hold out set: 4.757818698883
average_count is: 1644 step count: 420353 time: 22405.968 perplexity for hold out set: 4.757817745209
average_count is: 1645 step count: 420609 time: 22419.715 perplexity for hold out set: 4.757816314697
average_count is: 1646 step count: 420865 time: 22433.638 perplexity for hold out set: 4.757814884186
average_count is: 1647 step count: 421121 time: 22447.612 perplexity for hold out set: 4.757813930511
average_count is: 1648 step count: 421377 time: 22461.373 perplexity for hold out set: 4.757812500000
average_count is: 1649 step count: 421633 time: 22475.321 perplexity for hold out set: 4.757811069489
average_count is: 1650 step count: 421889 time: 22489.236 perplexity for hold out set: 4.757810115814
average_count is: 1651 step count: 422145 time: 22503.150 perplexity for hold out set: 4.757809162140
average_count is: 1652 step count: 422401 time: 22516.327 perplexity for hold out set: 4.757807731628
average_count is: 1653 step count: 422657 time: 22530.243 perplexity for hold out set: 4.757806301117
average_count is: 1654 step count: 422913 time: 22543.954 perplexity for hold out set: 4.757805347443
average_count is: 1655 step count: 423169 time: 22557.636 perplexity for hold out set: 4.757804393768
average_count is: 1656 step count: 423425 time: 22570.617 perplexity for hold out set: 4.757802963257
average_count is: 1657 step count: 423681 time: 22584.117 perplexity for hold out set: 4.757801532745
average_count is: 1658 step count: 423937 time: 22597.868 perplexity for hold out set: 4.757800102234
average_count is: 1659 step count: 424193 time: 22611.522 perplexity for hold out set: 4.757798671722
average_count is: 1660 step count: 424449 time: 22624.486 perplexity for hold out set: 4.757797718048
average_count is: 1661 step count: 424705 time: 22638.000 perplexity for hold out set: 4.757796764374
average_count is: 1662 step count: 424961 time: 22651.483 perplexity for hold out set: 4.757795810699
average_count is: 1663 step count: 425217 time: 22664.963 perplexity for hold out set: 4.757794857025
average_count is: 1664 step count: 425473 time: 22678.757 perplexity for hold out set: 4.757792949677
average_count is: 1665 step count: 425729 time: 22692.412 perplexity for hold out set: 4.757791996002
average_count is: 1666 step count: 425985 time: 22706.425 perplexity for hold out set: 4.757790565491
average_count is: 1667 step count: 426241 time: 22719.920 perplexity for hold out set: 4.757789611816
average_count is: 1668 step count: 426497 time: 22733.693 perplexity for hold out set: 4.757788181305
average_count is: 1669 step count: 426753 time: 22746.930 perplexity for hold out set: 4.757787227631
average_count is: 1670 step count: 427009 time: 22760.173 perplexity for hold out set: 4.757785797119
average_count is: 1671 step count: 427265 time: 22773.719 perplexity for hold out set: 4.757784366608
average_count is: 1672 step count: 427521 time: 22787.112 perplexity for hold out set: 4.757783889771
average_count is: 1673 step count: 427777 time: 22801.091 perplexity for hold out set: 4.757783412933
average_count is: 1674 step count: 428033 time: 22814.694 perplexity for hold out set: 4.757781505585
average_count is: 1675 step count: 428289 time: 22827.981 perplexity for hold out set: 4.757780551910
average_count is: 1676 step count: 428545 time: 22841.568 perplexity for hold out set: 4.757779121399
average_count is: 1677 step count: 428801 time: 22855.571 perplexity for hold out set: 4.757777690887
average_count is: 1678 step count: 429057 time: 22869.523 perplexity for hold out set: 4.757776737213
average_count is: 1679 step count: 429313 time: 22883.291 perplexity for hold out set: 4.757775306702
average_count is: 1680 step count: 429569 time: 22896.569 perplexity for hold out set: 4.757773876190
average_count is: 1681 step count: 429825 time: 22910.722 perplexity for hold out set: 4.757772922516
average_count is: 1682 step count: 430081 time: 22924.599 perplexity for hold out set: 4.757771968842
average_count is: 1683 step count: 430337 time: 22937.917 perplexity for hold out set: 4.757770538330
average_count is: 1684 step count: 430593 time: 22951.655 perplexity for hold out set: 4.757769584656
average_count is: 1685 step count: 430849 time: 22965.415 perplexity for hold out set: 4.757768154144
average_count is: 1686 step count: 431105 time: 22979.225 perplexity for hold out set: 4.757767200470
average_count is: 1687 step count: 431361 time: 22992.731 perplexity for hold out set: 4.757765769958
average_count is: 1688 step count: 431617 time: 23006.388 perplexity for hold out set: 4.757764816284
average_count is: 1689 step count: 431873 time: 23019.647 perplexity for hold out set: 4.757763385773
average_count is: 1690 step count: 432129 time: 23033.511 perplexity for hold out set: 4.757762432098
average_count is: 1691 step count: 432385 time: 23046.881 perplexity for hold out set: 4.757761001587
average_count is: 1692 step count: 432641 time: 23060.485 perplexity for hold out set: 4.757760047913
average_count is: 1693 step count: 432897 time: 23074.528 perplexity for hold out set: 4.757759571075
average_count is: 1694 step count: 433153 time: 23088.379 perplexity for hold out set: 4.757757663727
average_count is: 1695 step count: 433409 time: 23102.295 perplexity for hold out set: 4.757756710052
average_count is: 1696 step count: 433665 time: 23115.872 perplexity for hold out set: 4.757755279541
average_count is: 1697 step count: 433921 time: 23129.723 perplexity for hold out set: 4.757754802704
average_count is: 1698 step count: 434177 time: 23143.649 perplexity for hold out set: 4.757753372192
average_count is: 1699 step count: 434433 time: 23157.481 perplexity for hold out set: 4.757752418518
average_count is: 1700 step count: 434689 time: 23171.333 perplexity for hold out set: 4.757750988007
average_count is: 1701 step count: 434945 time: 23184.808 perplexity for hold out set: 4.757750034332
average_count is: 1702 step count: 435201 time: 23198.757 perplexity for hold out set: 4.757749080658
average_count is: 1703 step count: 435457 time: 23212.625 perplexity for hold out set: 4.757747650146
average_count is: 1704 step count: 435713 time: 23225.986 perplexity for hold out set: 4.757746696472
average_count is: 1705 step count: 435969 time: 23239.063 perplexity for hold out set: 4.757745265961
average_count is: 1706 step count: 436225 time: 23252.911 perplexity for hold out set: 4.757744312286
average_count is: 1707 step count: 436481 time: 23266.600 perplexity for hold out set: 4.757742881775
average_count is: 1708 step count: 436737 time: 23280.098 perplexity for hold out set: 4.757742404938
average_count is: 1709 step count: 436993 time: 23293.973 perplexity for hold out set: 4.757740974426
average_count is: 1710 step count: 437249 time: 23307.615 perplexity for hold out set: 4.757739543915
average_count is: 1711 step count: 437505 time: 23321.105 perplexity for hold out set: 4.757738590240
average_count is: 1712 step count: 437761 time: 23334.645 perplexity for hold out set: 4.757737636566
average_count is: 1713 step count: 438017 time: 23348.180 perplexity for hold out set: 4.757736206055
average_count is: 1714 step count: 438273 time: 23361.558 perplexity for hold out set: 4.757735252380
average_count is: 1715 step count: 438529 time: 23374.952 perplexity for hold out set: 4.757734298706
average_count is: 1716 step count: 438785 time: 23388.593 perplexity for hold out set: 4.757733345032
average_count is: 1717 step count: 439041 time: 23402.100 perplexity for hold out set: 4.757731914520
average_count is: 1718 step count: 439297 time: 23415.291 perplexity for hold out set: 4.757730960846
average_count is: 1719 step count: 439553 time: 23428.567 perplexity for hold out set: 4.757730007172
average_count is: 1720 step count: 439809 time: 23442.395 perplexity for hold out set: 4.757728576660
average_count is: 1721 step count: 440065 time: 23455.625 perplexity for hold out set: 4.757727622986
average_count is: 1722 step count: 440321 time: 23469.098 perplexity for hold out set: 4.757726192474
average_count is: 1723 step count: 440577 time: 23482.195 perplexity for hold out set: 4.757725238800
average_count is: 1724 step count: 440833 time: 23496.001 perplexity for hold out set: 4.757723808289
average_count is: 1725 step count: 441089 time: 23510.112 perplexity for hold out set: 4.757722854614
average_count is: 1726 step count: 441345 time: 23524.038 perplexity for hold out set: 4.757722377777
average_count is: 1727 step count: 441601 time: 23538.051 perplexity for hold out set: 4.757720470428
average_count is: 1728 step count: 441857 time: 23551.868 perplexity for hold out set: 4.757719993591
average_count is: 1729 step count: 442113 time: 23565.367 perplexity for hold out set: 4.757718086243
average_count is: 1730 step count: 442369 time: 23578.589 perplexity for hold out set: 4.757717609406
average_count is: 1731 step count: 442625 time: 23591.941 perplexity for hold out set: 4.757716178894
average_count is: 1732 step count: 442881 time: 23605.922 perplexity for hold out set: 4.757715225220
average_count is: 1733 step count: 443137 time: 23619.732 perplexity for hold out set: 4.757714271545
average_count is: 1734 step count: 443393 time: 23633.534 perplexity for hold out set: 4.757713317871
average_count is: 1735 step count: 443649 time: 23646.747 perplexity for hold out set: 4.757711887360
average_count is: 1736 step count: 443905 time: 23660.020 perplexity for hold out set: 4.757710933685
average_count is: 1737 step count: 444161 time: 23673.288 perplexity for hold out set: 4.757709980011
average_count is: 1738 step count: 444417 time: 23686.611 perplexity for hold out set: 4.757708549500
average_count is: 1739 step count: 444673 time: 23699.997 perplexity for hold out set: 4.757708072662
average_count is: 1740 step count: 444929 time: 23713.888 perplexity for hold out set: 4.757706165314
average_count is: 1741 step count: 445185 time: 23727.628 perplexity for hold out set: 4.757705688477
average_count is: 1742 step count: 445441 time: 23741.557 perplexity for hold out set: 4.757704734802
average_count is: 1743 step count: 445697 time: 23755.285 perplexity for hold out set: 4.757703304291
average_count is: 1744 step count: 445953 time: 23768.794 perplexity for hold out set: 4.757702350616
average_count is: 1745 step count: 446209 time: 23782.130 perplexity for hold out set: 4.757700920105
average_count is: 1746 step count: 446465 time: 23795.760 perplexity for hold out set: 4.757699966431
average_count is: 1747 step count: 446721 time: 23809.522 perplexity for hold out set: 4.757698535919
average_count is: 1748 step count: 446977 time: 23822.901 perplexity for hold out set: 4.757697582245
average_count is: 1749 step count: 447233 time: 23836.719 perplexity for hold out set: 4.757696628571
average_count is: 1750 step count: 447489 time: 23850.497 perplexity for hold out set: 4.757695198059
average_count is: 1751 step count: 447745 time: 23864.087 perplexity for hold out set: 4.757694244385
average_count is: 1752 step count: 448001 time: 23878.025 perplexity for hold out set: 4.757693290710
average_count is: 1753 step count: 448257 time: 23892.091 perplexity for hold out set: 4.757692337036
average_count is: 1754 step count: 448513 time: 23905.937 perplexity for hold out set: 4.757690906525
average_count is: 1755 step count: 448769 time: 23919.746 perplexity for hold out set: 4.757690429688
average_count is: 1756 step count: 449025 time: 23933.400 perplexity for hold out set: 4.757688999176
average_count is: 1757 step count: 449281 time: 23946.818 perplexity for hold out set: 4.757688045502
average_count is: 1758 step count: 449537 time: 23960.772 perplexity for hold out set: 4.757687091827
average_count is: 1759 step count: 449793 time: 23974.767 perplexity for hold out set: 4.757685661316
average_count is: 1760 step count: 450049 time: 23987.550 perplexity for hold out set: 4.757684707642
average_count is: 1761 step count: 450305 time: 24001.458 perplexity for hold out set: 4.757684230804
average_count is: 1762 step count: 450561 time: 24014.768 perplexity for hold out set: 4.757682800293
average_count is: 1763 step count: 450817 time: 24028.314 perplexity for hold out set: 4.757681846619
average_count is: 1764 step count: 451073 time: 24042.143 perplexity for hold out set: 4.757680892944
average_count is: 1765 step count: 451329 time: 24055.903 perplexity for hold out set: 4.757679462433
average_count is: 1766 step count: 451585 time: 24069.128 perplexity for hold out set: 4.757678031921
average_count is: 1767 step count: 451841 time: 24083.041 perplexity for hold out set: 4.757677078247
average_count is: 1768 step count: 452097 time: 24096.927 perplexity for hold out set: 4.757676124573
average_count is: 1769 step count: 452353 time: 24111.052 perplexity for hold out set: 4.757675647736
average_count is: 1770 step count: 452609 time: 24124.652 perplexity for hold out set: 4.757674694061
average_count is: 1771 step count: 452865 time: 24138.139 perplexity for hold out set: 4.757673263550
average_count is: 1772 step count: 453121 time: 24151.875 perplexity for hold out set: 4.757672309875
average_count is: 1773 step count: 453377 time: 24165.424 perplexity for hold out set: 4.757670879364
average_count is: 1774 step count: 453633 time: 24178.828 perplexity for hold out set: 4.757669925690
average_count is: 1775 step count: 453889 time: 24192.564 perplexity for hold out set: 4.757668972015
average_count is: 1776 step count: 454145 time: 24205.966 perplexity for hold out set: 4.757668018341
average_count is: 1777 step count: 454401 time: 24219.625 perplexity for hold out set: 4.757666587830
average_count is: 1778 step count: 454657 time: 24233.346 perplexity for hold out set: 4.757665634155
average_count is: 1779 step count: 454913 time: 24246.518 perplexity for hold out set: 4.757664680481
average_count is: 1780 step count: 455169 time: 24260.475 perplexity for hold out set: 4.757663726807
average_count is: 1781 step count: 455425 time: 24273.961 perplexity for hold out set: 4.757662773132
average_count is: 1782 step count: 455681 time: 24287.853 perplexity for hold out set: 4.757661819458
average_count is: 1783 step count: 455937 time: 24301.449 perplexity for hold out set: 4.757660388947
average_count is: 1784 step count: 456193 time: 24315.062 perplexity for hold out set: 4.757659435272
average_count is: 1785 step count: 456449 time: 24328.863 perplexity for hold out set: 4.757658958435
average_count is: 1786 step count: 456705 time: 24343.077 perplexity for hold out set: 4.757657051086
average_count is: 1787 step count: 456961 time: 24357.033 perplexity for hold out set: 4.757656574249
average_count is: 1788 step count: 457217 time: 24370.677 perplexity for hold out set: 4.757655620575
average_count is: 1789 step count: 457473 time: 24384.338 perplexity for hold out set: 4.757654190063
average_count is: 1790 step count: 457729 time: 24397.519 perplexity for hold out set: 4.757653236389
average_count is: 1791 step count: 457985 time: 24411.459 perplexity for hold out set: 4.757652282715
average_count is: 1792 step count: 458241 time: 24424.700 perplexity for hold out set: 4.757651329041
average_count is: 1793 step count: 458497 time: 24438.151 perplexity for hold out set: 4.757650375366
timer                                    total (s)    ticks  per tick (us)
  load network graph                        3.000        1    3000469.734
  initialize DKV store                      0.776        1     776055.486
  populate pi                               0.001        1       1417.394
  iteration                             24451.207   458751      53299.519
    deploy minibatch                      942.763   458752       2055.062
      scatter subgraph                    103.965   458752        226.626
        marshall edge count                37.119   458752         80.915
        scatterv edges                      6.094   458752         13.285
        marshall edges                     44.148   458752         96.237
        scatterv edges                     15.337   458752         33.432
        unmarshall edges                    0.033   458752          0.074
      sample_mini_batch                   352.731   458752        768.893
      nodes_in_mini_batch                 160.043   458752        348.867
    broadcast theta/beta                 1205.250   458751       2627.243
    update_phi_pi                       15720.203   458751      34267.399
      create minibatch slice chunks         0.169   458752          0.369
      reorder minibatch overlap     <unused>
      sample_neighbor_nodes                42.938   458752         93.599
      resample_neighbor_nodes       <unused>
      load minibatch pi                     1.326   917503          1.446
      load neighbor pi                      0.586   917503          0.639
      update_phi                           87.084   917502         94.915
      barrier after update phi          12918.863   458751      28160.948
      update_pi                     <unused>
      store minibatch pi            <unused>
      barrier after update pi            1721.926   458751       3753.510
    update_beta_theta                    7129.216   458751      15540.493
      zero beta grads                     131.281   458751        286.171
      rank minibatch nodes                  9.506   458751         20.723
      load pi update_beta                 458.803   458751       1000.114
      beta calc grads                     735.428   458751       1603.110
      beta sum grads                      203.297   458751        443.155
      beta reduce(+) grads               4314.740   458751       9405.409
      update theta                        927.698   458751       2022.227
  perplexity                              375.673     1792     209639.223
      load perplexity pi                  296.601     1792     165514.466
      calc edge likelihood                 74.447     1792      41544.305
      purge perplexity pi                   0.006     1792          3.657
      reduce/plus perplexity                4.550     1792       2539.520
average_count is: 1794 step count: 458753 time: 24451.646 perplexity for hold out set: 4.757649421692
average_count is: 1795 step count: 459009 time: 24465.274 perplexity for hold out set: 4.757647991180
average_count is: 1796 step count: 459265 time: 24479.122 perplexity for hold out set: 4.757647514343
average_count is: 1797 step count: 459521 time: 24492.976 perplexity for hold out set: 4.757646083832
average_count is: 1798 step count: 459777 time: 24506.525 perplexity for hold out set: 4.757645130157
average_count is: 1799 step count: 460033 time: 24520.446 perplexity for hold out set: 4.757644653320
average_count is: 1800 step count: 460289 time: 24533.948 perplexity for hold out set: 4.757642745972
average_count is: 1801 step count: 460545 time: 24547.816 perplexity for hold out set: 4.757642269135
average_count is: 1802 step count: 460801 time: 24561.437 perplexity for hold out set: 4.757641315460
average_count is: 1803 step count: 461057 time: 24575.064 perplexity for hold out set: 4.757639884949
average_count is: 1804 step count: 461313 time: 24588.976 perplexity for hold out set: 4.757638931274
average_count is: 1805 step count: 461569 time: 24602.735 perplexity for hold out set: 4.757637977600
average_count is: 1806 step count: 461825 time: 24616.488 perplexity for hold out set: 4.757637023926
average_count is: 1807 step count: 462081 time: 24630.272 perplexity for hold out set: 4.757636070251
average_count is: 1808 step count: 462337 time: 24642.787 perplexity for hold out set: 4.757635116577
average_count is: 1809 step count: 462593 time: 24656.573 perplexity for hold out set: 4.757634162903
average_count is: 1810 step count: 462849 time: 24670.233 perplexity for hold out set: 4.757633209229
average_count is: 1811 step count: 463105 time: 24682.801 perplexity for hold out set: 4.757631778717
average_count is: 1812 step count: 463361 time: 24696.740 perplexity for hold out set: 4.757630825043
average_count is: 1813 step count: 463617 time: 24710.695 perplexity for hold out set: 4.757629871368
average_count is: 1814 step count: 463873 time: 24724.504 perplexity for hold out set: 4.757628917694
average_count is: 1815 step count: 464129 time: 24738.482 perplexity for hold out set: 4.757627964020
average_count is: 1816 step count: 464385 time: 24752.148 perplexity for hold out set: 4.757627010345
average_count is: 1817 step count: 464641 time: 24765.961 perplexity for hold out set: 4.757625579834
average_count is: 1818 step count: 464897 time: 24779.868 perplexity for hold out set: 4.757624626160
average_count is: 1819 step count: 465153 time: 24793.694 perplexity for hold out set: 4.757623672485
average_count is: 1820 step count: 465409 time: 24807.488 perplexity for hold out set: 4.757622241974
average_count is: 1821 step count: 465665 time: 24821.373 perplexity for hold out set: 4.757621765137
average_count is: 1822 step count: 465921 time: 24834.959 perplexity for hold out set: 4.757620811462
average_count is: 1823 step count: 466177 time: 24848.459 perplexity for hold out set: 4.757619857788
average_count is: 1824 step count: 466433 time: 24862.191 perplexity for hold out set: 4.757618427277
average_count is: 1825 step count: 466689 time: 24875.990 perplexity for hold out set: 4.757617950439
average_count is: 1826 step count: 466945 time: 24889.475 perplexity for hold out set: 4.757616996765
average_count is: 1827 step count: 467201 time: 24902.891 perplexity for hold out set: 4.757616043091
average_count is: 1828 step count: 467457 time: 24916.706 perplexity for hold out set: 4.757614612579
average_count is: 1829 step count: 467713 time: 24930.601 perplexity for hold out set: 4.757614135742
average_count is: 1830 step count: 467969 time: 24943.995 perplexity for hold out set: 4.757612705231
average_count is: 1831 step count: 468225 time: 24957.613 perplexity for hold out set: 4.757611751556
average_count is: 1832 step count: 468481 time: 24970.948 perplexity for hold out set: 4.757610321045
average_count is: 1833 step count: 468737 time: 24983.946 perplexity for hold out set: 4.757609844208
average_count is: 1834 step count: 468993 time: 24997.121 perplexity for hold out set: 4.757608890533
average_count is: 1835 step count: 469249 time: 25010.728 perplexity for hold out set: 4.757607936859
average_count is: 1836 step count: 469505 time: 25024.738 perplexity for hold out set: 4.757606983185
average_count is: 1837 step count: 469761 time: 25038.158 perplexity for hold out set: 4.757606029510
average_count is: 1838 step count: 470017 time: 25051.910 perplexity for hold out set: 4.757605075836
average_count is: 1839 step count: 470273 time: 25065.942 perplexity for hold out set: 4.757604122162
average_count is: 1840 step count: 470529 time: 25079.845 perplexity for hold out set: 4.757603168488
average_count is: 1841 step count: 470785 time: 25093.392 perplexity for hold out set: 4.757601737976
average_count is: 1842 step count: 471041 time: 25107.265 perplexity for hold out set: 4.757601261139
average_count is: 1843 step count: 471297 time: 25120.600 perplexity for hold out set: 4.757600307465
average_count is: 1844 step count: 471553 time: 25133.487 perplexity for hold out set: 4.757599353790
average_count is: 1845 step count: 471809 time: 25147.230 perplexity for hold out set: 4.757597923279
average_count is: 1846 step count: 472065 time: 25161.237 perplexity for hold out set: 4.757596969604
average_count is: 1847 step count: 472321 time: 25174.953 perplexity for hold out set: 4.757596015930
average_count is: 1848 step count: 472577 time: 25188.798 perplexity for hold out set: 4.757595062256
average_count is: 1849 step count: 472833 time: 25202.105 perplexity for hold out set: 4.757593631744
average_count is: 1850 step count: 473089 time: 25215.837 perplexity for hold out set: 4.757593154907
average_count is: 1851 step count: 473345 time: 25229.398 perplexity for hold out set: 4.757592201233
average_count is: 1852 step count: 473601 time: 25243.039 perplexity for hold out set: 4.757591724396
average_count is: 1853 step count: 473857 time: 25256.704 perplexity for hold out set: 4.757589817047
average_count is: 1854 step count: 474113 time: 25270.224 perplexity for hold out set: 4.757589340210
average_count is: 1855 step count: 474369 time: 25284.207 perplexity for hold out set: 4.757588386536
average_count is: 1856 step count: 474625 time: 25297.835 perplexity for hold out set: 4.757586956024
average_count is: 1857 step count: 474881 time: 25311.321 perplexity for hold out set: 4.757586002350
average_count is: 1858 step count: 475137 time: 25325.267 perplexity for hold out set: 4.757585048676
average_count is: 1859 step count: 475393 time: 25338.841 perplexity for hold out set: 4.757584571838
average_count is: 1860 step count: 475649 time: 25352.193 perplexity for hold out set: 4.757583618164
average_count is: 1861 step count: 475905 time: 25365.901 perplexity for hold out set: 4.757582664490
average_count is: 1862 step count: 476161 time: 25379.379 perplexity for hold out set: 4.757581710815
average_count is: 1863 step count: 476417 time: 25393.127 perplexity for hold out set: 4.757580757141
average_count is: 1864 step count: 476673 time: 25406.143 perplexity for hold out set: 4.757579803467
average_count is: 1865 step count: 476929 time: 25420.114 perplexity for hold out set: 4.757578849792
average_count is: 1866 step count: 477185 time: 25434.022 perplexity for hold out set: 4.757577896118
average_count is: 1867 step count: 477441 time: 25447.909 perplexity for hold out set: 4.757576942444
average_count is: 1868 step count: 477697 time: 25461.799 perplexity for hold out set: 4.757575988770
average_count is: 1869 step count: 477953 time: 25475.422 perplexity for hold out set: 4.757575035095
average_count is: 1870 step count: 478209 time: 25488.985 perplexity for hold out set: 4.757574081421
average_count is: 1871 step count: 478465 time: 25502.959 perplexity for hold out set: 4.757573127747
average_count is: 1872 step count: 478721 time: 25516.947 perplexity for hold out set: 4.757571697235
average_count is: 1873 step count: 478977 time: 25530.713 perplexity for hold out set: 4.757570743561
average_count is: 1874 step count: 479233 time: 25544.050 perplexity for hold out set: 4.757570266724
average_count is: 1875 step count: 479489 time: 25558.033 perplexity for hold out set: 4.757569313049
average_count is: 1876 step count: 479745 time: 25571.868 perplexity for hold out set: 4.757567882538
average_count is: 1877 step count: 480001 time: 25585.641 perplexity for hold out set: 4.757567405701
average_count is: 1878 step count: 480257 time: 25599.496 perplexity for hold out set: 4.757565975189
average_count is: 1879 step count: 480513 time: 25613.590 perplexity for hold out set: 4.757565498352
average_count is: 1880 step count: 480769 time: 25626.507 perplexity for hold out set: 4.757564067841
average_count is: 1881 step count: 481025 time: 25640.309 perplexity for hold out set: 4.757563591003
average_count is: 1882 step count: 481281 time: 25653.057 perplexity for hold out set: 4.757562160492
average_count is: 1883 step count: 481537 time: 25666.362 perplexity for hold out set: 4.757561206818
average_count is: 1884 step count: 481793 time: 25680.151 perplexity for hold out set: 4.757560729980
average_count is: 1885 step count: 482049 time: 25694.060 perplexity for hold out set: 4.757559776306
average_count is: 1886 step count: 482305 time: 25707.981 perplexity for hold out set: 4.757558345795
average_count is: 1887 step count: 482561 time: 25721.795 perplexity for hold out set: 4.757557868958
average_count is: 1888 step count: 482817 time: 25735.318 perplexity for hold out set: 4.757556438446
average_count is: 1889 step count: 483073 time: 25748.917 perplexity for hold out set: 4.757555961609
average_count is: 1890 step count: 483329 time: 25762.803 perplexity for hold out set: 4.757555007935
average_count is: 1891 step count: 483585 time: 25776.659 perplexity for hold out set: 4.757554054260
average_count is: 1892 step count: 483841 time: 25790.422 perplexity for hold out set: 4.757553100586
average_count is: 1893 step count: 484097 time: 25804.050 perplexity for hold out set: 4.757551670074
average_count is: 1894 step count: 484353 time: 25817.445 perplexity for hold out set: 4.757551193237
average_count is: 1895 step count: 484609 time: 25830.727 perplexity for hold out set: 4.757550716400
average_count is: 1896 step count: 484865 time: 25844.619 perplexity for hold out set: 4.757549285889
average_count is: 1897 step count: 485121 time: 25858.326 perplexity for hold out set: 4.757548809052
average_count is: 1898 step count: 485377 time: 25872.090 perplexity for hold out set: 4.757547855377
average_count is: 1899 step count: 485633 time: 25885.961 perplexity for hold out set: 4.757546901703
average_count is: 1900 step count: 485889 time: 25899.467 perplexity for hold out set: 4.757546424866
average_count is: 1901 step count: 486145 time: 25913.511 perplexity for hold out set: 4.757545471191
average_count is: 1902 step count: 486401 time: 25927.496 perplexity for hold out set: 4.757544040680
average_count is: 1903 step count: 486657 time: 25941.471 perplexity for hold out set: 4.757543087006
average_count is: 1904 step count: 486913 time: 25955.374 perplexity for hold out set: 4.757542610168
average_count is: 1905 step count: 487169 time: 25969.500 perplexity for hold out set: 4.757541656494
average_count is: 1906 step count: 487425 time: 25983.486 perplexity for hold out set: 4.757540702820
average_count is: 1907 step count: 487681 time: 25997.492 perplexity for hold out set: 4.757539272308
average_count is: 1908 step count: 487937 time: 26011.281 perplexity for hold out set: 4.757538318634
average_count is: 1909 step count: 488193 time: 26025.135 perplexity for hold out set: 4.757537841797
average_count is: 1910 step count: 488449 time: 26038.693 perplexity for hold out set: 4.757536411285
average_count is: 1911 step count: 488705 time: 26051.790 perplexity for hold out set: 4.757535934448
average_count is: 1912 step count: 488961 time: 26065.228 perplexity for hold out set: 4.757535457611
average_count is: 1913 step count: 489217 time: 26078.717 perplexity for hold out set: 4.757534027100
average_count is: 1914 step count: 489473 time: 26092.477 perplexity for hold out set: 4.757533073425
average_count is: 1915 step count: 489729 time: 26106.294 perplexity for hold out set: 4.757532596588
average_count is: 1916 step count: 489985 time: 26120.078 perplexity for hold out set: 4.757531166077
average_count is: 1917 step count: 490241 time: 26133.317 perplexity for hold out set: 4.757530212402
average_count is: 1918 step count: 490497 time: 26147.510 perplexity for hold out set: 4.757529735565
average_count is: 1919 step count: 490753 time: 26161.328 perplexity for hold out set: 4.757528781891
average_count is: 1920 step count: 491009 time: 26175.209 perplexity for hold out set: 4.757527828217
average_count is: 1921 step count: 491265 time: 26188.929 perplexity for hold out set: 4.757526874542
average_count is: 1922 step count: 491521 time: 26202.832 perplexity for hold out set: 4.757525920868
average_count is: 1923 step count: 491777 time: 26216.543 perplexity for hold out set: 4.757524967194
average_count is: 1924 step count: 492033 time: 26230.203 perplexity for hold out set: 4.757524013519
average_count is: 1925 step count: 492289 time: 26243.927 perplexity for hold out set: 4.757523536682
average_count is: 1926 step count: 492545 time: 26257.619 perplexity for hold out set: 4.757522583008
average_count is: 1927 step count: 492801 time: 26271.483 perplexity for hold out set: 4.757521152496
average_count is: 1928 step count: 493057 time: 26285.287 perplexity for hold out set: 4.757520675659
average_count is: 1929 step count: 493313 time: 26299.067 perplexity for hold out set: 4.757519721985
average_count is: 1930 step count: 493569 time: 26312.781 perplexity for hold out set: 4.757519245148
average_count is: 1931 step count: 493825 time: 26326.506 perplexity for hold out set: 4.757517814636
average_count is: 1932 step count: 494081 time: 26340.342 perplexity for hold out set: 4.757517814636
average_count is: 1933 step count: 494082 time: 26340.617 perplexity for hold out set: 4.757516384125
*************** converged *******************
timer                                    total (s)    ticks  per tick (us)
  load network graph                        3.000        1    3000469.734
  initialize DKV store                      0.776        1     776055.486
  populate pi                               0.001        1       1417.394
  iteration                             26340.222   494081      53311.548
    deploy minibatch                     1016.103   494082       2056.548
      scatter subgraph                    112.386   494082        227.465
        marshall edge count                39.926   494082         80.810
        scatterv edges                      6.570   494082         13.298
        marshall edges                     47.891   494082         96.929
        scatterv edges                     16.630   494082         33.660
        unmarshall edges                    0.036   494082          0.074
      sample_mini_batch                   380.162   494082        769.431
      nodes_in_mini_batch                 172.314   494082        348.758
    broadcast theta/beta                 1297.980   494081       2627.061
    update_phi_pi                       16933.022   494081      34271.753
      create minibatch slice chunks         0.182   494082          0.369
      reorder minibatch overlap     <unused>
      sample_neighbor_nodes                46.856   494082         94.835
      resample_neighbor_nodes       <unused>
      load minibatch pi                     1.427   988163          1.445
      load neighbor pi                      0.631   988163          0.639
      update_phi                           94.367   988162         95.498
      barrier after update phi          13913.540   494081      28160.445
      update_pi                     <unused>
      store minibatch pi            <unused>
      barrier after update pi            1855.012   494081       3754.471
    update_beta_theta                    7681.951   494081      15547.959
      zero beta grads                     141.617   494081        286.628
      rank minibatch nodes                 10.242   494081         20.730
      load pi update_beta                 494.099   494081       1000.038
      beta calc grads                     792.424   494081       1603.834
      beta sum grads                      219.209   494081        443.671
      beta reduce(+) grads               4649.932   494081       9411.276
      update theta                        999.083   494081       2022.105
  perplexity                              405.002     1932     209628.372
      load perplexity pi                  319.758     1932     165506.604
      calc edge likelihood                 80.269     1932      41547.248
      purge perplexity pi                   0.007     1932          3.670
      reduce/plus perplexity                4.895     1932       2533.653
Linger a bit to allow gracious shutdown
timer                                    total (s)    ticks  per tick (us)
RDMA poll cq                        <unused>
RDMA read                                 814.597  2472339        329.485
     local read                     <unused>
     per-host read                        303.376  1983974        152.913
     post read                             14.315 47060307          0.304
     finish read                          509.171 8165709368          0.062
RDMA write                          <unused>
     local write                    <unused>
     per-host write                 <unused>
     post write                     <unused>
     finish write                   <unused>
RDMA barrier                        <unused>
posts 47060307 messages 0 msgs/post 0.000
Local read   0B -nanGB/s
Remote read  2537115270984B 2.901GB/s per-host loop 7.789GB/s
Local write  0B -nanGB/s
Remote write 0B -nanGB/s per-host loop -nanGB/s
                                           92.625   445194        208.056
                                           83.606  8301307         10.071
                                    <unused>
