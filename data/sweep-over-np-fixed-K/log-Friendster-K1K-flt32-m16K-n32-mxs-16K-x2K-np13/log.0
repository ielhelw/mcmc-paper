Command line: ./apps/main/main -f /var/scratch/rutger/mcmc/datasets/sparsehash/com-friendster-H0.01 -c preprocessed -K 1K -m 16K -n 32 -i 256 --mcmc.sampler.max-source 16K -x 2K --mcmc.c 0 --mcmc.a 1e-06 
start MCMC stochastical distributed 
Floating point precision: 32bit
Host node054 PID 1004
Build type Release
Graph implementation: adjacency list (google sparseset)
MPI_Init() done, rank 0 size 13
Set held_out_ratio to default 0.1
Create per-thread randoms
Random seed [42,43]
Random seed [42,44]
Random seed [42,45]
Random seed [42,46]
Random seed [42,47]
Random seed [42,48]
Random seed [42,49]
Random seed [42,50]
Random seed [42,51]
Random seed [42,52]
Random seed [42,53]
Random seed [42,54]
Random seed [42,55]
Random seed [42,56]
Random seed [42,57]
Random seed [42,58]
Random seed [42,59]
Random seed [42,60]
Random seed [42,61]
Random seed [42,62]
Random seed [42,63]
Random seed [42,64]
Random seed [42,65]
Random seed [42,66]
Random seed [42,67]
Random seed [42,68]
Random seed [42,69]
Random seed [42,70]
Random seed [42,71]
Random seed [42,72]
Random seed [42,73]
Random seed [42,74]
Random seed[0] 0x2a,0x2b
Handle input dataset from file /var/scratch/rutger/mcmc/datasets/sparsehash/com-friendster-H0.01/graph.gz
Node + edgeset read 0
For memory query file /proc/1004/statm
0.000 Memory usage: total 7604MB resident 7522MB 
Node + edgeset read 1048576
0.468 Memory usage: total 7637MB resident 7555MB 
Node + edgeset read 2097152
0.956 Memory usage: total 7672MB resident 7590MB 
Node + edgeset read 3145728
1.478 Memory usage: total 7708MB resident 7626MB 
Node + edgeset read 4194304
2.011 Memory usage: total 7745MB resident 7663MB 
Node + edgeset read 5242880
2.536 Memory usage: total 7784MB resident 7702MB 
Node + edgeset read 6291456
3.086 Memory usage: total 7824MB resident 7742MB 
Node + edgeset read 7340032
3.688 Memory usage: total 7868MB resident 7786MB 
Node + edgeset read 8388608
4.306 Memory usage: total 7914MB resident 7832MB 
Node + edgeset read 9437184
4.934 Memory usage: total 7964MB resident 7882MB 
Node + edgeset read 10485760
5.613 Memory usage: total 8020MB resident 7938MB 
Node + edgeset read 11534336
6.273 Memory usage: total 8078MB resident 7996MB 
Node + edgeset read 12582912
6.977 Memory usage: total 8144MB resident 8063MB 
Node + edgeset read 13631488
7.722 Memory usage: total 8214MB resident 8132MB 
Node + edgeset read 14680064
8.494 Memory usage: total 8290MB resident 8208MB 
Node + edgeset read 15728640
9.309 Memory usage: total 8374MB resident 8292MB 
Node + edgeset read 16777216
10.174 Memory usage: total 8464MB resident 8382MB 
Node + edgeset read 17825792
11.156 Memory usage: total 8575MB resident 8493MB 
Node + edgeset read 18874368
12.268 Memory usage: total 8698MB resident 8616MB 
Node + edgeset read 19922944
13.458 Memory usage: total 8836MB resident 8754MB 
Node + edgeset read 20971520
14.779 Memory usage: total 8998MB resident 8916MB 
Node + edgeset read 22020096
17.891 Memory usage: total 9380MB resident 9298MB 
Node + edgeset read 23068672
21.010 Memory usage: total 9776MB resident 9694MB 
Node + edgeset read 24117248
24.328 Memory usage: total 10186MB resident 10104MB 
Node + edgeset read 25165824
27.651 Memory usage: total 10609MB resident 10527MB 
Node + edgeset read 26214400
31.109 Memory usage: total 11048MB resident 10966MB 
Node + edgeset read 27262976
34.934 Memory usage: total 11495MB resident 11413MB 
Node + edgeset read 28311552
39.008 Memory usage: total 11952MB resident 11870MB 
Node + edgeset read 29360128
42.865 Memory usage: total 12417MB resident 12336MB 
Node + edgeset read 30408704
46.685 Memory usage: total 12886MB resident 12804MB 
Node + edgeset read 31457280
50.450 Memory usage: total 13357MB resident 13275MB 
Node + edgeset read 32505856
54.075 Memory usage: total 13820MB resident 13738MB 
Node + edgeset read 33554432
57.841 Memory usage: total 14285MB resident 14203MB 
Node + edgeset read 34603008
61.660 Memory usage: total 14751MB resident 14669MB 
Node + edgeset read 35651584
65.339 Memory usage: total 15212MB resident 15130MB 
Node + edgeset read 36700160
69.068 Memory usage: total 15668MB resident 15586MB 
Node + edgeset read 37748736
72.967 Memory usage: total 16117MB resident 16035MB 
Node + edgeset read 38797312
76.497 Memory usage: total 16567MB resident 16485MB 
Node + edgeset read 39845888
80.008 Memory usage: total 17017MB resident 16934MB 
Node + edgeset read 40894464
83.763 Memory usage: total 17487MB resident 17405MB 
Node + edgeset read 41943040
87.337 Memory usage: total 17947MB resident 17865MB 
Node + edgeset read 42991616
91.053 Memory usage: total 18410MB resident 18328MB 
Node + edgeset read 44040192
94.803 Memory usage: total 18890MB resident 18808MB 
Node + edgeset read 45088768
98.650 Memory usage: total 19379MB resident 19297MB 
Node + edgeset read 46137344
102.558 Memory usage: total 19867MB resident 19785MB 
Node + edgeset read 47185920
106.568 Memory usage: total 20354MB resident 20272MB 
Node + edgeset read 48234496
110.380 Memory usage: total 20828MB resident 20746MB 
Node + edgeset read 49283072
114.451 Memory usage: total 21276MB resident 21194MB 
Node + edgeset read 50331648
117.737 Memory usage: total 21625MB resident 21543MB 
Node + edgeset read 51380224
120.673 Memory usage: total 21964MB resident 21882MB 
Node + edgeset read 52428800
123.383 Memory usage: total 22295MB resident 22213MB 
Node + edgeset read 53477376
125.997 Memory usage: total 22621MB resident 22539MB 
Node + edgeset read 54525952
128.877 Memory usage: total 22955MB resident 22873MB 
Node + edgeset read 55574528
131.678 Memory usage: total 23288MB resident 23206MB 
Node + edgeset read 56623104
134.399 Memory usage: total 23620MB resident 23538MB 
Node + edgeset read 57671680
137.132 Memory usage: total 23952MB resident 23870MB 
Node + edgeset read 58720256
139.779 Memory usage: total 24270MB resident 24188MB 
Node + edgeset read 59768832
142.326 Memory usage: total 24579MB resident 24497MB 
Node + edgeset read 60817408
144.705 Memory usage: total 24863MB resident 24781MB 
Node + edgeset read 61865984
146.878 Memory usage: total 25114MB resident 25032MB 
Node + edgeset read 62914560
148.723 Memory usage: total 25337MB resident 25255MB 
Node + edgeset read 63963136
150.518 Memory usage: total 25551MB resident 25469MB 
Node + edgeset read 65011712
152.205 Memory usage: total 25752MB resident 25670MB 
153.149 Memory usage: total 25866MB resident 25784MB 
WARNING: Expect held-out size 180606716, get 18060671N 65608366 E 1806067135 link ratio 8.39161e-07 K 1024
minibatch size 16384 epsilon 1e-07 alpha 0.000976562 iterations 2048 convergence 1e-12
sampling strategy stratified-random-node
omp max threads 32
num_node_sample 32
a 1e-06 b 1024 c 0 eta (1,1)
minibatch size: 16384
Use D-KV store type rdma
minibatch size param 16384 max 43081 chunk 7561 #neighbors(total) 118503
perplexity nodes total 36121342 local 2778566 mine 514180 chunk 257090
phi pipeline depth 2
node054: RDMA OOB network: receive message from master, my rank is 0
RDMA D-KV store excludes the master node
MR/value addr=0x7ffdc9fe3000 size 7da7a210, lkey=0x50010c10, rkey=0x50010c10, flags=0xf, mr=0x50e0b2ab8
MR/cache addr=0x7ffcceaed000 size fb4f4420, lkey=0x50010d10, rkey=0x50010d10, flags=0xf, mr=0x50e0b2af0
MR/write addr=0x7ffe546ea000 size e0a81c, lkey=0x50010e10, rkey=0x50010e10, flags=0xf, mr=0x50e0b2b28
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
Create QP
Migrate this QP to INIT
My con_data for qp to host 1: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13470
  PSN number = 13978464
  max.atomic = 16
  LID = 0x112
Local LID[1] = 0x 70
My con_data for qp to host 2: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13471
  PSN number = 15871292
  max.atomic = 16
  LID = 0x112
Local LID[2] = 0x 70
My con_data for qp to host 3: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13472
  PSN number = 4871607
  max.atomic = 16
  LID = 0x112
Local LID[3] = 0x 70
My con_data for qp to host 4: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13473
  PSN number = 7069613
  max.atomic = 16
  LID = 0x112
Local LID[4] = 0x 70
My con_data for qp to host 5: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13474
  PSN number = 4320930
  max.atomic = 16
  LID = 0x112
Local LID[5] = 0x 70
My con_data for qp to host 6: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13475
  PSN number = 1111102
  max.atomic = 16
  LID = 0x112
Local LID[6] = 0x 70
My con_data for qp to host 7: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13476
  PSN number = 16631121
  max.atomic = 16
  LID = 0x112
Local LID[7] = 0x 70
My con_data for qp to host 8: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13477
  PSN number = 1271950
  max.atomic = 16
  LID = 0x112
Local LID[8] = 0x 70
My con_data for qp to host 9: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13478
  PSN number = 11301787
  max.atomic = 16
  LID = 0x112
Local LID[9] = 0x 70
My con_data for qp to host 10: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13479
  PSN number = 12836758
  max.atomic = 16
  LID = 0x112
Local LID[10] = 0x 70
My con_data for qp to host 11: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13480
  PSN number = 10515605
  max.atomic = 16
  LID = 0x112
Local LID[11] = 0x 70
My con_data for qp to host 12: 
  value address = 0x7ffdc9fe3000
  value rkey = 0x50010c10
  cache address = 0x7ffcceaed000
  cache rkey = 0x50010d10
  QP number = 13481
  PSN number = 15895279
  max.atomic = 16
  LID = 0x112
Local LID[12] = 0x 70
0: going to send OOB info to master
0: sent OOB info to master, error system:0
Got OOB info from 0
Got OOB info from 1
Got OOB info from 2
Got OOB info from 3
Got OOB info from 4
Got OOB info from 5
Got OOB info from 6
Got OOB info from 7
Got OOB info from 8
Got OOB info from 9
Got OOB info from 10
Got OOB info from 11
Got OOB info from 12
Wrote OOB info to 0
Wrote OOB info to 1
Wrote OOB info to 2
Wrote OOB info to 3
Wrote OOB info to Peer 1
  value address = 0x7ffab47d40004  value rkey = 0x50010f0d
  cache address = 0x7ff9b92de000
  cache rkey = 0x5001100d
  QP number = 14356
  PSN number = 4736032
  max.atomic = 16
  LID = 0x113
Peer 2
  value address = 0x7ffab47d4000
  value rkey = 0x280111ae
  cache address = 0x7ff9b92de000
  cache rkey = 0x280112ae
  QP number = 15514
  PSN number = 4224233
Wrote OOB info 16
  LID = 0x514
Peer 3
  value address = 0x
ffab47d4000
  value rkey = 0xa0011193
  cache address = 0x7ff9b92de000
  cache rkey = 0xWrote OO
  QP number = 14843
  PSN number = 62008638
  max.atomic = 16
  LID = 0x70

eer 4
  value address = 0x7ffab47d4000
  value rkey = 0x38011377
Wrote OOB info to 0x7ff9b92de000
  cache rkey = 0x38011477
  QP number = 14712
  PSN number = 11024168
  max.atomic = 16
  LID = 0x119
Peer 5
  value address = 0x7ffab47d4000
  value rkey = 0x1001115e
  cache address = 0x7ff9b92de000
  cache rkey = 0x1001125e
  QP number = 14800
  PSN number = 5339925
  max.atomic = 16
  LID = 0x122
Peer 67
Wrote OOB info to 8

  value address = 0x7ffab47d4000
  value rkey = 0x280113ce
  cache address = 0x7ff9b92de000
  cache rkey = 0x280114ce
  QP number = 15147
  PSN number = 11724911
  max.atomic = 16
  LID = 0x121
9eer 7
  value address = 0x7ffab47d4000
  value rkey = 0x1801119d
  cache address = 0x7ff9b92de000
  cache rkey = 0x1801129d
  QP number = 14566
  PSN number = 4613655
  max.atomic = 16
  LID = 0x68
Peer 8
  value address = 0x7ffab47d4000
  value rkey = 0xf8011515
  cache address = 0x7ff9b92de000
  cache rkey = 0xf8011615
  QP number = 3442
  PSN number = 4534026
  max.atomic = 16
  LID = 0x115
Peer 9
  value address = 0x7ffab47d4000
  value rkey = 0x111f2
  cache address = 0x7ff9b92de000
  cache rkey = 0x112f2
  QP number = 14618
  PSN number = 13559144
  max.atomic = 16
  LID = 0x120
Peer 10
  value address = 0x7ffab47d4000
  value rkey = 0xb0011322
  cache address = 0x7ff9b92de000
  cache rkey = 0xb0011422
  QP number = 14283
  PSN number = 5851523
  max.atomic = 16
  LID = 0x116
Peer 11
  value address = 0x7ffab47d4000
  value rkey = 0x40011122
  cache address = 0x7ff9b92de000
  cache rkey = 0x40011222
  QP number = 13906
  PSN number = 1611060
  max.atomic = 16
  LID = 0x127
Peer 12
  value address = 0x7ffab47d4000
  value rkey = 0x8011142
  cache address = 0x7ff9b92de000
  cache rkey = 0x8011242
  QP number = 13987
  PSN number = 6575220
  max.atomic = 16
  LID = 0x118

Wrote OOB info to 10
Wrote OOB info to 11
Wrote OOB info to 12
Migrate QPs to RTR, RTS
Resize my queue pointers, use >= 58.8432MB
Master is not a worker, does not host pi values

run():955 DKV Pipeline server runs
177.080 Memory usage: total 33707MB resident 33617MB 
average_count is: 2 step count: 1 time: 7.684 perplexity for hold out set: 3.830780506134
average_count is: 3 step count: 257 time: 70.544 perplexity for hold out set: 3.627190113068
average_count is: 4 step count: 513 time: 132.234 perplexity for hold out set: 3.572502613068
average_count is: 5 step count: 769 time: 193.947 perplexity for hold out set: 3.546603679657
average_count is: 6 step count: 1025 time: 257.029 perplexity for hold out set: 3.531319379807
average_count is: 7 step count: 1281 time: 318.714 perplexity for hold out set: 3.521233081818
average_count is: 8 step count: 1537 time: 379.849 perplexity for hold out set: 3.514032125473
average_count is: 9 step count: 1793 time: 443.259 perplexity for hold out set: 3.508658170700
average_count is: 10 step count: 2048 time: 503.815 perplexity for hold out set: 3.504466533661
timer                                    total (s)    ticks  per tick (us)
  load network graph                      171.330        1  171330221.331
  initialize DKV store                     10.461        1   10461014.758
  populate pi                               0.013        1      13818.849
  iteration                               496.419     2047     242510.972
    deploy minibatch                      251.449     2048     122777.966
      scatter subgraph                    130.521     2048      63731.405
        marshall edge count                 0.966     2048        472.147
        scatterv edges                      0.039     2048         19.527
        marshall edges                     41.882     2048      20450.433
        scatterv edges                     85.668     2048      41830.408
        unmarshall edges                    0.000     2048          0.136
      sample_mini_batch                    26.233     2048      12809.309
      nodes_in_mini_batch                   6.015     2048       2937.268
    broadcast theta/beta                    0.264     2047        129.250
    update_phi_pi                         403.547     2047     197140.985
      create minibatch slice chunks         0.000     2048          0.448
      reorder minibatch overlap     <unused>
      sample_neighbor_nodes                 2.104     2048       1027.420
      resample_neighbor_nodes       <unused>
      load minibatch pi                     0.010     4095          2.654
      load neighbor pi                      0.002     4095          0.584
      update_phi                            1.872     4094        457.272
      barrier after update phi            137.492     2047      67167.680
      update_pi                     <unused>
      store minibatch pi            <unused>
      barrier after update pi              10.729     2047       5241.608
    update_beta_theta                      31.786     2047      15528.109
      zero beta grads                       0.748     2047        365.657
      rank minibatch nodes                  0.487     2047        238.386
      load pi update_beta                   3.770     2047       1842.197
      beta calc grads                       5.336     2047       2606.923
      beta sum grads                        1.046     2047        511.257
      beta reduce(+) grads                  8.340     2047       4074.581
      update theta                          1.191     2047        581.968
  perplexity                               66.400        9    7377855.150
      load perplexity pi                   48.191       54     892436.281
      calc edge likelihood                  0.579        9      64379.823
      purge perplexity pi                   0.000       54          2.984
      reduce/plus perplexity               10.591        9    1176847.009
Linger a bit to allow gracious shutdown
timer                                    total (s)    ticks  per tick (us)
RDMA poll cq                        <unused>
RDMA read                                  51.967    10291       5049.841
     local read                     <unused>
     per-host read                         47.782     6303       7580.935
     post read                              3.075 27696389          0.111
     finish read                           33.701 490201937          0.069
RDMA write                          <unused>
     local write                    <unused>
     per-host write                 <unused>
     post write                     <unused>
     finish write                   <unused>
RDMA barrier                        <unused>
posts 27696389 messages 0 msgs/post 0.000
Local read   0B -nanGB/s
Remote read  113555194900B 2.035GB/s per-host loop 2.213GB/s
Local write  0B -nanGB/s
Remote write 0B -nanGB/s per-host loop -nanGB/s
                                            7.563     1983       3814.280
                                            2.927    35471         82.526
                                    <unused>
